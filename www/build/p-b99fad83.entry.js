import{r as e,h as t,H as n}from"./p-fc9cd10b.js";function s(e){return Object.keys(e).some((t=>{let n=e[t];if(!n){return false}if(n&&n.toParam){n=n.toParam()}const s=n.constructor.name;switch(s){case"Array":return false;case"Object":return false;case"Date":return false;case"Function":return false;case"Boolean":return false;case"String":return false;case"Number":return false;default:return true}}))}function r(e){const t={};Object.keys(e).forEach((n=>{var s,r;let o=e[n];if(o&&o.toParam){o=o.toParam()}if(!o&&o!==0&&typeof o!=="boolean"&&typeof o!=="string"){return}const i=o.constructor.name;let c;switch(i){case"Array":const e=(r=(s=o[0])===null||s===void 0?void 0:s.constructor)===null||r===void 0?void 0:r.name;c=e==="Array"?o:e==="Object"?JSON.stringify(o):o.join(",");break;case"Object":c=JSON.stringify(o);break;case"Date":c=o.valueOf();break;case"Function":c=null;break;case"Boolean":c=o+"";break;default:c=o;break}if(c||c===0||typeof c==="string"||Array.isArray(c)){t[n]=c}}));return t}function o(e,t){if(Array.isArray(t)&&t[0]&&Array.isArray(t[0])){return t.map((t=>o(e,t))).join("&")}return encodeURIComponent(e)+"="+encodeURIComponent(t)}function i(e){const t=r(e);return Object.keys(t).map((e=>o(e,t[e]))).join("&")}var c={FormData:globalThis.FormData,File:globalThis.File,Blob:globalThis.Blob};function a(e,t){const n=s(e)||t;const o=r(e);if(n){const e=new c.FormData;Object.keys(o).forEach((t=>{if(typeof Blob!=="undefined"&&o[t]instanceof Blob){const n=o["fileName"]||o[t].name||t;e.append(t,o[t],n)}else{e.append(t,o[t])}}));return e}else{return i(e)}}class l extends Error{constructor(e,t,n,s,r){super(e);const o=new.target.prototype;Object.setPrototypeOf(this,o);e=e||"UNKNOWN_ERROR";t=t||"UNKNOWN_ERROR_CODE";this.name="ArcGISRequestError";this.message=t==="UNKNOWN_ERROR_CODE"?e:`${t}: ${e}`;this.originalMessage=e;this.code=t;this.response=n;this.url=s;this.options=r}}function u(e){if(console&&console.warn){console.warn.apply(console,[e])}}var f=function e(){return Promise.resolve({fetch:globalThis.fetch,Headers:globalThis.Headers,Response:globalThis.Response,Request:globalThis.request})};const h=`@esri/arcgis-rest-js`;function d(){return globalThis.DEFAULT_ARCGIS_REQUEST_OPTIONS||{httpMethod:"POST",params:{f:"json"}}}class b extends l{constructor(e="AUTHENTICATION_ERROR",t="AUTHENTICATION_ERROR_CODE",n,s,r){super(e,t,n,s,r);this.name="ArcGISAuthError";this.message=t==="AUTHENTICATION_ERROR_CODE"?e:`${t}: ${e}`;const o=new.target.prototype;Object.setPrototypeOf(this,o)}retry(e,t=1){let n=0;const s=(r,o)=>{n=n+1;e(this.url,this.options).then((e=>{const t=Object.assign(Object.assign({},this.options),{authentication:e});return O(this.url,t)})).then((e=>{r(e)})).catch((e=>{if(e.name==="ArcGISAuthError"&&n<t){s(r,o)}else if(e.name===this.name&&e.message===this.message&&n>=t){o(this)}else{o(e)}}))};return new Promise(((e,t)=>{s(e,t)}))}}function p(e,t,n,s,r){if(e.code>=400){const{message:n,code:r}=e;throw new l(n,r,e,t,s)}if(e.error){const{message:n,code:o,messageCode:i}=e.error;const c=i||o||"UNKNOWN_ERROR_CODE";if(o===498||o===499){if(r){throw r}else{throw new b(n,c,e,t,s)}}throw new l(n,c,e,t,s)}if(e.status==="failed"||e.status==="failure"){let n;let r="UNKNOWN_ERROR_CODE";try{n=JSON.parse(e.statusMessage).message;r=JSON.parse(e.statusMessage).code}catch(t){n=e.statusMessage||e.message}throw new l(n,r,e,t,s)}return e}function O(e,t){const n=d();const r=Object.assign(Object.assign(Object.assign({httpMethod:"POST"},n),t),{params:Object.assign(Object.assign({},n.params),t.params),headers:Object.assign(Object.assign({},n.headers),t.headers)});const{httpMethod:o,rawResponse:c}=r;const b=Object.assign({f:"json"},r.params);let O=null;const g={method:o,signal:r.signal,credentials:r.credentials||"same-origin"};if(r.headers&&r.headers["X-Esri-Auth-Client-Id"]&&e.indexOf("/oauth2/platformSelf")>-1){g.credentials="include"}let w;if(typeof r.authentication==="string"){const e=r.authentication;w={portal:"https://www.arcgis.com/sharing/rest",getToken:()=>Promise.resolve(e)};if(!r.authentication.startsWith("AAPK")&&!r.suppressWarnings&&!globalThis.ARCGIS_REST_JS_SUPPRESS_TOKEN_WARNING){u(`Using an oAuth 2.0 access token directly in the token option is discouraged. Consider using ArcGISIdentityManager or Application session. See https://esriurl.com/arcgis-rest-js-direct-token-warning for more information.`);globalThis.ARCGIS_REST_JS_SUPPRESS_TOKEN_WARNING=true}}else{w=r.authentication}const m=e;return(w?w.getToken(e).catch((t=>{t.url=e;t.options=r;O=t;return Promise.resolve("")})):Promise.resolve("")).then((t=>{if(t.length){b.token=t}if(w&&w.getDomainCredentials){g.credentials=w.getDomainCredentials(e)}const n={};if(g.method==="GET"){if(b.token&&r.hideToken&&typeof window==="undefined"){n["X-Esri-Authorization"]=`Bearer ${b.token}`;delete b.token}const s=i(b);const o=s===""?e:e+"?"+i(b);if(r.maxUrlLength&&o.length>r.maxUrlLength||b.token&&r.hideToken){g.method="POST";if(t.length&&r.hideToken){b.token=t;delete n["X-Esri-Authorization"]}}else{e=o}}const o=new RegExp("/items/.+/updateResources").test(e);if(g.method==="POST"){g.body=a(b,o)}g.headers=Object.assign(Object.assign({},n),r.headers);if((typeof window==="undefined"||window&&typeof window.document==="undefined")&&!g.headers.referer){g.headers.referer=h}if(!s(b)&&!o){g.headers["Content-Type"]="application/x-www-form-urlencoded"}return globalThis.fetch?globalThis.fetch(e,g):f().then((({fetch:t})=>t(e,g)))})).then((t=>{if(!t.ok){return t.json().then((n=>{const{status:s,statusText:o}=t;const{message:i,details:c}=n.error;const a=`${i}. ${c?c.join(" "):""}`.trim();throw new l(a,`HTTP ${s} ${o}`,n,e,r)})).catch((n=>{if(n.name==="ArcGISRequestError"){throw n}const{status:s,statusText:o}=t;throw new l(o,`HTTP ${s}`,t,e,r)}))}if(c){return t}switch(b.f){case"json":return t.json();case"geojson":return t.json();case"html":return t.text();case"text":return t.text();default:return t.blob()}})).then((t=>{if((b.f==="json"||b.f==="geojson")&&!c){const n=p(t,m,b,r,O);if(O){const t=e.toLowerCase().split(/\/rest(\/admin)?\/services\//)[0];r.authentication.federatedServers[t]={token:[],expires:new Date(Date.now()+86400*1e3)};O=null}return n}else{return t}}))}function g(e,t={params:{f:"json"}}){return O(e,t).catch((e=>{if(e instanceof b&&t.authentication&&typeof t.authentication!=="string"&&t.authentication.canRefresh&&t.authentication.refreshCredentials){return e.retry((()=>t.authentication.refreshCredentials()),1)}else{return Promise.reject(e)}}))}function w(e){if(typeof e!=="string"){return e}e=e.trim();if(e[e.length-1]==="/"){e=e.slice(0,-1)}return e}function m(e={}){if(e.portal){return w(e.portal)}if(e.authentication&&typeof e.authentication!=="string"){return e.authentication.portal}return"https://www.arcgis.com/sharing/rest"}const T=(e,t)=>{const n=typeof t==="string"?t:m(t);return`${n}/content/items/${e}`};function R(e,t){const n=`${T(e,t)}/data`;const s=Object.assign({httpMethod:"GET",params:{}},t);if(s.file){s.params.f=null}return g(n,s).catch((e=>{const t=RegExp(/The string did not match the expected pattern|(Unexpected end of (JSON input|data at line 1 column 1))/i);if(t.test(e.message)){return}else throw e}))}const j=":host{display:block}";const N=class{constructor(t){e(this,t);this.webmapId=null;this.charts=[]}componentWillLoad(){this.loadWebmap(this.webmapId)}async loadWebmap(e){const t=await R(e);this.charts=t.operationalLayers.map((e=>e.charts||[])).flat();console.debug("cedar-dashboard: loadWebmap",this.charts)}render(){return t(n,null,t("slot",null),this.charts.map((e=>t("cedar-chart",{config:e}))))}static get watchers(){return{webmapId:["loadWebmap"]}}};N.style=j;export{N as cedar_dashboard};
//# sourceMappingURL=p-b99fad83.entry.js.map