import{c2 as t,c5 as s,c6 as i,c4 as n,c3 as h,dX as o,gr as r,bM as e,b2 as c,dG as f}from"./p-b54724b6.js";import{s as m,r as x,i as a}from"./p-80be55a5.js";function u(t){return y(t,!0)}function l(t){return y(t,!1)}function y(r,e){if(null==r)return null;const u=r.spatialReference,l=c(u),y="toJSON"in r?r.toJSON():r;if(!l)return y;const _=f(u)?102100:4326,p=x[_].maxX,b=x[_].minX;if(t(y))return w(y,p,b);if(s(y))return y.points=y.points.map((t=>w(t,p,b))),y;if(i(y))return d(y,l);if(n(y)||h(y)){const t=o(g,y),s={xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3]},i=a(s.xmin,b)*(2*p),n=0===i?y:m(y,i);return s.xmin+=i,s.xmax+=i,s.xmax>p?I(n,p,e):s.xmin<b?I(n,b,e):n}return y}function d(t,s){if(!s)return t;const i=_(t,s).map((t=>t.extent));return i.length<2?i[0]||t:i.length>2?(t.xmin=s.valid[0],t.xmax=s.valid[1],t):{rings:i.map((t=>[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]))}}function w(t,s,i){if(Array.isArray(t)){const n=t[0];if(n>s){const i=a(n,s);t[0]=n+i*(-2*s)}else if(n<i){const s=a(n,i);t[0]=n+s*(-2*i)}}else{const n=t.x;if(n>s){const i=a(n,s);t.x+=i*(-2*s)}else if(n<i){const s=a(n,i);t.x+=s*(-2*i)}}return t}function _(t,s){const i=[],{ymin:n,ymax:h,xmin:o,xmax:r}=t,e=t.xmax-t.xmin,[c,f]=s.valid,{x:m,frameId:x}=p(t.xmin,s),{x:a,frameId:u}=p(t.xmax,s),l=m===a&&e>0;if(e>2*f){const t={xmin:o<r?m:a,ymin:n,xmax:f,ymax:h},s={xmin:c,ymin:n,xmax:o<r?a:m,ymax:h},e={xmin:0,ymin:n,xmax:f,ymax:h},l={xmin:c,ymin:n,xmax:0,ymax:h},y=[],d=[];b(t,e)&&y.push(x),b(t,l)&&d.push(x),b(s,e)&&y.push(u),b(s,l)&&d.push(u);for(let t=x+1;t<u;t++)y.push(t),d.push(t);i.push(new T(t,[x]),new T(s,[u]),new T(e,y),new T(l,d))}else m>a||l?i.push(new T({xmin:m,ymin:n,xmax:f,ymax:h},[x]),new T({xmin:c,ymin:n,xmax:a,ymax:h},[u])):i.push(new T({xmin:m,ymin:n,xmax:a,ymax:h},[x]));return i}function p(t,s){const[i,n]=s.valid,h=2*n;let o,r=0;return t>n?(o=Math.ceil(Math.abs(t-n)/h),t-=o*h,r=o):t<i&&(o=Math.ceil(Math.abs(t-i)/h),t+=o*h,r=-o),{x:t,frameId:r}}function b(t,s){const{xmin:i,ymin:n,xmax:h,ymax:o}=s;return M(t,i,n)&&M(t,i,o)&&M(t,h,o)&&M(t,h,n)}function M(t,s,i){return s>=t.xmin&&s<=t.xmax&&i>=t.ymin&&i<=t.ymax}function I(t,s,i=!0){const n=!h(t);if(n&&r(t),i){return(new j).cut(t,s)}const o=n?t.rings:t.paths,e=n?4:2,c=o.length,f=-2*s;for(let t=0;t<c;t++){const s=o[t];if(s&&s.length>=e){const t=[];for(const i of s)t.push([i[0]+f,i[1]]);o.push(t)}}return n?t.rings=o:t.paths=o,t}class T{constructor(t,s){this.extent=t,this.frameIds=s}}const g=e();class j{constructor(){this._linesIn=[],this._linesOut=[]}cut(t,s){let i;if(this._xCut=s,t.rings)this._closed=!0,i=t.rings,this._minPts=4;else{if(!t.paths)return null;this._closed=!1,i=t.paths,this._minPts=2}for(const t of i){if(!t||t.length<this._minPts)continue;let s=!0;for(const i of t)s?(this.moveTo(i),s=!1):this.lineTo(i);this._closed&&this.close()}this._pushLineIn(),this._pushLineOut(),i=[];for(const t of this._linesIn)t&&t.length>=this._minPts&&i.push(t);const n=-2*this._xCut;for(const t of this._linesOut)if(t&&t.length>=this._minPts){for(const s of t)s[0]+=n;i.push(t)}return this._closed?t.rings=i:t.paths=i,t}moveTo(t){this._pushLineIn(),this._pushLineOut(),this._prevSide=this._side(t[0]),this._moveTo(t[0],t[1],this._prevSide),this._prevPt=t,this._firstPt=t}lineTo(t){const s=this._side(t[0]);if(s*this._prevSide==-1){const i=this._intersect(this._prevPt,t);this._lineTo(this._xCut,i,0),this._prevSide=0,this._lineTo(t[0],t[1],s)}else this._lineTo(t[0],t[1],s);this._prevSide=s,this._prevPt=t}close(){const t=this._firstPt,s=this._prevPt;t[0]===s[0]&&t[1]===s[1]||this.lineTo(t),this._checkClosingPt(this._lineIn),this._checkClosingPt(this._lineOut)}_moveTo(t,s,i){this._closed?(this._lineIn.push([i<=0?t:this._xCut,s]),this._lineOut.push([i>=0?t:this._xCut,s])):(i<=0&&this._lineIn.push([t,s]),i>=0&&this._lineOut.push([t,s]))}_lineTo(t,s,i){this._closed?(this._addPolyVertex(this._lineIn,i<=0?t:this._xCut,s),this._addPolyVertex(this._lineOut,i>=0?t:this._xCut,s)):i<0?(0===this._prevSide&&this._pushLineOut(),this._lineIn.push([t,s])):i>0?(0===this._prevSide&&this._pushLineIn(),this._lineOut.push([t,s])):this._prevSide<0?(this._lineIn.push([t,s]),this._lineOut.push([t,s])):this._prevSide>0&&(this._lineOut.push([t,s]),this._lineIn.push([t,s]))}_addPolyVertex(t,s,i){const n=t.length;n>1&&t[n-1][0]===s&&t[n-2][0]===s?t[n-1][1]=i:t.push([s,i])}_checkClosingPt(t){const s=t.length;s>3&&t[0][0]===this._xCut&&t[s-2][0]===this._xCut&&t[1][0]===this._xCut&&(t[0][1]=t[s-2][1],t.pop())}_side(t){return t<this._xCut?-1:t>this._xCut?1:0}_intersect(t,s){const i=(this._xCut-t[0])/(s[0]-t[0]);return t[1]+i*(s[1]-t[1])}_pushLineIn(){this._lineIn&&this._lineIn.length>=this._minPts&&this._linesIn.push(this._lineIn),this._lineIn=[]}_pushLineOut(){this._lineOut&&this._lineOut.length>=this._minPts&&this._linesOut.push(this._lineOut),this._lineOut=[]}}export{l as a,u as c};
//# sourceMappingURL=p-89e4900b.js.map