{"version":3,"names":["n","t","r","o","u","c","e","f","i","p","s","l","warn","minDataValue","maxDataValue","minSize","maxSize","SIZE_MINMAX_VALUE","expression","valueExpression","Array","isArray","stops","SIZE_SCALE_STOPS","field","levels","SIZE_FIELD_STOPS","valueUnit","SIZE_UNIT_VALUE","getLogger","error","NONE","Math","sqrt","value","size","a","map","type","length","min","push","values","Float32Array","sizes","vvFields","vvRanges","minMaxValue","scaleStops","fieldStops","unitValue","unit","valueRepresentation","color","m","opacity","rotation","rotationType","opacities","v","g","b","normalizationField","colors"],"sources":["./node_modules/@arcgis/core/views/2d/engine/webgl/DisplayId.js","./node_modules/@arcgis/core/views/2d/engine/webgl/util/debug.js","./node_modules/@arcgis/core/views/2d/engine/webgl/visualVariablesUtils.js","./node_modules/@arcgis/core/views/2d/layers/features/tileRenderers/support/visualVariablesUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nconst n=8388607,t=8388608,r=254,o=255,u=0,c=1,e=n=>(n&t)>>>23,f=t=>t&n,i=n=>e(n)===c?r:o;function p(n){return e(n)===c}function s(n,r){return((r?t:0)|n)>>>0}export{r as AGGREGATE_VALID_FILTERS_MASK,n as DISPLAY_ID_TEXEL_MASK,c as DISPLAY_ID_TYPE_AGGREGATE,u as DISPLAY_ID_TYPE_FEATURE,t as DISPLAY_ID_TYPE_MASK,o as NONAGGREGATE_VALID_FILTERS_MASK,s as createDisplayId,i as getDisplayIdFilterMask,f as getDisplayIdTexel,e as getDisplayIdType,p as isAggregateId};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nconst n=(n,l)=>n&&((...n)=>l.warn(\"DEBUG:\",...n))||(()=>null),l=!1;export{l as DEBUG_ATTR_UPDATES,n as createDebugLogger};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/Error.js\";import s from\"../../../../core/Logger.js\";import{WGLVVFlag as i}from\"./enums.js\";import{isNumber as r}from\"./Utils.js\";function l(l){return r(l.minDataValue)&&r(l.maxDataValue)&&null!=l.minSize&&null!=l.maxSize?i.SIZE_MINMAX_VALUE:(l.expression&&\"view.scale\"===l.expression||l.valueExpression&&\"$view.scale\"===l.valueExpression)&&Array.isArray(l.stops)?i.SIZE_SCALE_STOPS:(null!=l.field||l.expression&&\"view.scale\"!==l.expression||l.valueExpression&&\"$view.scale\"!==l.valueExpression)&&(Array.isArray(l.stops)||\"levels\"in l&&l.levels)?i.SIZE_FIELD_STOPS:(null!=l.field||l.expression&&\"view.scale\"!==l.expression||l.valueExpression&&\"$view.scale\"!==l.valueExpression)&&null!=l.valueUnit?i.SIZE_UNIT_VALUE:(s.getLogger(\"esri.views.2d.engine.webgl\").error(new e(\"mapview-bad-type\",\"Found invalid size VisualVariable\",l)),i.NONE)}export{l as getTypeOfSizeVisualVariable};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{toPt as e,pt2px as t}from\"../../../../../../core/screenUtils.js\";import{premultiplyAlpha as s}from\"../../../../engine/webgl/color.js\";import{NAN_MAGIC_NUMBER as n}from\"../../../../engine/webgl/definitions.js\";import{WGLVVFlag as o}from\"../../../../engine/webgl/enums.js\";import{getTypeOfSizeVisualVariable as i}from\"../../../../engine/webgl/visualVariablesUtils.js\";function l(e,t){if(!e||!t)return e;switch(t){case\"radius\":case\"distance\":return 2*e;case\"diameter\":case\"width\":return e;case\"area\":return Math.sqrt(e)}return e}function r(t){return{value:t.value,size:e(t.size)}}function a(e){return(e??[]).map((e=>r(e)))}function u(t){if(\"string\"==typeof t||\"number\"==typeof t)return e(t);const s=t;return{type:\"size\",expression:s.expression,stops:a(s.stops)}}const p=e=>{const s=[],o=[],i=a(e),l=i.length;for(let r=0;r<6;r++){const e=i[Math.min(r,l-1)];s.push(e.value),o.push(null==e.size?n:t(e.size))}return{values:new Float32Array(s),sizes:new Float32Array(o)}};function c(e){const t=e&&e.length>0?{}:null,s=t?{}:null;if(!t||!s)return{vvFields:t,vvRanges:s};for(const n of e)if(n.field&&(t[n.type]=n.field),\"size\"===n.type){s.size||(s.size={});const e=n;switch(i(e)){case o.SIZE_MINMAX_VALUE:s.size.minMaxValue={minDataValue:e.minDataValue,maxDataValue:e.maxDataValue,minSize:u(e.minSize),maxSize:u(e.maxSize)};break;case o.SIZE_SCALE_STOPS:s.size.scaleStops={stops:a(e.stops)};break;case o.SIZE_FIELD_STOPS:if(e.levels){const t={};for(const s in e.levels)t[s]=p(e.levels[s]);s.size.fieldStops={type:\"level-dependent\",levels:t}}else s.size.fieldStops={type:\"static\",...p(e.stops)};break;case o.SIZE_UNIT_VALUE:s.size.unitValue={unit:e.valueUnit,valueRepresentation:e.valueRepresentation??void 0}}}else if(\"color\"===n.type)s.color=m(n);else if(\"opacity\"===n.type)s.opacity=f(n);else if(\"rotation\"===n.type){const e=n;s.rotation={type:e.rotationType}}return{vvFields:t,vvRanges:s}}function f(e){const t={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if(\"string\"==typeof e.field){if(!e.stops)return null;{if(e.stops.length>8)return null;const s=e.stops;for(let e=0;e<8;++e){const n=s[Math.min(e,s.length-1)];t.values[e]=n.value,t.opacities[e]=n.opacity}}}else{if(!(e.stops&&e.stops.length>=0))return null;{const s=e.stops&&e.stops.length>=0?e.stops[0].opacity:0;for(let e=0;e<8;e++)t.values[e]=1/0,t.opacities[e]=s}}return t}function v(e,t,s){e[4*t]=s.r/255,e[4*t+1]=s.g/255,e[4*t+2]=s.b/255,e[4*t+3]=s.a}function m(e){if(null==e)return null;if(e.normalizationField)return null;const t={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if(\"string\"==typeof e.field){if(!e.stops)return null;{if(e.stops.length>8)return null;t.field=e.field;const s=e.stops;for(let e=0;e<8;++e){const n=s[Math.min(e,s.length-1)];t.values[e]=n.value,v(t.colors,e,n.color)}}}else{if(!(e.stops&&e.stops.length>=0))return null;{const s=e.stops&&e.stops.length>=0&&e.stops[0].color;for(let e=0;e<8;e++)t.values[e]=1/0,v(t.colors,e,s)}}for(let n=0;n<32;n+=4)s(t.colors,n,!0);return t}export{m as convertColorVariable,c as convertVisualVariables,l as getVisualVariableSizeValueRepresentationRatio,u as normalizeSizeElement,a as normalizeSizeStops,r as stopToSizeStop};\n"],"mappings":"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"}