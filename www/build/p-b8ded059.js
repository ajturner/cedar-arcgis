import{dd as n,de as t,h as r}from"./p-b54724b6.js";import{i as e}from"./p-623dbe5e.js";function a(n,t){const r=i[n.toLowerCase()];if(null==r)throw new Error("Function Not Recognised");if(t.length<r.minParams||t.length>r.maxParams)throw new Error(`Invalid Parameter count for call to ${n.toUpperCase()}`);return r.evaluate(t)}function u(n,t){const r=i[n.toLowerCase()];return null!=r&&t>=r.minParams&&t<=r.maxParams}const i={min:{minParams:1,maxParams:1,evaluate:n=>null==n[0]?null:Math.min.apply(Math,n[0])},max:{minParams:1,maxParams:1,evaluate:n=>null==n[0]?null:Math.max.apply(Math,n[0])},avg:{minParams:1,maxParams:1,evaluate:n=>null==n[0]?null:s(n[0])},sum:{minParams:1,maxParams:1,evaluate:n=>null==n[0]?null:o(n[0])},stddev:{minParams:1,maxParams:1,evaluate:n=>null==n[0]?null:Math.sqrt(l(n[0]))},count:{minParams:1,maxParams:1,evaluate:n=>null==n[0]?null:n[0].length},var:{minParams:1,maxParams:1,evaluate:n=>null==n[0]?null:l(n[0])}};function s(n){let t=0;for(let r=0;r<n.length;r++)t+=n[r];return t/n.length}function o(n){let t=0;for(let r=0;r<n.length;r++)t+=n[r];return t}function l(n){const t=s(n),r=n.length;let e=0;for(const r of n)e+=(r-t)**2;return r>1?e/(r-1):0}var c;!function(n){n.InvalidFunctionParameters="InvalidFunctionParameters",n.UnsupportedSqlFunction="UnsupportedSqlFunction",n.UnsupportedOperator="UnsupportedOperator",n.UnsupportedSyntax="UnsupportedSyntax",n.UnsupportedIsRhs="UnsupportedIsRhs",n.UnsupportedIsLhs="UnsupportedIsLhs",n.InvalidDataType="InvalidDataType",n.CannotCastValue="CannotCastValue",n.MissingStatisticParameters="MissingStatisticParameters"}(c||(c={}));const f={[c.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",[c.InvalidFunctionParameters]:"Invalid parameters for call to {function}",[c.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[c.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[c.UnsupportedOperator]:"Unsupported operator - {operator}",[c.UnsupportedSyntax]:"Unsupported syntax - {node}",[c.UnsupportedSqlFunction]:"Sql function not found = {function}",[c.InvalidDataType]:"Invalid sql data type",[c.CannotCastValue]:"Cannot cast value to the required data type"};class p extends Error{constructor(n,t){super(e(f[n],t)),this.declaredRootClass="esri.arcade.featureset.support.sqlerror",Error.captureStackTrace&&Error.captureStackTrace(this,p)}}var v;!function(n){n.NeverReach="NeverReach",n.NotImplemented="NotImplemented",n.Cancelled="Cancelled",n.InvalidStatResponse="InvalidStatResponse",n.InvalidRequest="InvalidRequest",n.RequestFailed="RequestFailed",n.MissingFeatures="MissingFeatures",n.AggregationFieldNotFound="AggregationFieldNotFound",n.DataElementsNotFound="DataElementsNotFound"}(v||(v={}));const h={[v.Cancelled]:"Cancelled",[v.InvalidStatResponse]:"Invalid statistics response from service",[v.InvalidRequest]:"Invalid request",[v.RequestFailed]:"Request failed - {reason}",[v.MissingFeatures]:"Missing features",[v.AggregationFieldNotFound]:"Aggregation field not found",[v.DataElementsNotFound]:"Data elements not found on service",[v.NeverReach]:"Encountered unreachable logic",[v.NotImplemented]:"Not implemented"};class m extends Error{constructor(n,t){super(e(h[n],t)),this.declaredRootClass="esri.arcade.featureset.support.featureseterror",Error.captureStackTrace&&Error.captureStackTrace(this,m)}}class d{constructor(){this.op="+",this.day=0,this.second=0,this.hour=0,this.month=0,this.year=0,this.minute=0,this.millis=0}static _fixDefaults(n){if(null!==n.precision||null!==n.secondary)throw new Error("Primary and Secondary SqlInterval qualifiers not supported")}static _parseSecondsComponent(n,t){if(t.includes(".")){const r=t.split(".");n.second=parseFloat(r[0]),n.millis=parseInt(r[1],10)}else n.second=parseFloat(t)}static createFromMilliseconds(n){const t=new d;return t.second=n/1e3,t}static createFromValueAndQualifer(n,t,r){let e=null;const a=new d;if(a.op="-"===r?"-":"+","interval-period"===t.type){d._fixDefaults(t);const r=new RegExp("^[0-9]{1,}$");if("year"===t.period||"month"===t.period)throw new Error("Year-Month Intervals not supported");if("second"===t.period){if(!/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(n))throw new Error("Illegal Interval");d._parseSecondsComponent(a,n)}else{if(!r.test(n))throw new Error("Illegal Interval");a[t.period]=parseFloat(n)}}else{if(d._fixDefaults(t.start),d._fixDefaults(t.end),"year"===t.start.period||"month"===t.start.period)throw new Error("Year-Month Intervals not supported");if("year"===t.end.period||"month"===t.end.period)throw new Error("Year-Month Intervals not supported");switch(t.start.period){case"day":switch(t.end.period){case"hour":if(e=new RegExp("^[0-9]{1,} [0-9]{1,}$"),!e.test(n))throw new Error("Illegal Interval");a[t.start.period]=parseFloat(n.split(" ")[0]),a[t.end.period]=parseFloat(n.split(" ")[1]);break;case"minute":if(e=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$"),!e.test(n))throw new Error("Illegal Interval");{a[t.start.period]=parseFloat(n.split(" ")[0]);const r=n.split(" ")[1].split(":");a.hour=parseFloat(r[0]),a.minute=parseFloat(r[1])}break;case"second":if(e=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!e.test(n))throw new Error("Illegal Interval");{a[t.start.period]=parseFloat(n.split(" ")[0]);const r=n.split(" ")[1].split(":");a.hour=parseFloat(r[0]),a.minute=parseFloat(r[1]),d._parseSecondsComponent(a,r[2])}break;default:throw new Error("Invalid Interval.")}break;case"hour":switch(t.end.period){case"minute":if(e=new RegExp("^[0-9]{1,}:[0-9]{1,}$"),!e.test(n))throw new Error("Illegal Interval");a.hour=parseFloat(n.split(":")[0]),a.minute=parseFloat(n.split(":")[1]);break;case"second":if(e=new RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!e.test(n))throw new Error("Illegal Interval");{const t=n.split(":");a.hour=parseFloat(t[0]),a.minute=parseFloat(t[1]),d._parseSecondsComponent(a,t[2])}break;default:throw new Error("Invalid Interval.")}break;case"minute":if("second"!==t.end.period)throw new Error("Invalid Interval.");if(e=new RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!e.test(n))throw new Error("Illegal Interval");{const t=n.split(":");a.minute=parseFloat(t[0]),d._parseSecondsComponent(a,t[1])}break;default:throw new Error("Invalid Interval.")}}return a}valueInMilliseconds(){return("-"===this.op?-1:1)*(this.millis+1e3*this.second+60*this.minute*1e3+60*this.hour*60*1e3+24*this.day*60*60*1e3+this.month*(365/12)*24*60*60*1e3+365*this.year*24*60*60*1e3)}}function y(n,t){const r=N[n.toLowerCase()];if(null==r)throw new Error("Function Not Recognised");if(t.length<r.minParams||t.length>r.maxParams)throw new Error(`Invalid Parameter count for call to ${n.toUpperCase()}`);return r.evaluate(t)}function w(n,t){const r=N[n.toLowerCase()];return null!=r&&t>=r.minParams&&t<=r.maxParams}function E(n){return"string"==typeof n||n instanceof String}function I(n){return n instanceof Date}function g(n){const t=new Date(n.getTime());return t.setHours(0,0,0,0),t}function x(n,r){if(I(n))return r?g(n):n;if(E(n)){const e=t.DateTime.fromSQL(n);if(e.isValid)return r?g(e.toJSDate()):e.toJSDate()}throw new p(c.CannotCastValue)}const N={extract:{minParams:2,maxParams:2,evaluate:([n,t])=>{if(null==t)return null;if(t instanceof Date)switch(n.toUpperCase()){case"SECOND":return t.getSeconds();case"MINUTE":return t.getMinutes();case"HOUR":return t.getHours();case"DAY":return t.getDate();case"MONTH":return t.getMonth()+1;case"YEAR":return t.getFullYear()}throw new Error("Invalid Parameter for call to EXTRACT")}},substring:{minParams:2,maxParams:3,evaluate:n=>{if(2===n.length){const[t,r]=n;return null==t||null==r?null:t.toString().substring(r-1)}if(3===n.length){const[t,r,e]=n;return null==t||null==r||null==e?null:e<=0?"":t.toString().substring(r-1,r+e-1)}}},position:{minParams:2,maxParams:2,evaluate:([n,t])=>null==n||null==t?null:t.indexOf(n)+1},trim:{minParams:2,maxParams:3,evaluate:t=>{const r=3===t.length,e=r?t[1]:" ",a=r?t[2]:t[1];if(null==e||null==a)return null;const u=`(${n(e)})`;switch(t[0]){case"BOTH":return a.replaceAll(new RegExp(`^${u}*|${u}*$`,"g"),"");case"LEADING":return a.replaceAll(new RegExp(`^${u}*`,"g"),"");case"TRAILING":return a.replaceAll(new RegExp(`${u}*$`,"g"),"")}throw new Error("Invalid Parameter for call to TRIM")}},abs:{minParams:1,maxParams:1,evaluate:n=>null==n[0]?null:Math.abs(n[0])},ceiling:{minParams:1,maxParams:1,evaluate:n=>null==n[0]?null:Math.ceil(n[0])},floor:{minParams:1,maxParams:1,evaluate:n=>null==n[0]?null:Math.floor(n[0])},log:{minParams:1,maxParams:1,evaluate:n=>null==n[0]?null:Math.log(n[0])},log10:{minParams:1,maxParams:1,evaluate:n=>null==n[0]?null:Math.log(n[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:n=>null==n[0]?null:Math.sin(n[0])},cos:{minParams:1,maxParams:1,evaluate:n=>null==n[0]?null:Math.cos(n[0])},tan:{minParams:1,maxParams:1,evaluate:n=>null==n[0]?null:Math.tan(n[0])},asin:{minParams:1,maxParams:1,evaluate:n=>null==n[0]?null:Math.asin(n[0])},acos:{minParams:1,maxParams:1,evaluate:n=>null==n[0]?null:Math.acos(n[0])},atan:{minParams:1,maxParams:1,evaluate:n=>null==n[0]?null:Math.atan(n[0])},sign:{minParams:1,maxParams:1,evaluate:n=>null==n[0]?null:n[0]>0?1:n[1]<0?-1:0},power:{minParams:2,maxParams:2,evaluate:n=>null==n[0]||null==n[1]?null:n[0]**n[1]},mod:{minParams:2,maxParams:2,evaluate:n=>null==n[0]||null==n[1]?null:n[0]%n[1]},round:{minParams:1,maxParams:2,evaluate:n=>{const t=n[0],r=2===n.length?10**n[1]:1;return null==t?null:Math.round(t*r)/r}},truncate:{minParams:1,maxParams:2,evaluate:n=>null==n[0]?null:1===n.length?parseInt(n[0].toFixed(0),10):parseFloat(n[0].toFixed(n[1]))},char_length:{minParams:1,maxParams:1,evaluate:n=>"string"==typeof n[0]||n[0]instanceof String?n[0].length:0},concat:{minParams:1,maxParams:1/0,evaluate:n=>{let t="";for(let r=0;r<n.length;r++){if(null==n[r])return null;t+=n[r].toString()}return t}},lower:{minParams:1,maxParams:1,evaluate:n=>null==n[0]?null:n[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:n=>null==n[0]?null:n[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:1/0,evaluate:n=>{for(const t of n)if(null!==t)return t;return null}},cosh:{minParams:1,maxParams:1,evaluate:n=>null==n[0]?null:Math.cosh(n[0])},sinh:{minParams:1,maxParams:1,evaluate:n=>null==n[0]?null:Math.sinh(n[0])},tanh:{minParams:1,maxParams:1,evaluate:n=>null==n[0]?null:Math.tanh(n[0])},nullif:{minParams:2,maxParams:2,evaluate:n=>{const t=n[0],r=n[1];return(t instanceof Date?t.valueOf():t)===(r instanceof Date?r.valueOf():r)?null:t}},cast:{minParams:2,maxParams:2,evaluate:n=>{const t=n[0],r=n[1];if(null===t)return null;switch(r.type){case"integer":{const n=parseInt(t,10);if(isNaN(n))throw new p(c.CannotCastValue);return n}case"smallint":{const n=parseInt(t,10);if(isNaN(n))throw new p(c.CannotCastValue);if(n>32767||n<-32767)throw new p(c.CannotCastValue);return n}case"float":case"real":{const n=parseFloat(t);if(isNaN(n))throw new p(c.CannotCastValue);return n}case"date":return x(t,!0);case"timestamp":return x(t,!1);case"varchar":{const n=t.toString();if(n.length>r.size)throw new p(c.CannotCastValue);return n}default:throw new p(c.InvalidDataType)}}}};var P,T,S={exports:{}};T=function(){function n(n,t){function r(){this.constructor=n}r.prototype=t.prototype,n.prototype=new r}function t(n,r,e,a){var u=Error.call(this,n);return Object.setPrototypeOf&&Object.setPrototypeOf(u,t.prototype),u.expected=r,u.found=e,u.location=a,u.name="SyntaxError",u}function r(n,t,r){return r=r||" ",n.length>t?n:(t-=n.length,n+(r+=r.repeat(t)).slice(0,t))}function e(n,r){var e,a={},u=(r=void 0!==r?r:{}).grammarSource,i={start:Na},s=Na,o="!",l="=",c=">=",f=">",p="<=",v="<>",h="<",m="!=",d="+",y="-",w="||",E="*",I="/",g="@",x="'",N="N'",P="''",T=".",S="null",A="true",F="false",R="in",b="is",O="like",D="escape",M="not",$="and",k="or",L="between",C="from",U="for",_="substring",q="extract",H="trim",B="position",J="timestamp",V="date",G="leading",W="trailing",z="both",Y="cast",j="as",K="integer",Z="smallint",Q="float",X="real",nn="varchar",tn="to",rn="interval",en="year",an="month",un="day",sn="hour",on="minute",ln="second",cn="case",fn="end",pn="when",vn="then",hn="else",mn=",",dn="(",yn=")",wn="`",En=/^[A-Za-z_\x80-\uFFFF]/,In=/^[A-Za-z0-9_]/,gn=/^[A-Za-z0-9_.\x80-\uFFFF]/,xn=/^[^']/,Nn=/^[0-9]/,Pn=/^[eE]/,Tn=/^[+\-]/,Sn=/^[ \t\n\r]/,An=/^[^`]/,Fn=da("!",!1),Rn=da("=",!1),bn=da(">=",!1),On=da(">",!1),Dn=da("<=",!1),Mn=da("<>",!1),$n=da("<",!1),kn=da("!=",!1),Ln=da("+",!1),Cn=da("-",!1),Un=da("||",!1),_n=da("*",!1),qn=da("/",!1),Hn=ya([["A","Z"],["a","z"],"_",["","￿"]],!1,!1),Bn=ya([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Jn=ya([["A","Z"],["a","z"],["0","9"],"_",".",["","￿"]],!1,!1),Vn=da("@",!1),Gn=da("'",!1),Wn=da("N'",!1),zn=da("''",!1),Yn=ya(["'"],!0,!1),jn=da(".",!1),Kn=ya([["0","9"]],!1,!1),Zn=ya(["e","E"],!1,!1),Qn=ya(["+","-"],!1,!1),Xn=da("NULL",!0),nt=da("TRUE",!0),tt=da("FALSE",!0),rt=da("IN",!0),et=da("IS",!0),at=da("LIKE",!0),ut=da("ESCAPE",!0),it=da("NOT",!0),st=da("AND",!0),ot=da("OR",!0),lt=da("BETWEEN",!0),ct=da("FROM",!0),ft=da("FOR",!0),pt=da("SUBSTRING",!0),vt=da("EXTRACT",!0),ht=da("TRIM",!0),mt=da("POSITION",!0),dt=da("TIMESTAMP",!0),yt=da("DATE",!0),wt=da("LEADING",!0),Et=da("TRAILING",!0),It=da("BOTH",!0),gt=da("CAST",!0),xt=da("AS",!0),Nt=da("INTEGER",!0),Pt=da("SMALLINT",!0),Tt=da("FLOAT",!0),St=da("REAL",!0),At=da("VARCHAR",!0),Ft=da("TO",!0),Rt=da("INTERVAL",!0),bt=da("YEAR",!0),Ot=da("MONTH",!0),Dt=da("DAY",!0),Mt=da("HOUR",!0),$t=da("MINUTE",!0),kt=da("SECOND",!0),Lt=da("CASE",!0),Ct=da("END",!0),Ut=da("WHEN",!0),_t=da("THEN",!0),qt=da("ELSE",!0),Ht=da(",",!1),Bt=da("(",!1),Jt=da(")",!1),Vt=ya([" ","\t","\n","\r"],!1,!1),Gt=da("`",!1),Wt=ya(["`"],!0,!1),zt=function(n){return n},Yt=function(n,t){var r={type:"expression-list"},e=Di(n,t);return r.value=e,r},jt=function(n,t){return Mi(n,t)},Kt=function(n,t){return Mi(n,t)},Zt=function(n){return Ri("NOT",n)},Qt=function(n,t){return""==t||null==t||null==t?n:"arithmetic"==t.type?Mi(n,t.tail):bi(t.op,n,t.right,t.escape)},Xt=function(n){return{type:"arithmetic",tail:n}},nr=function(n,t){return{op:n+"NOT",right:t}},tr=function(n,t){return{op:n,right:t}},rr=function(n,t,r){return{op:"NOT"+n,right:{type:"expression-list",value:[t,r]}}},er=function(n,t,r){return{op:n,right:{type:"expression-list",value:[t,r]}}},ar=function(n){return n[0]+" "+n[2]},ur=function(n){return n[0]+" "+n[2]},ir=function(n,t,r){return{op:n,right:t,escape:r.value}},sr=function(n,t){return{op:n,right:t,escape:""}},or=function(n,t){return{op:n,right:t}},lr=function(n){return{op:n,right:{type:"expression-list",value:[]}}},cr=function(n,t){return{op:n,right:t}},fr=function(n,t){return Mi(n,t)},pr=function(n,t){return Mi(n,t)},vr=function(n){return n.paren=!0,n},hr=function(n){return/^CURRENT_DATE$/i.test(n)?{type:"current-time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(n)?{type:"current-time",mode:"timestamp"}:{type:"column-reference",table:"",column:n}},mr=function(n){return n},dr=function(n,t){return n+t.join("")},yr=function(n,t){return n+t.join("")},wr=function(n){return{type:"parameter",value:n[1]}},Er=function(n,t){return{type:"function",name:"extract",args:{type:"expression-list",value:[{type:"string",value:n},t]}}},Ir=function(n,t,r){return{type:"function",name:"substring",args:{type:"expression-list",value:r?[n,t,r[2]]:[n,t]}}},gr=function(n,t){return{type:"function",name:"cast",args:{type:"expression-list",value:[n,t]}}},xr=function(){return{type:"data-type",value:{type:"integer"}}},Nr=function(){return{type:"data-type",value:{type:"smallint"}}},Pr=function(){return{type:"data-type",value:{type:"float"}}},Tr=function(){return{type:"data-type",value:{type:"real"}}},Sr=function(){return{type:"data-type",value:{type:"date"}}},Ar=function(){return{type:"data-type",value:{type:"timestamp"}}},Fr=function(n){return{type:"data-type",value:{type:"varchar",size:parseInt(n)}}},Rr=function(n,t,r){return{type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:n??"BOTH"},t,r]}}},br=function(n,t){return{type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:n??"BOTH"},t]}}},Or=function(n,t){return{type:"function",name:"position",args:{type:"expression-list",value:[n,t]}}},Dr=function(n,t){return{type:"function",name:n,args:t||{type:"expression-list",value:[]}}},Mr=function(n){return{type:"timestamp",value:n.value}},$r=function(n,t,r){return{type:"interval",value:t,qualifier:r,op:n}},kr=function(n,t){return{type:"interval",value:n,qualifier:t,op:""}},Lr=function(n,t){return{type:"interval-qualifier",start:n,end:t}},Cr=function(n,t){return{type:"interval-period",period:n.value,precision:t,secondary:null}},Ur=function(n){return{type:"interval-period",period:n.value,precision:null,secondary:null}},_r=function(n){return{type:"interval-period",period:n.value,precision:null,secondary:null}},qr=function(n,t){return{type:"interval-period",period:"second",precision:n,secondary:t}},Hr=function(n){return{type:"interval-period",period:"second",precision:n,secondary:null}},Br=function(){return{type:"interval-period",period:"second",precision:null,secondary:null}},Jr=function(n,t){return{type:"interval-period",period:n.value,precision:t,secondary:null}},Vr=function(n){return{type:"interval-period",period:n.value,precision:null,secondary:null}},Gr=function(n,t){return{type:"interval-period",period:"second",precision:n,secondary:t}},Wr=function(n){return{type:"interval-period",period:"second",precision:n,secondary:null}},zr=function(){return{type:"interval-period",period:"second",precision:null,secondary:null}},Yr=function(){return{type:"string",value:"day"}},jr=function(){return{type:"string",value:"hour"}},Kr=function(){return{type:"string",value:"minute"}},Zr=function(){return{type:"string",value:"month"}},Qr=function(){return{type:"string",value:"year"}},Xr=function(n){return parseFloat(n)},ne=function(n){return parseFloat(n)},te=function(n){return{type:"date",value:n.value}},re=function(){return{type:"null",value:null}},ee=function(){return{type:"boolean",value:!0}},ae=function(){return{type:"boolean",value:!1}},ue=function(){return"'"},ie=function(n){return{type:"string",value:n.join("")}},se=function(n,t){return{type:"case-expression",format:"simple",operand:n,clauses:t,else:null}},oe=function(n,t,r){return{type:"case-expression",format:"simple",operand:n,clauses:t,else:r.value}},le=function(n){return{type:"case-expression",format:"searched",clauses:n,else:null}},ce=function(n,t){return{type:"case-expression",format:"searched",clauses:n,else:t.value}},fe=function(n,t){return{type:"when-clause",operand:n,value:t}},pe=function(n,t){return{type:"when-clause",operand:n,value:t}},ve=function(n){return{type:"else-clause",value:n}},he=function(n){return{type:"number",value:n}},me=function(n,t,r){return parseFloat(n+t+r)},de=function(n,t){return parseFloat(n+t)},ye=function(n,t){return parseFloat(n+t)},we=function(n){return parseFloat(n)},Ee=function(n,t){return n[0]+t},Ie=function(n){return"."+(null!=n?n:"")},ge=function(n,t){return n+t},xe=function(n){return n.join("")},Ne=function(n,t){return"e"+(null===t?"":t)},Pe=function(){return"IN"},Te=function(){return"IS"},Se=function(){return"LIKE"},Ae=function(){return"ESCAPE"},Fe=function(){return"NOT"},Re=function(){return"AND"},be=function(){return"OR"},Oe=function(){return"BETWEEN"},De=function(){return"FROM"},Me=function(){return"FOR"},$e=function(){return"SUBSTRING"},ke=function(){return"EXTRACT"},Le=function(){return"TRIM"},Ce=function(){return"POSITION"},Ue=function(){return"TIMESTAMP"},_e=function(){return"DATE"},qe=function(){return"LEADING"},He=function(){return"TRAILING"},Be=function(){return"BOTH"},Je=function(){return"CAST"},Ve=function(){return"AS"},Ge=function(){return"INTEGER"},We=function(){return"SMALLINT"},ze=function(){return"FLOAT"},Ye=function(){return"REAL"},je=function(){return"VARCHAR"},Ke=function(){return"TO"},Ze=function(){return"INTERVAL"},Qe=function(){return"YEAR"},Xe=function(){return"MONTH"},na=function(){return"DAY"},ta=function(){return"HOUR"},ra=function(){return"MINUTE"},ea=function(){return"SECOND"},aa=function(){return"CASE"},ua=function(){return"END"},ia=function(){return"WHEN"},sa=function(){return"THEN"},oa=function(){return"ELSE"},la=function(n){return n},ca=function(n){return n.join("")},fa=0,pa=[{line:1,column:1}],va=0,ha=[],ma=0;if("startRule"in r){if(!(r.startRule in i))throw new Error("Can't start parsing from rule \""+r.startRule+'".');s=i[r.startRule]}function da(n,t){return{type:"literal",text:n,ignoreCase:t}}function ya(n,t,r){return{type:"class",parts:n,inverted:t,ignoreCase:r}}function wa(){return{type:"end"}}function Ea(t){var r,e=pa[t];if(e)return e;for(r=t-1;!pa[r];)r--;for(e={line:(e=pa[r]).line,column:e.column};r<t;)10===n.charCodeAt(r)?(e.line++,e.column=1):e.column++,r++;return pa[t]=e,e}function Ia(n,t,r){var e=Ea(n),a=Ea(t),i={source:u,start:{offset:n,line:e.line,column:e.column},end:{offset:t,line:a.line,column:a.column}};return r&&u&&"function"==typeof u.offset&&(i.start=u.offset(i.start),i.end=u.offset(i.end)),i}function ga(n){fa<va||(fa>va&&(va=fa,ha=[]),ha.push(n))}function xa(n,r,e){return new t(t.buildMessage(n,r),n,r,e)}function Na(){var n,t;return n=fa,Si(),(t=Ta())!==a?(Si(),n=zt(t)):(fa=n,n=a),n}function Pa(){var n,t,r,e,u,i,s,o;if(n=fa,(t=Ta())!==a){for(r=[],e=fa,u=Si(),(i=Ni())!==a?(s=Si(),(o=Ta())!==a?e=u=[u,i,s,o]:(fa=e,e=a)):(fa=e,e=a);e!==a;)r.push(e),e=fa,u=Si(),(i=Ni())!==a?(s=Si(),(o=Ta())!==a?e=u=[u,i,s,o]:(fa=e,e=a)):(fa=e,e=a);n=Yt(t,r)}else fa=n,n=a;return n}function Ta(){var n,t,r,e,u,i,s,o;if(n=fa,(t=Sa())!==a){for(r=[],e=fa,u=Si(),(i=Vu())!==a?(s=Si(),(o=Sa())!==a?e=u=[u,i,s,o]:(fa=e,e=a)):(fa=e,e=a);e!==a;)r.push(e),e=fa,u=Si(),(i=Vu())!==a?(s=Si(),(o=Sa())!==a?e=u=[u,i,s,o]:(fa=e,e=a)):(fa=e,e=a);n=jt(t,r)}else fa=n,n=a;return n}function Sa(){var n,t,r,e,u,i,s,o;if(n=fa,(t=Aa())!==a){for(r=[],e=fa,u=Si(),(i=Ju())!==a?(s=Si(),(o=Aa())!==a?e=u=[u,i,s,o]:(fa=e,e=a)):(fa=e,e=a);e!==a;)r.push(e),e=fa,u=Si(),(i=Ju())!==a?(s=Si(),(o=Aa())!==a?e=u=[u,i,s,o]:(fa=e,e=a)):(fa=e,e=a);n=Kt(t,r)}else fa=n,n=a;return n}function Aa(){var t,r,e,u,i;return t=fa,(r=Bu())===a&&(r=fa,33===n.charCodeAt(fa)?(e=o,fa++):(e=a,0===ma&&ga(Fn)),e!==a?(u=fa,ma++,61===n.charCodeAt(fa)?(i=l,fa++):(i=a,0===ma&&ga(Rn)),ma--,i===a?u=void 0:(fa=u,u=a),u!==a?r=e=[e,u]:(fa=r,r=a)):(fa=r,r=a)),r!==a?(e=Si(),(u=Aa())!==a?t=Zt(u):(fa=t,t=a)):(fa=t,t=a),t===a&&(t=Fa()),t}function Fa(){var n,t,r;return n=fa,(t=Ua())!==a?(Si(),(r=Ra())===a&&(r=null),n=Qt(t,r)):(fa=n,n=a),n}function Ra(){var n;return(n=ba())===a&&(n=Ca())===a&&(n=Ma())===a&&(n=Da())===a&&(n=La()),n}function ba(){var n,t,r,e,u,i;if(n=[],t=fa,r=Si(),(e=Oa())!==a?(u=Si(),(i=Ua())!==a?t=r=[r,e,u,i]:(fa=t,t=a)):(fa=t,t=a),t!==a)for(;t!==a;)n.push(t),t=fa,r=Si(),(e=Oa())!==a?(u=Si(),(i=Ua())!==a?t=r=[r,e,u,i]:(fa=t,t=a)):(fa=t,t=a);else n=a;return n!==a&&(n=Xt(n)),n}function Oa(){var t;return n.substr(fa,2)===c?(t=c,fa+=2):(t=a,0===ma&&ga(bn)),t===a&&(62===n.charCodeAt(fa)?(t=f,fa++):(t=a,0===ma&&ga(On)),t===a&&(n.substr(fa,2)===p?(t=p,fa+=2):(t=a,0===ma&&ga(Dn)),t===a&&(n.substr(fa,2)===v?(t=v,fa+=2):(t=a,0===ma&&ga(Mn)),t===a&&(60===n.charCodeAt(fa)?(t=h,fa++):(t=a,0===ma&&ga($n)),t===a&&(61===n.charCodeAt(fa)?(t=l,fa++):(t=a,0===ma&&ga(Rn)),t===a&&(n.substr(fa,2)===m?(t=m,fa+=2):(t=a,0===ma&&ga(kn)))))))),t}function Da(){var n,t,r,e;return n=fa,(t=_u())!==a?(Si(),(r=Bu())!==a?(Si(),(e=Ua())!==a?n=nr(t,e):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a),n===a&&(n=fa,(t=_u())!==a?(Si(),(r=Ua())!==a?n=tr(t,r):(fa=n,n=a)):(fa=n,n=a)),n}function Ma(){var n,t,r,e,u,i;return n=fa,(t=Bu())!==a?(Si(),(r=Gu())!==a?(Si(),(e=Ua())!==a?(Si(),(u=Ju())!==a?(Si(),(i=Ua())!==a?n=rr(r,e,i):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a),n===a&&(n=fa,(t=Gu())!==a?(Si(),(r=Ua())!==a?(Si(),(e=Ju())!==a?(Si(),(u=Ua())!==a?n=er(t,r,u):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)),n}function $a(){var n,t,r,e,u;return n=fa,t=fa,(r=Bu())!==a?(e=Si(),(u=qu())!==a?t=r=[r,e,u]:(fa=t,t=a)):(fa=t,t=a),t!==a&&(t=ar(t)),(n=t)===a&&(n=qu()),n}function ka(){var n,t,r,e,u;return n=fa,t=fa,(r=Bu())!==a?(e=Si(),(u=Uu())!==a?t=r=[r,e,u]:(fa=t,t=a)):(fa=t,t=a),t!==a&&(t=ur(t)),(n=t)===a&&(n=Uu()),n}function La(){var n,t,r,e;return n=fa,(t=$a())!==a?(Si(),(r=Eu())!==a?(Si(),Hu()!==a?(Si(),(e=Iu())!==a?n=ir(t,r,e):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a),n===a&&(n=fa,(t=$a())!==a?(Si(),(r=Eu())!==a?n=sr(t,r):(fa=n,n=a)):(fa=n,n=a)),n}function Ca(){var n,t,r,e;return n=fa,(t=ka())!==a?(Si(),(r=Pi())!==a?(Si(),(e=Pa())!==a?(Si(),Ti()!==a?n=or(t,e):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a),n===a&&(n=fa,(t=ka())!==a?(Si(),(r=Pi())!==a?(Si(),(e=Ti())!==a?n=lr(t):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a),n===a&&(n=fa,(t=ka())!==a?(Si(),(r=Ka())!==a?n=cr(t,r):(fa=n,n=a)):(fa=n,n=a))),n}function Ua(){var n,t,r,e,u,i,s,o;if(n=fa,(t=qa())!==a){for(r=[],e=fa,u=Si(),(i=_a())!==a?(s=Si(),(o=qa())!==a?e=u=[u,i,s,o]:(fa=e,e=a)):(fa=e,e=a);e!==a;)r.push(e),e=fa,u=Si(),(i=_a())!==a?(s=Si(),(o=qa())!==a?e=u=[u,i,s,o]:(fa=e,e=a)):(fa=e,e=a);n=fr(t,r)}else fa=n,n=a;return n}function _a(){var t;return 43===n.charCodeAt(fa)?(t=d,fa++):(t=a,0===ma&&ga(Ln)),t===a&&(45===n.charCodeAt(fa)?(t=y,fa++):(t=a,0===ma&&ga(Cn)),t===a&&(n.substr(fa,2)===w?(t=w,fa+=2):(t=a,0===ma&&ga(Un)))),t}function qa(){var n,t,r,e,u,i,s,o;if(n=fa,(t=Ba())!==a){for(r=[],e=fa,u=Si(),(i=Ha())!==a?(s=Si(),(o=Ba())!==a?e=u=[u,i,s,o]:(fa=e,e=a)):(fa=e,e=a);e!==a;)r.push(e),e=fa,u=Si(),(i=Ha())!==a?(s=Si(),(o=Ba())!==a?e=u=[u,i,s,o]:(fa=e,e=a)):(fa=e,e=a);n=pr(t,r)}else fa=n,n=a;return n}function Ha(){var t;return 42===n.charCodeAt(fa)?(t=E,fa++):(t=a,0===ma&&ga(_n)),t===a&&(47===n.charCodeAt(fa)?(t=I,fa++):(t=a,0===ma&&ga(qn))),t}function Ba(){var n,t;return(n=iu())===a&&(n=Za())===a&&(n=Qa())===a&&(n=tu())===a&&(n=eu())===a&&(n=Xa())===a&&(n=au())===a&&(n=gu())===a&&(n=Ja())===a&&(n=Ka())===a&&(n=fa,Pi()!==a?(Si(),(t=Ta())!==a?(Si(),Ti()!==a?n=vr(t):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)),n}function Ja(){var n;return(n=Va())!==a&&(n=hr(n)),n}function Va(){var n;return(n=Ga())!==a&&(n=mr(n)),n}function Ga(){var n,t,r,e;if(n=fa,(t=za())!==a){for(r=[],e=ja();e!==a;)r.push(e),e=ja();n=dr(t,r)}else fa=n,n=a;return n}function Wa(){var n,t,r,e;if(n=fa,(t=za())!==a){for(r=[],e=Ya();e!==a;)r.push(e),e=Ya();n=yr(t,r)}else fa=n,n=a;return n}function za(){var t;return En.test(n.charAt(fa))?(t=n.charAt(fa),fa++):(t=a,0===ma&&ga(Hn)),t}function Ya(){var t;return In.test(n.charAt(fa))?(t=n.charAt(fa),fa++):(t=a,0===ma&&ga(Bn)),t}function ja(){var t;return gn.test(n.charAt(fa))?(t=n.charAt(fa),fa++):(t=a,0===ma&&ga(Jn)),t}function Ka(){var t,r,e;return t=fa,64===n.charCodeAt(fa)?(r=g,fa++):(r=a,0===ma&&ga(Vn)),r!==a&&(e=Wa())!==a?t=r=[r,e]:(fa=t,t=a),t!==a&&(t=wr(t)),t}function Za(){var n,t,r;return n=fa,ju()!==a?(Si(),Pi()!==a?(Si(),(t=uu())!==a?(Si(),Wu()!==a?(Si(),(r=Ta())!==a?(Si(),Ti()!==a?n=Er(t,r):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a),n}function Qa(){var n,t,r,e,u,i,s;return n=fa,Yu()!==a?(Si(),Pi()!==a?(Si(),(t=Ta())!==a?(Si(),Wu()!==a?(Si(),(r=Ta())!==a?(Si(),e=fa,(u=zu())!==a?(i=Si(),(s=Ta())!==a?e=u=[u,i,s,Si()]:(fa=e,e=a)):(fa=e,e=a),e===a&&(e=null),(u=Ti())!==a?n=Ir(t,r,e):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a),n}function Xa(){var n,t,r;return n=fa,ei()!==a?(Si(),Pi()!==a?(Si(),(t=Ta())!==a?(Si(),ai()!==a?(Si(),(r=nu())!==a?(Si(),Ti()!==a?n=gr(t,r):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a),n}function nu(){var n,t,r;return n=fa,(t=ui())!==a&&(t=xr()),(n=t)===a&&(n=fa,(t=ii())!==a&&(t=Nr()),(n=t)===a&&(n=fa,(t=si())!==a&&(t=Pr()),(n=t)===a&&(n=fa,(t=oi())!==a&&(t=Tr()),(n=t)===a&&(n=fa,(t=Xu())!==a&&(t=Sr()),(n=t)===a&&(n=fa,(t=Qu())!==a&&(t=Ar()),(n=t)===a&&(n=fa,(t=li())!==a?(Si(),Pi()!==a?(Si(),(r=Du())!==a?(Si(),Ti()!==a?n=Fr(r):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a))))))),n}function tu(){var n,t,r,e;return n=fa,Ku()!==a?(Si(),Pi()!==a?(Si(),(t=ru())===a&&(t=null),Si(),(r=Ta())!==a?(Si(),Wu()!==a?(Si(),(e=Ta())!==a?(Si(),Ti()!==a?n=Rr(t,r,e):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a),n===a&&(n=fa,Ku()!==a?(Si(),Pi()!==a?(Si(),(t=ru())===a&&(t=null),Si(),(r=Ta())!==a?(Si(),Ti()!==a?n=br(t,r):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)),n}function ru(){var n;return(n=ni())===a&&(n=ti())===a&&(n=ri()),n}function eu(){var n,t,r;return n=fa,Zu()!==a?(Si(),Pi()!==a?(Si(),(t=Ta())!==a?(Si(),Uu()!==a?(Si(),(r=Ta())!==a?(Si(),Ti()!==a?n=Or(t,r):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a),n}function au(){var n,t,r;return n=fa,(t=Fi())!==a?(Si(),Pi()!==a?(Si(),(r=Pa())===a&&(r=null),Si(),Ti()!==a?n=Dr(t,r):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a),n}function uu(){var n;return(n=pi())===a&&(n=vi())===a&&(n=hi())===a&&(n=mi())===a&&(n=di())===a&&(n=yi()),n}function iu(){var n;return(n=Iu())===a&&(n=Au())===a&&(n=wu())===a&&(n=yu())===a&&(n=du())===a&&(n=su())===a&&(n=ou()),n}function su(){var n,t;return n=fa,Qu()!==a?(Si(),(t=Eu())!==a?n=Mr(t):(fa=n,n=a)):(fa=n,n=a),n}function ou(){var t,r,e,u;return t=fa,fi()!==a?(Si(),45===n.charCodeAt(fa)?(r=y,fa++):(r=a,0===ma&&ga(Cn)),r===a&&(43===n.charCodeAt(fa)?(r=d,fa++):(r=a,0===ma&&ga(Ln))),r!==a?(Si(),(e=Eu())!==a?(Si(),(u=lu())!==a?t=$r(r,e,u):(fa=t,t=a)):(fa=t,t=a)):(fa=t,t=a)):(fa=t,t=a),t===a&&(t=fa,fi()!==a?(Si(),(r=Eu())!==a?(Si(),(e=lu())!==a?t=kr(r,e):(fa=t,t=a)):(fa=t,t=a)):(fa=t,t=a)),t}function lu(){var n,t,r;return n=fa,(t=cu())!==a?(Si(),ci()!==a?(Si(),(r=fu())!==a?n=Lr(t,r):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a),n===a&&(n=pu()),n}function cu(){var n,t,r;return n=fa,(t=vu())!==a?(Si(),Pi()!==a?(Si(),(r=mu())!==a?(Si(),Ti()!==a?n=Cr(t,r):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a),n===a&&(n=fa,(t=vu())!==a&&(t=Ur(t)),n=t),n}function fu(){var n,t,r,e;return n=fa,(t=vu())!==a&&(t=_r(t)),(n=t)===a&&(n=fa,(t=yi())!==a?(Si(),Pi()!==a?(Si(),(r=mu())!==a?(Si(),Ni()!==a?(Si(),(e=hu())!==a?(Si(),Ti()!==a?n=qr(r,e):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a),n===a&&(n=fa,(t=yi())!==a?(Si(),Pi()!==a?(Si(),(r=mu())!==a?(Si(),Ti()!==a?n=Hr(r):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a),n===a&&(n=fa,(t=yi())!==a&&(t=Br()),n=t))),n}function pu(){var n,t,r,e;return n=fa,(t=vu())!==a?(Si(),Pi()!==a?(Si(),(r=hu())!==a?(Si(),Ti()!==a?n=Jr(t,r):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a),n===a&&(n=fa,(t=vu())!==a&&(t=Vr(t)),(n=t)===a&&(n=fa,(t=yi())!==a?(Si(),Pi()!==a?(Si(),(r=mu())!==a?(Si(),Ni()!==a?(Si(),(e=hu())!==a?(Si(),Ti()!==a?n=Gr(r,e):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a),n===a&&(n=fa,(t=yi())!==a?(Si(),Pi()!==a?(Si(),(r=hu())!==a?(Si(),Ti()!==a?n=Wr(r):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a),n===a&&(n=fa,(t=yi())!==a&&(t=zr()),n=t)))),n}function vu(){var n,t;return n=fa,(t=hi())!==a&&(t=Yr()),(n=t)===a&&(n=fa,(t=mi())!==a&&(t=jr()),(n=t)===a&&(n=fa,(t=di())!==a&&(t=Kr()),(n=t)===a&&(n=fa,(t=vi())!==a&&(t=Zr()),(n=t)===a&&(n=fa,(t=pi())!==a&&(t=Qr()),n=t)))),n}function hu(){var n;return(n=Du())!==a&&(n=Xr(n)),n}function mu(){var n;return(n=Du())!==a&&(n=ne(n)),n}function du(){var n,t;return n=fa,Xu()!==a?(Si(),(t=Eu())!==a?n=te(t):(fa=n,n=a)):(fa=n,n=a),n}function yu(){var n;return(n=ku())!==a&&(n=re()),n}function wu(){var n,t;return n=fa,(t=Lu())!==a&&(t=ee()),(n=t)===a&&(n=fa,(t=Cu())!==a&&(t=ae()),n=t),n}function Eu(){var n;return(n=Iu())===a&&(n=Ka()),n}function Iu(){var t,r,e,u,i;if(t=fa,39===n.charCodeAt(fa)?(r=x,fa++):(r=a,0===ma&&ga(Gn)),r===a&&(n.substr(fa,2)===N?(r=N,fa+=2):(r=a,0===ma&&ga(Wn))),r!==a){for(e=[],u=fa,n.substr(fa,2)===P?(i=P,fa+=2):(i=a,0===ma&&ga(zn)),i!==a&&(i=ue()),(u=i)===a&&(xn.test(n.charAt(fa))?(u=n.charAt(fa),fa++):(u=a,0===ma&&ga(Yn)));u!==a;)e.push(u),u=fa,n.substr(fa,2)===P?(i=P,fa+=2):(i=a,0===ma&&ga(zn)),i!==a&&(i=ue()),(u=i)===a&&(xn.test(n.charAt(fa))?(u=n.charAt(fa),fa++):(u=a,0===ma&&ga(Yn)));39===n.charCodeAt(fa)?(u=x,fa++):(u=a,0===ma&&ga(Gn)),u!==a?t=ie(e):(fa=t,t=a)}else fa=t,t=a;return t}function gu(){var n;return(n=xu())===a&&(n=Nu()),n}function xu(){var n,t,r,e,u;if(n=fa,wi()!==a)if(Si(),(t=Ta())!==a){for(Si(),r=[],e=Tu();e!==a;)r.push(e),e=Tu();e=Si(),(u=Ei())!==a?n=se(t,r):(fa=n,n=a)}else fa=n,n=a;else fa=n,n=a;if(n===a)if(n=fa,wi()!==a)if(Si(),(t=Ta())!==a){for(Si(),r=[],e=Tu();e!==a;)r.push(e),e=Tu();e=Si(),(u=Su())!==a?(Si(),Ei()!==a?n=oe(t,r,u):(fa=n,n=a)):(fa=n,n=a)}else fa=n,n=a;else fa=n,n=a;return n}function Nu(){var n,t,r,e;if(n=fa,wi()!==a){for(Si(),t=[],r=Pu();r!==a;)t.push(r),r=Pu();r=Si(),(e=Ei())!==a?n=le(t):(fa=n,n=a)}else fa=n,n=a;if(n===a)if(n=fa,wi()!==a){for(Si(),t=[],r=Pu();r!==a;)t.push(r),r=Pu();r=Si(),(e=Su())!==a?(Si(),Ei()!==a?n=ce(t,e):(fa=n,n=a)):(fa=n,n=a)}else fa=n,n=a;return n}function Pu(){var n,t,r;return n=fa,Ii()!==a?(Si(),(t=Ta())!==a?(Si(),gi()!==a?(Si(),(r=Ta())!==a?n=fe(t,r):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a),n}function Tu(){var n,t,r;return n=fa,Ii()!==a?(Si(),(t=Ta())!==a?(Si(),gi()!==a?(Si(),(r=Ta())!==a?n=pe(t,r):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a)):(fa=n,n=a),n}function Su(){var n,t;return n=fa,xi()!==a?(Si(),(t=Ta())!==a?n=ve(t):(fa=n,n=a)):(fa=n,n=a),n}function Au(){var n,t,r,e;return n=fa,(t=Fu())!==a?(r=fa,ma++,e=za(),ma--,e===a?r=void 0:(fa=r,r=a),r!==a?n=he(t):(fa=n,n=a)):(fa=n,n=a),n}function Fu(){var n,t,r,e;return n=fa,(t=Ru())!==a&&(r=bu())!==a&&(e=Ou())!==a?n=me(t,r,e):(fa=n,n=a),n===a&&(n=fa,(t=Ru())!==a&&(r=bu())!==a?n=de(t,r):(fa=n,n=a),n===a&&(n=fa,(t=Ru())!==a&&(r=Ou())!==a?n=ye(t,r):(fa=n,n=a),n===a&&(n=fa,(t=Ru())!==a&&(t=we(t)),n=t))),n}function Ru(){var t,r,e;return(t=Du())===a&&(t=fa,45===n.charCodeAt(fa)?(r=y,fa++):(r=a,0===ma&&ga(Cn)),r===a&&(43===n.charCodeAt(fa)?(r=d,fa++):(r=a,0===ma&&ga(Ln))),r!==a&&(e=Du())!==a?t=Ee(r,e):(fa=t,t=a)),t}function bu(){var t,r,e;return t=fa,46===n.charCodeAt(fa)?(r=T,fa++):(r=a,0===ma&&ga(jn)),r!==a?((e=Du())===a&&(e=null),t=Ie(e)):(fa=t,t=a),t}function Ou(){var n,t,r;return n=fa,(t=$u())!==a&&(r=Du())!==a?n=ge(t,r):(fa=n,n=a),n}function Du(){var n,t;if(n=[],(t=Mu())!==a)for(;t!==a;)n.push(t),t=Mu();else n=a;return n!==a&&(n=xe(n)),n}function Mu(){var t;return Nn.test(n.charAt(fa))?(t=n.charAt(fa),fa++):(t=a,0===ma&&ga(Kn)),t}function $u(){var t,r,e;return t=fa,Pn.test(n.charAt(fa))?(r=n.charAt(fa),fa++):(r=a,0===ma&&ga(Zn)),r!==a?(Tn.test(n.charAt(fa))?(e=n.charAt(fa),fa++):(e=a,0===ma&&ga(Qn)),e===a&&(e=null),t=Ne(r,e)):(fa=t,t=a),t}function ku(){var t,r,e,u;return t=fa,n.substr(fa,4).toLowerCase()===S?(r=n.substr(fa,4),fa+=4):(r=a,0===ma&&ga(Xn)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=r=[r,e]:(fa=t,t=a)):(fa=t,t=a),t}function Lu(){var t,r,e,u;return t=fa,n.substr(fa,4).toLowerCase()===A?(r=n.substr(fa,4),fa+=4):(r=a,0===ma&&ga(nt)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=r=[r,e]:(fa=t,t=a)):(fa=t,t=a),t}function Cu(){var t,r,e,u;return t=fa,n.substr(fa,5).toLowerCase()===F?(r=n.substr(fa,5),fa+=5):(r=a,0===ma&&ga(tt)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=r=[r,e]:(fa=t,t=a)):(fa=t,t=a),t}function Uu(){var t,r,e,u;return t=fa,n.substr(fa,2).toLowerCase()===R?(r=n.substr(fa,2),fa+=2):(r=a,0===ma&&ga(rt)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=Pe():(fa=t,t=a)):(fa=t,t=a),t}function _u(){var t,r,e,u;return t=fa,n.substr(fa,2).toLowerCase()===b?(r=n.substr(fa,2),fa+=2):(r=a,0===ma&&ga(et)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=Te():(fa=t,t=a)):(fa=t,t=a),t}function qu(){var t,r,e,u;return t=fa,n.substr(fa,4).toLowerCase()===O?(r=n.substr(fa,4),fa+=4):(r=a,0===ma&&ga(at)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=Se():(fa=t,t=a)):(fa=t,t=a),t}function Hu(){var t,r,e,u;return t=fa,n.substr(fa,6).toLowerCase()===D?(r=n.substr(fa,6),fa+=6):(r=a,0===ma&&ga(ut)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=Ae():(fa=t,t=a)):(fa=t,t=a),t}function Bu(){var t,r,e,u;return t=fa,n.substr(fa,3).toLowerCase()===M?(r=n.substr(fa,3),fa+=3):(r=a,0===ma&&ga(it)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=Fe():(fa=t,t=a)):(fa=t,t=a),t}function Ju(){var t,r,e,u;return t=fa,n.substr(fa,3).toLowerCase()===$?(r=n.substr(fa,3),fa+=3):(r=a,0===ma&&ga(st)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=Re():(fa=t,t=a)):(fa=t,t=a),t}function Vu(){var t,r,e,u;return t=fa,n.substr(fa,2).toLowerCase()===k?(r=n.substr(fa,2),fa+=2):(r=a,0===ma&&ga(ot)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=be():(fa=t,t=a)):(fa=t,t=a),t}function Gu(){var t,r,e,u;return t=fa,n.substr(fa,7).toLowerCase()===L?(r=n.substr(fa,7),fa+=7):(r=a,0===ma&&ga(lt)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=Oe():(fa=t,t=a)):(fa=t,t=a),t}function Wu(){var t,r,e,u;return t=fa,n.substr(fa,4).toLowerCase()===C?(r=n.substr(fa,4),fa+=4):(r=a,0===ma&&ga(ct)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=De():(fa=t,t=a)):(fa=t,t=a),t}function zu(){var t,r,e,u;return t=fa,n.substr(fa,3).toLowerCase()===U?(r=n.substr(fa,3),fa+=3):(r=a,0===ma&&ga(ft)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=Me():(fa=t,t=a)):(fa=t,t=a),t}function Yu(){var t,r,e,u;return t=fa,n.substr(fa,9).toLowerCase()===_?(r=n.substr(fa,9),fa+=9):(r=a,0===ma&&ga(pt)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=$e():(fa=t,t=a)):(fa=t,t=a),t}function ju(){var t,r,e,u;return t=fa,n.substr(fa,7).toLowerCase()===q?(r=n.substr(fa,7),fa+=7):(r=a,0===ma&&ga(vt)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=ke():(fa=t,t=a)):(fa=t,t=a),t}function Ku(){var t,r,e,u;return t=fa,n.substr(fa,4).toLowerCase()===H?(r=n.substr(fa,4),fa+=4):(r=a,0===ma&&ga(ht)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=Le():(fa=t,t=a)):(fa=t,t=a),t}function Zu(){var t,r,e,u;return t=fa,n.substr(fa,8).toLowerCase()===B?(r=n.substr(fa,8),fa+=8):(r=a,0===ma&&ga(mt)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=Ce():(fa=t,t=a)):(fa=t,t=a),t}function Qu(){var t,r,e,u;return t=fa,n.substr(fa,9).toLowerCase()===J?(r=n.substr(fa,9),fa+=9):(r=a,0===ma&&ga(dt)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=Ue():(fa=t,t=a)):(fa=t,t=a),t}function Xu(){var t,r,e,u;return t=fa,n.substr(fa,4).toLowerCase()===V?(r=n.substr(fa,4),fa+=4):(r=a,0===ma&&ga(yt)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=_e():(fa=t,t=a)):(fa=t,t=a),t}function ni(){var t,r,e,u;return t=fa,n.substr(fa,7).toLowerCase()===G?(r=n.substr(fa,7),fa+=7):(r=a,0===ma&&ga(wt)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=qe():(fa=t,t=a)):(fa=t,t=a),t}function ti(){var t,r,e,u;return t=fa,n.substr(fa,8).toLowerCase()===W?(r=n.substr(fa,8),fa+=8):(r=a,0===ma&&ga(Et)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=He():(fa=t,t=a)):(fa=t,t=a),t}function ri(){var t,r,e,u;return t=fa,n.substr(fa,4).toLowerCase()===z?(r=n.substr(fa,4),fa+=4):(r=a,0===ma&&ga(It)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=Be():(fa=t,t=a)):(fa=t,t=a),t}function ei(){var t,r,e,u;return t=fa,n.substr(fa,4).toLowerCase()===Y?(r=n.substr(fa,4),fa+=4):(r=a,0===ma&&ga(gt)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=Je():(fa=t,t=a)):(fa=t,t=a),t}function ai(){var t,r,e,u;return t=fa,n.substr(fa,2).toLowerCase()===j?(r=n.substr(fa,2),fa+=2):(r=a,0===ma&&ga(xt)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=Ve():(fa=t,t=a)):(fa=t,t=a),t}function ui(){var t,r,e,u;return t=fa,n.substr(fa,7).toLowerCase()===K?(r=n.substr(fa,7),fa+=7):(r=a,0===ma&&ga(Nt)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=Ge():(fa=t,t=a)):(fa=t,t=a),t}function ii(){var t,r,e,u;return t=fa,n.substr(fa,8).toLowerCase()===Z?(r=n.substr(fa,8),fa+=8):(r=a,0===ma&&ga(Pt)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=We():(fa=t,t=a)):(fa=t,t=a),t}function si(){var t,r,e,u;return t=fa,n.substr(fa,5).toLowerCase()===Q?(r=n.substr(fa,5),fa+=5):(r=a,0===ma&&ga(Tt)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=ze():(fa=t,t=a)):(fa=t,t=a),t}function oi(){var t,r,e,u;return t=fa,n.substr(fa,4).toLowerCase()===X?(r=n.substr(fa,4),fa+=4):(r=a,0===ma&&ga(St)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=Ye():(fa=t,t=a)):(fa=t,t=a),t}function li(){var t,r,e,u;return t=fa,n.substr(fa,7).toLowerCase()===nn?(r=n.substr(fa,7),fa+=7):(r=a,0===ma&&ga(At)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=je():(fa=t,t=a)):(fa=t,t=a),t}function ci(){var t,r,e,u;return t=fa,n.substr(fa,2).toLowerCase()===tn?(r=n.substr(fa,2),fa+=2):(r=a,0===ma&&ga(Ft)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=Ke():(fa=t,t=a)):(fa=t,t=a),t}function fi(){var t,r,e,u;return t=fa,n.substr(fa,8).toLowerCase()===rn?(r=n.substr(fa,8),fa+=8):(r=a,0===ma&&ga(Rt)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=Ze():(fa=t,t=a)):(fa=t,t=a),t}function pi(){var t,r,e,u;return t=fa,n.substr(fa,4).toLowerCase()===en?(r=n.substr(fa,4),fa+=4):(r=a,0===ma&&ga(bt)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=Qe():(fa=t,t=a)):(fa=t,t=a),t}function vi(){var t,r,e,u;return t=fa,n.substr(fa,5).toLowerCase()===an?(r=n.substr(fa,5),fa+=5):(r=a,0===ma&&ga(Ot)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=Xe():(fa=t,t=a)):(fa=t,t=a),t}function hi(){var t,r,e,u;return t=fa,n.substr(fa,3).toLowerCase()===un?(r=n.substr(fa,3),fa+=3):(r=a,0===ma&&ga(Dt)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=na():(fa=t,t=a)):(fa=t,t=a),t}function mi(){var t,r,e,u;return t=fa,n.substr(fa,4).toLowerCase()===sn?(r=n.substr(fa,4),fa+=4):(r=a,0===ma&&ga(Mt)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=ta():(fa=t,t=a)):(fa=t,t=a),t}function di(){var t,r,e,u;return t=fa,n.substr(fa,6).toLowerCase()===on?(r=n.substr(fa,6),fa+=6):(r=a,0===ma&&ga($t)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=ra():(fa=t,t=a)):(fa=t,t=a),t}function yi(){var t,r,e,u;return t=fa,n.substr(fa,6).toLowerCase()===ln?(r=n.substr(fa,6),fa+=6):(r=a,0===ma&&ga(kt)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=ea():(fa=t,t=a)):(fa=t,t=a),t}function wi(){var t,r,e,u;return t=fa,n.substr(fa,4).toLowerCase()===cn?(r=n.substr(fa,4),fa+=4):(r=a,0===ma&&ga(Lt)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=aa():(fa=t,t=a)):(fa=t,t=a),t}function Ei(){var t,r,e,u;return t=fa,n.substr(fa,3).toLowerCase()===fn?(r=n.substr(fa,3),fa+=3):(r=a,0===ma&&ga(Ct)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=ua():(fa=t,t=a)):(fa=t,t=a),t}function Ii(){var t,r,e,u;return t=fa,n.substr(fa,4).toLowerCase()===pn?(r=n.substr(fa,4),fa+=4):(r=a,0===ma&&ga(Ut)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=ia():(fa=t,t=a)):(fa=t,t=a),t}function gi(){var t,r,e,u;return t=fa,n.substr(fa,4).toLowerCase()===vn?(r=n.substr(fa,4),fa+=4):(r=a,0===ma&&ga(_t)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=sa():(fa=t,t=a)):(fa=t,t=a),t}function xi(){var t,r,e,u;return t=fa,n.substr(fa,4).toLowerCase()===hn?(r=n.substr(fa,4),fa+=4):(r=a,0===ma&&ga(qt)),r!==a?(e=fa,ma++,u=Ya(),ma--,u===a?e=void 0:(fa=e,e=a),e!==a?t=oa():(fa=t,t=a)):(fa=t,t=a),t}function Ni(){var t;return 44===n.charCodeAt(fa)?(t=mn,fa++):(t=a,0===ma&&ga(Ht)),t}function Pi(){var t;return 40===n.charCodeAt(fa)?(t=dn,fa++):(t=a,0===ma&&ga(Bt)),t}function Ti(){var t;return 41===n.charCodeAt(fa)?(t=yn,fa++):(t=a,0===ma&&ga(Jt)),t}function Si(){var n,t;for(n=[],t=Ai();t!==a;)n.push(t),t=Ai();return n}function Ai(){var t;return Sn.test(n.charAt(fa))?(t=n.charAt(fa),fa++):(t=a,0===ma&&ga(Vt)),t}function Fi(){var t,r,e,u;if(t=fa,(r=Wa())!==a&&(r=la(r)),(t=r)===a)if(t=fa,96===n.charCodeAt(fa)?(r=wn,fa++):(r=a,0===ma&&ga(Gt)),r!==a){if(e=[],An.test(n.charAt(fa))?(u=n.charAt(fa),fa++):(u=a,0===ma&&ga(Wt)),u!==a)for(;u!==a;)e.push(u),An.test(n.charAt(fa))?(u=n.charAt(fa),fa++):(u=a,0===ma&&ga(Wt));else e=a;e!==a?(96===n.charCodeAt(fa)?(u=wn,fa++):(u=a,0===ma&&ga(Gt)),u!==a?t=ca(e):(fa=t,t=a)):(fa=t,t=a)}else fa=t,t=a;return t}function Ri(n,t){return{type:"unary-expression",operator:n,expr:t}}function bi(n,t,r,e){var a={type:"binary-expression",operator:n,left:t,right:r};return void 0!==e&&(a.escape=e),a}function Oi(n,t){for(var r=[n],e=0;e<t.length;e++)r.push(t[e][3]);return r}function Di(n,t,r){return Oi(n,t)}function Mi(n,t){for(var r=n,e=0;e<t.length;e++)r=bi(t[e][1],r,t[e][3]);return r}if((e=s())!==a&&fa===n.length)return e;throw e!==a&&fa<n.length&&ga(wa()),xa(ha,va<n.length?n.charAt(va):null,va<n.length?Ia(va,va+1):Ia(va,va))}return n(t,Error),t.prototype.format=function(n){var t="Error: "+this.message;if(this.location){var e,a=null;for(e=0;e<n.length;e++)if(n[e].source===this.location.source){a=n[e].text.split(/\r\n|\n|\r/g);break}var u=this.location.start,i=this.location.source&&"function"==typeof this.location.source.offset?this.location.source.offset(u):u,s=this.location.source+":"+i.line+":"+i.column;if(a){var o=this.location.end,l=r("",i.line.toString().length," "),c=a[u.line-1],f=(u.line===o.line?o.column:c.length+1)-u.column||1;t+="\n --\x3e "+s+"\n"+l+" |\n"+i.line+" | "+c+"\n"+l+" | "+r("",u.column-1," ")+r("",f,"^")}else t+="\n at "+s}return t},t.buildMessage=function(n,t){var r={literal:function(n){return'"'+a(n.text)+'"'},class:function(n){var t=n.parts.map((function(n){return Array.isArray(n)?u(n[0])+"-"+u(n[1]):u(n)}));return"["+(n.inverted?"^":"")+t.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(n){return n.description}};function e(n){return n.charCodeAt(0).toString(16).toUpperCase()}function a(n){return n.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(n){return"\\x0"+e(n)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(n){return"\\x"+e(n)}))}function u(n){return n.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(n){return"\\x0"+e(n)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(n){return"\\x"+e(n)}))}function i(n){return r[n.type](n)}function s(n){var t,r,e=n.map(i);if(e.sort(),e.length>0){for(t=1,r=1;t<e.length;t++)e[t-1]!==e[t]&&(e[r]=e[t],r++);e.length=r}switch(e.length){case 1:return e[0];case 2:return e[0]+" or "+e[1];default:return e.slice(0,-1).join(", ")+", or "+e[e.length-1]}}function o(n){return n?'"'+a(n)+'"':"end of input"}return"Expected "+s(n)+" but "+o(t)+" found."},{SyntaxError:t,parse:e}},(P=S).exports&&(P.exports=T());var A=S.exports;class F{static parse(n){return A.parse(n)}}const R=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,b=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,O=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,D=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,M=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,$=new Set(["current_timestamp","current_date","current_time"]);function k(n,t){return(n+="").length>=t?n:new Array(t-n.length+1).join("0")+n}function L(n,t,r="0",e="0",a="0",u="0",i="",s="0",o="0"){if("+"===i||"-"===i){const l=`${k(parseInt(n,10),4)}-${k(parseInt(t,10),2)}-${k(parseInt(r,10),2)}`;let c="";parseFloat(u)<10&&(c="0");const f=`${k(parseInt(e,10),2)}:${k(parseInt(a,10),2)}:${c+parseFloat(u).toString()}`,p=`${i}${k(parseInt(s,10),2)}:${k(parseInt(o,10),2)}`;return new Date(l+"T"+f+p)}return new Date(parseInt(n,10),parseInt(t,10)-1,parseInt(r,10),parseInt(e,10),parseInt(a,10),parseFloat(u))}class C{static makeBool(n){return H(n)}static featureValue(n,t,r,e){return tn(n,t,r,e)}static equalsNull(n){return null===n}static applyLike(n,t,r){return K(n,t,r)}static ensureArray(n){return B(n)}static applyIn(n,t){return W(n,t)}static currentDate(){const n=new Date;return n.setHours(0,0,0,0),n}static makeSqlInterval(n,t,r){return d.createFromValueAndQualifer(n,t,r)}static convertInterval(n){return n instanceof d?n.valueInMilliseconds():n}static currentTimestamp(){return new Date}static compare(n,t,r){return Q(n,t,r)}static calculate(n,t,r){return X(n,t,r)}static makeComparable(n){return Z(n)}static evaluateFunction(n,t){return y(n,t)}static lookup(n,t){const r=t[n];return void 0===r?null:r}static between(n,t){return null==n||null==t[0]||null==t[1]?null:n>=t[0]&&n<=t[1]}static notbetween(n,t){return null==n||null==t[0]||null==t[1]?null:n<t[0]||n>t[1]}static ternaryNot(n){return J(n)}static ternaryAnd(n,t){return V(n,t)}static ternaryOr(n,t){return G(n,t)}}class U{constructor(n,t){this.fieldsIndex=t,this._datefields={},this.parameters={},this._hasDateFunctions=void 0,this.parseTree=F.parse(n);const{isStandardized:r,isAggregate:e,referencedFieldNames:a}=this._extractExpressionInfo(t);this._referencedFieldNames=a,this.isStandardized=r,this.isAggregate=e}static create(n,t){return new U(n,t)}get fieldNames(){return this._referencedFieldNames}testSet(n,t=rn){const r={};for(const e of this.fieldNames)r[e]=n.map((n=>t.getAttribute(n,e)));return!!this._evaluateNode(this.parseTree,{attributes:r},rn)}calculateValue(n,t=rn){const r=this._evaluateNode(this.parseTree,n,t);return r instanceof d?r.valueInMilliseconds()/864e5:r}calculateValueCompiled(n,t=rn){return null!=this.parseTree._compiledVersion?this.parseTree._compiledVersion(n,this.parameters,t,this._datefields):r("esri-csp-restrictions")?this.calculateValue(n,t):(this._compileMe(),this.parseTree._compiledVersion(n,this.parameters,t,this._datefields))}testFeature(n,t=rn){return!!this._evaluateNode(this.parseTree,n,t)}testFeatureCompiled(n,t=rn){return null!=this.parseTree._compiledVersion?!!this.parseTree._compiledVersion(n,this.parameters,t,this._datefields):r("esri-csp-restrictions")?this.testFeature(n,t):(this._compileMe(),!!this.parseTree._compiledVersion(n,this.parameters,t,this._datefields))}get hasDateFunctions(){return null!=this._hasDateFunctions||(this._hasDateFunctions=!1,this._visitAll(this.parseTree,(n=>{"current-time"===n.type?this._hasDateFunctions=!0:"function"===n.type&&(this._hasDateFunctions=this._hasDateFunctions||$.has(n.name.toLowerCase()))}))),this._hasDateFunctions}getFunctions(){const n=new Set;return this._visitAll(this.parseTree,(t=>{"function"===t.type&&n.add(t.name.toLowerCase())})),Array.from(n)}getExpressions(){const n=new Map;return this._visitAll(this.parseTree,(t=>{if("function"===t.type){const r=t.name.toLowerCase(),e=t.args.value[0];if("column-reference"===e.type){const t=e.column,a=`${r}-${t}`;n.has(a)||n.set(a,{aggregateType:r,field:t})}}})),[...n.values()]}getVariables(){const n=new Set;return this._visitAll(this.parseTree,(t=>{"parameter"===t.type&&n.add(t.value.toLowerCase())})),Array.from(n)}_compileMe(){const n="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=new Function("feature","lookups","attributeAdapter","datefields",n).bind(C)}_extractExpressionInfo(n){const t=[],r=new Set;let e=!0,a=!0;return this._visitAll(this.parseTree,(i=>{switch(i.type){case"column-reference":{const e=n?.get(i.column);let a,u;e?a=u=e.name??"":(u=i.column,a=u.toLowerCase()),e&&e.name&&("date"===e.type||"esriFieldTypeDate"===e.type)&&(this._datefields[e.name]=1),r.has(a)||(r.add(a),t.push(u)),i.column=u;break}case"function":{const{name:n,args:t}=i,r=t.value.length;e&&(e=w(n,r)),a&&(a=u(n,r));break}}})),{referencedFieldNames:Array.from(t),isStandardized:e,isAggregate:a}}_visitAll(n,t){if(null!=n)switch(t(n),n.type){case"when-clause":this._visitAll(n.operand,t),this._visitAll(n.value,t);break;case"case-expression":for(const r of n.clauses)this._visitAll(r,t);"simple"===n.format&&this._visitAll(n.operand,t),null!==n.else&&this._visitAll(n.else,t);break;case"expression-list":for(const r of n.value)this._visitAll(r,t);break;case"unary-expression":this._visitAll(n.expr,t);break;case"binary-expression":this._visitAll(n.left,t),this._visitAll(n.right,t);break;case"function":this._visitAll(n.args,t)}}evaluateNodeToJavaScript(n){switch(n.type){case"interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(n.value)+", "+JSON.stringify(n.qualifier)+","+JSON.stringify(n.op)+")";case"case-expression":{let t="";if("simple"===n.format){const r="this.makeComparable("+this.evaluateNodeToJavaScript(n.operand)+")";t="( ";for(let e=0;e<n.clauses.length;e++)t+=" ("+r+" === this.makeComparable("+this.evaluateNodeToJavaScript(n.clauses[e].operand)+")) ? ("+this.evaluateNodeToJavaScript(n.clauses[e].value)+") : ";null!==n.else?t+=this.evaluateNodeToJavaScript(n.else):t+="null",t+=" )"}else{t="( ";for(let r=0;r<n.clauses.length;r++)t+=" this.makeBool("+this.evaluateNodeToJavaScript(n.clauses[r].operand)+")===true ? ("+this.evaluateNodeToJavaScript(n.clauses[r].value)+") : ";null!==n.else?t+=this.evaluateNodeToJavaScript(n.else):t+="null",t+=" )"}return t}case"parameter":return"this.lookup("+JSON.stringify(n.value.toLowerCase())+",lookups)";case"expression-list":{let t="[";for(const r of n.value)"["!==t&&(t+=","),t+=this.evaluateNodeToJavaScript(r);return t+="]",t}case"unary-expression":return"this.ternaryNot("+this.evaluateNodeToJavaScript(n.expr)+")";case"binary-expression":switch(n.operator){case"AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(n.left)+","+this.evaluateNodeToJavaScript(n.right)+" )";case"OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(n.left)+","+this.evaluateNodeToJavaScript(n.right)+" )";case"IS":if("null"!==n.right.type)throw new Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(n.left)+")";case"ISNOT":if("null"!==n.right.type)throw new Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(n.left)+")))";case"IN":return"this.applyIn("+this.evaluateNodeToJavaScript(n.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(n.right)+"))";case"NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(n.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(n.right)+")))";case"BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(n.left)+","+this.evaluateNodeToJavaScript(n.right)+")";case"NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(n.left)+","+this.evaluateNodeToJavaScript(n.right)+")";case"LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(n.left)+","+this.evaluateNodeToJavaScript(n.right)+","+JSON.stringify(n.escape)+")";case"NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(n.left)+","+this.evaluateNodeToJavaScript(n.right)+","+JSON.stringify(n.escape)+"))";case"<>":case"<":case">":case">=":case"<=":case"=":return"this.compare("+JSON.stringify(n.operator)+","+this.evaluateNodeToJavaScript(n.left)+","+this.evaluateNodeToJavaScript(n.right)+")";case"*":case"-":case"+":case"/":case"||":return"this.calculate("+JSON.stringify(n.operator)+","+this.evaluateNodeToJavaScript(n.left)+","+this.evaluateNodeToJavaScript(n.right)+")"}throw new Error("Not Supported Operator "+n.operator);case"null":case"boolean":case"string":case"number":return JSON.stringify(n.value);case"date":return"(new Date("+q(n.value).getTime().toString()+"))";case"timestamp":return"(new Date("+_(n.value).getTime().toString()+"))";case"current-time":return"date"===n.mode?"this.currentDate()":"this.currentTimestamp()";case"column-reference":return"this.featureValue(feature,"+JSON.stringify(n.column)+",datefields,attributeAdapter)";case"function":return"this.evaluateFunction("+JSON.stringify(n.name)+","+this.evaluateNodeToJavaScript(n.args)+")"}throw new Error("Unsupported sql syntax "+n.type)}_evaluateNode(n,t,r){switch(n.type){case"interval":{const e=this._evaluateNode(n.value,t,r);return d.createFromValueAndQualifer(e,n.qualifier,n.op)}case"case-expression":if("simple"===n.format){const e=Z(this._evaluateNode(n.operand,t,r));for(let a=0;a<n.clauses.length;a++)if(e===Z(this._evaluateNode(n.clauses[a].operand,t,r)))return this._evaluateNode(n.clauses[a].value,t,r);if(null!==n.else)return this._evaluateNode(n.else,t,r)}else{for(let e=0;e<n.clauses.length;e++)if(H(this._evaluateNode(n.clauses[e].operand,t,r)))return this._evaluateNode(n.clauses[e].value,t,r);if(null!==n.else)return this._evaluateNode(n.else,t,r)}return null;case"parameter":return this.parameters[n.value.toLowerCase()];case"expression-list":{const e=[];for(const a of n.value)e.push(this._evaluateNode(a,t,r));return e}case"unary-expression":return J(this._evaluateNode(n.expr,t,r));case"binary-expression":switch(n.operator){case"AND":return V(this._evaluateNode(n.left,t,r),this._evaluateNode(n.right,t,r));case"OR":return G(this._evaluateNode(n.left,t,r),this._evaluateNode(n.right,t,r));case"IS":if("null"!==n.right.type)throw new Error("Unsupported RHS for IS");return null===this._evaluateNode(n.left,t,r);case"ISNOT":if("null"!==n.right.type)throw new Error("Unsupported RHS for IS");return null!==this._evaluateNode(n.left,t,r);case"IN":{const e=B(this._evaluateNode(n.right,t,r));return W(this._evaluateNode(n.left,t,r),e)}case"NOT IN":{const e=B(this._evaluateNode(n.right,t,r));return J(W(this._evaluateNode(n.left,t,r),e))}case"BETWEEN":{const e=this._evaluateNode(n.left,t,r),a=this._evaluateNode(n.right,t,r);return null==e||null==a[0]||null==a[1]?null:e>=Z(a[0])&&e<=Z(a[1])}case"NOTBETWEEN":{const e=this._evaluateNode(n.left,t,r),a=this._evaluateNode(n.right,t,r);return null==e||null==a[0]||null==a[1]?null:e<Z(a[0])||e>Z(a[1])}case"LIKE":return K(this._evaluateNode(n.left,t,r),this._evaluateNode(n.right,t,r),n.escape);case"NOT LIKE":return J(K(this._evaluateNode(n.left,t,r),this._evaluateNode(n.right,t,r),n.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return Q(n.operator,this._evaluateNode(n.left,t,r),this._evaluateNode(n.right,t,r));case"-":case"+":case"*":case"/":case"||":return X(n.operator,this._evaluateNode(n.left,t,r),this._evaluateNode(n.right,t,r))}case"null":case"boolean":case"string":case"number":return n.value;case"date":return q(n.value);case"timestamp":return _(n.value);case"current-time":{const t=new Date;return"date"===n.mode&&t.setHours(0,0,0,0),t}case"column-reference":return tn(t,n.column,this._datefields,r);case"data-type":return n.value;case"function":{const e=this._evaluateNode(n.args,t,r);return this.isAggregate?a(n.name,e):y(n.name,e)}}throw new Error("Unsupported sql syntax "+n.type)}}function _(n){let t=b.exec(n);if(null!==t){const[,n,r,e,a,u,i]=t;return L(n,r,e,a,u,i)}if(t=O.exec(n),null!==t){const[,n,r,e,a,u,i,s,o,l]=t;return L(n,r,e,a,u,i,s,o,l)}if(t=D.exec(n),null!==t){const[,n,r,e,a,u,i,s,o]=t;return L(n,r,e,a,u,"0",i,s,o)}if(t=M.exec(n),null!==t){const[,n,r,e,a,u]=t;return L(n,r,e,a,u)}if(t=R.exec(n),null!==t){const[,n,r,e]=t;return L(n,r,e)}throw new Error("SQL Invalid Timestamp")}function q(n){const t=R.exec(n);if(null===t)try{return _(n)}catch{throw new Error("SQL Invalid Date")}const[,r,e,a]=t;return new Date(parseInt(r,10),parseInt(e,10)-1,parseInt(a,10))}function H(n){return!0===n}function B(n){return Array.isArray(n)?n:[n]}function J(n){return null!==n?!0!==n:null}function V(n,t){return null!=n&&null!=t?!0===n&&!0===t:!1!==n&&!1!==t&&null}function G(n,t){return null!=n&&null!=t?!0===n||!0===t:!0===n||!0===t||null}function W(n,t){if(null==n)return null;let r=!1;for(const e of t)if(null==e)r=null;else if(n===e){r=!0;break}return r}const z="-[]/{}()*+?.\\^$|";var Y;function j(n,t){const r=t;let e="",a=Y.Normal;for(let t=0;t<n.length;t++){const u=n.charAt(t);switch(a){case Y.Normal:u===r?a=Y.Escaped:z.includes(u)?e+="\\"+u:e+="%"===u?".*":"_"===u?".":u;break;case Y.Escaped:z.includes(u)?e+="\\"+u:e+=u,a=Y.Normal}}return new RegExp("^"+e+"$","m")}function K(n,t,r){if(null==n)return null;return j(t,r).test(n)}function Z(n){return n instanceof Date?n.valueOf():n}function Q(n,t,r){if(null==t||null==r)return null;const e=Z(t),a=Z(r);switch(n){case"<>":return e!==a;case"=":return e===a;case">":return e>a;case"<":return e<a;case">=":return e>=a;case"<=":return e<=a}}function X(n,t,r){if("||"===n)return y("concat",[t,r]);if(t instanceof d)if(r instanceof Date)switch(n){case"+":return new Date(t.valueInMilliseconds()+r.getTime());case"-":return t.valueInMilliseconds()-r.getTime();case"*":return t.valueInMilliseconds()*r.getTime();case"/":return t.valueInMilliseconds()/r.getTime()}else if(r instanceof d)switch(n){case"+":return d.createFromMilliseconds(t.valueInMilliseconds()+r.valueInMilliseconds());case"-":return d.createFromMilliseconds(t.valueInMilliseconds()-r.valueInMilliseconds());case"*":return t.valueInMilliseconds()*r.valueInMilliseconds();case"/":return t.valueInMilliseconds()/r.valueInMilliseconds()}else t=t.valueInMilliseconds();else if(r instanceof d)if(t instanceof Date)switch(n){case"+":return new Date(r.valueInMilliseconds()+t.getTime());case"-":return new Date(t.getTime()-r.valueInMilliseconds());case"*":return t.getTime()*r.valueInMilliseconds();case"/":return t.getTime()/r.valueInMilliseconds()}else r=r.valueInMilliseconds();else if(t instanceof Date&&"number"==typeof r)switch(r=24*r*60*60*1e3,t=t.getTime(),n){case"+":return new Date(t+r);case"-":return new Date(t-r);case"*":return new Date(t*r);case"/":return new Date(t/r)}else if(r instanceof Date&&"number"==typeof t)switch(t=24*t*60*60*1e3,r=r.getTime(),n){case"+":return new Date(t+r);case"-":return new Date(t-r);case"*":return new Date(t*r);case"/":return new Date(t/r)}switch(n){case"+":return t+r;case"-":return t-r;case"*":return t*r;case"/":return t/r}}function nn(n){return n&&"object"==typeof n.attributes}function tn(n,t,r,e){const a=e.getAttribute(n,t);return null!=a&&1===r[t]?new Date(a):a}!function(n){n[n.Normal=0]="Normal",n[n.Escaped=1]="Escaped"}(Y||(Y={}));const rn={getAttribute:(n,t)=>(nn(n)?n.attributes:n)[t]};const en=Object.freeze({__proto__:null,WhereClause:U,defaultAttributeAdapter:rn});export{en as W,U as f,v as n,m as o,p as s,c as t};
//# sourceMappingURL=p-b8ded059.js.map