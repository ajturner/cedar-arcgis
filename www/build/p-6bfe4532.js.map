{"version":3,"names":["c","FeatureLayer","SceneLayer","async","i","e","r","properties","customParameters","a","p","url","t","sublayerIds","layerOrTableId","layerId","sourceJSON","Constructor","s","import","title","parsedUrl","m","y","find","id","sublayerTitleMode","forEach","sublayerInfos","add","tableIds","tableInfos","tables","d","serverType","l","sublayer","o","FeatureServer","StreamServer","VectorTileServer","S","u","tileInfo","cacheType","format","toUpperCase","toLowerCase","path","layers","layerType","length","n","I","layerInfos","layerIds","b","type","hasOwnProperty","f","name","serviceUrl","layersJSON","serviceJSON","map","reverse"],"sources":["./node_modules/@arcgis/core/layers/support/arcgisLayers.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Error.js\";import{getFilename as r,urlToObject as a}from\"../../core/urlUtils.js\";import{parse as t,parseNonStandardSublayerUrl as s}from\"./arcgisLayerUrl.js\";import{fetchFeatureService as l}from\"./fetchService.js\";import{sceneServiceLayerTypeToClassName as n}from\"./layerUtils.js\";import{layerLookupMap as o}from\"./lazyLayerLoader.js\";import{fetchArcGISServiceJSON as u}from\"../../support/requestPresets.js\";const c={FeatureLayer:!0,SceneLayer:!0};async function i(e){const r=e.properties?.customParameters,a=await p(e.url,r),t={...e.properties,url:e.url};if(!a.sublayerIds)return null!=a.layerOrTableId&&(t.layerId=a.layerOrTableId,t.sourceJSON=a.sourceJSON),new a.Constructor(t);const s=new(0,(await import(\"../GroupLayer.js\")).default)({title:a.parsedUrl.title});return m(s,a,t),s}function y(e,r){return e?e.find((e=>e.id===r)):null}function m(e,r,a){function t(e,t){const s={...a,layerId:e,sublayerTitleMode:\"service-name\"};return null!=t&&(s.sourceJSON=t),new r.Constructor(s)}r.sublayerIds.forEach((a=>{const s=t(a,y(r.sublayerInfos,a));e.add(s)})),r.tableIds.forEach((a=>{const s=t(a,y(r.tableInfos,a));e.tables.add(s)}))}async function p(r,a){let s=t(r);if(null==s&&(s=await d(r,a)),null==s)throw new e(\"arcgis-layers:url-mismatch\",\"The url '${url}' is not a valid arcgis resource\",{url:r});const{serverType:l,sublayer:o}=s;let i;const y={FeatureServer:\"FeatureLayer\",StreamServer:\"StreamLayer\",VectorTileServer:\"VectorTileLayer\"};switch(l){case\"MapServer\":if(null!=o)i=\"FeatureLayer\";else{i=await S(r,a)?\"TileLayer\":\"MapImageLayer\"}break;case\"ImageServer\":{const e=await u(r,{customParameters:a}),{tileInfo:t,cacheType:s}=e;i=t?\"LERC\"!==t?.format?.toUpperCase()||s&&\"elevation\"!==s.toLowerCase()?\"ImageryTileLayer\":\"ElevationLayer\":\"ImageryLayer\";break}case\"SceneServer\":{const e=await u(s.url.path,{customParameters:a});if(i=\"SceneLayer\",e){const r=e?.layers;if(\"Voxel\"===e?.layerType)i=\"VoxelLayer\";else if(r?.length){const e=r[0]?.layerType;null!=e&&null!=n[e]&&(i=n[e])}}break}default:i=y[l]}const m=\"FeatureServer\"===l,p={parsedUrl:s,Constructor:null,layerOrTableId:m?o:void 0,sublayerIds:null,tableIds:null};if(c[i]&&null==o){const e=await I(r,l,a);m&&(p.sublayerInfos=e.layerInfos,p.tableInfos=e.tableInfos);1!==e.layerIds.length+e.tableIds.length?(p.sublayerIds=e.layerIds,p.tableIds=e.tableIds):m&&(p.layerOrTableId=e.layerIds[0]??e.tableIds[0],p.sourceJSON=e.layerInfos?.[0]??e.tableInfos?.[0])}return p.Constructor=await b(i),p}async function d(e,t){const l=await u(e,{customParameters:t});let n=null,o=null;const c=l.type;if(\"Feature Layer\"===c||\"Table\"===c?(n=\"FeatureServer\",o=l.id??null):\"indexedVector\"===c?n=\"VectorTileServer\":l.hasOwnProperty(\"mapName\")?n=\"MapServer\":l.hasOwnProperty(\"bandCount\")&&l.hasOwnProperty(\"pixelSizeX\")?n=\"ImageServer\":l.hasOwnProperty(\"maxRecordCount\")&&l.hasOwnProperty(\"allowGeometryUpdates\")?n=\"FeatureServer\":l.hasOwnProperty(\"streamUrls\")?n=\"StreamServer\":f(l)?(n=\"SceneServer\",o=l.id):l.hasOwnProperty(\"layers\")&&f(l.layers?.[0])&&(n=\"SceneServer\"),!n)return null;const i=null!=o?s(e):null;return{title:null!=i&&l.name||r(e),serverType:n,sublayer:o,url:{path:null!=i?i.serviceUrl:a(e).path}}}function f(e){return null!=e&&e.hasOwnProperty(\"store\")&&e.hasOwnProperty(\"id\")&&\"number\"==typeof e.id}async function I(e,r,a){let t,s=!1;if(\"FeatureServer\"===r){const r=await l(e,{customParameters:a});s=!!r.layersJSON,t=r.layersJSON||r.serviceJSON}else t=await u(e,{customParameters:a});const n=t?.layers,o=t?.tables;return{layerIds:n?.map((e=>e.id)).reverse()||[],tableIds:o?.map((e=>e.id)).reverse()||[],layerInfos:s?n:[],tableInfos:s?o:[]}}async function b(e){return(0,o[e])()}async function S(e,r){return(await u(e,{customParameters:r})).tileInfo}export{i as fromUrl};\n"],"mappings":"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"}