import{c2 as n,c3 as t,c4 as e,c5 as l,c6 as r}from"./p-b54724b6.js";import{d as u,a as o}from"./p-1b31d781.js";const i=(n,t,e)=>[t,e],a=(n,t,e)=>[t,e,n[2]],s=(n,t,e)=>[t,e,n[2],n[3]];function c(n){if(!n)return null;return{originPosition:"upper-left"===n.originPosition?"upperLeft":"lower-left"===n.originPosition?"lowerLeft":n.originPosition,scale:n.tolerance?[n.tolerance,n.tolerance]:[1,1],translate:null!=n.extent?[n.extent.xmin,n.extent.ymax]:[0,0]}}function f({scale:n,translate:t},e){return Math.round((e-t[0])/n[0])}function d({scale:n,translate:t},e){return Math.round((t[1]-e)/n[1])}function m(n,t,e){const l=[];let r,u,o,i;for(let a=0;a<e.length;a++){const s=e[a];a>0?(o=f(n,s[0]),i=d(n,s[1]),o===r&&i===u||(l.push(t(s,o-r,i-u)),r=o,u=i)):(r=f(n,s[0]),u=d(n,s[1]),l.push(t(s,r,u)))}return l.length>0?l:null}function p(n,t,e,l){return m(n,e?l?s:a:l?a:i,t)}function v(n,t,e,l){const r=[],u=e?l?s:a:l?a:i;for(let e=0;e<t.length;e++){const l=m(n,u,t[e]);l&&l.length>=3&&r.push(l)}return r.length?r:null}function y(n,t,e,l){const r=[],u=e?l?s:a:l?a:i;for(let e=0;e<t.length;e++){const l=m(n,u,t[e]);l&&l.length>=2&&r.push(l)}return r.length?r:null}function b({scale:n,translate:t},e){return e*n[0]+t[0]}function T({scale:n,translate:t},e){return t[1]-e*n[1]}function g(n,t,e){const l=new Array(e.length);if(!e.length)return l;const[r,u]=n.scale;let o=b(n,e[0][0]),i=T(n,e[0][1]);l[0]=t(e[0],o,i);for(let n=1;n<e.length;n++){const a=e[n];o+=a[0]*r,i-=a[1]*u,l[n]=t(a,o,i)}return l}function F(n,t,e){const l=new Array(e.length);for(let r=0;r<e.length;r++)l[r]=g(n,t,e[r]);return l}function V(n,t,e,l){return g(n,e?l?s:a:l?a:i,t)}function z(n,t,e,l){return F(n,e?l?s:a:l?a:i,t)}function D(n,t,e,l){return F(n,e?l?s:a:l?a:i,t)}function N(n,t,e,l,r){return t.xmin=f(n,e.xmin),t.ymin=d(n,e.ymin),t.xmax=f(n,e.xmax),t.ymax=d(n,e.ymax),t!==e&&(l&&(t.zmin=e.zmin,t.zmax=e.zmax),r&&(t.mmin=e.mmin,t.mmax=e.mmax)),t}function h(n,t,e,l,r){return t.points=p(n,e.points,l,r)??[],t}function x(n,t,e,l,r){return t.x=f(n,e.x),t.y=d(n,e.y),t!==e&&(l&&(t.z=e.z),r&&(t.m=e.m)),t}function M(n,t,e,l,r){const u=v(n,e.rings,l,r);return u?(t.rings=u,t):null}function I(n,t,e,l,r){const u=y(n,e.paths,l,r);return u?(t.paths=u,t):null}function k(u,o){return u&&o?n(o)?x(u,{},o,!1,!1):t(o)?I(u,{},o,!1,!1):e(o)?M(u,{},o,!1,!1):l(o)?h(u,{},o,!1,!1):r(o)?N(u,{},o,!1,!1):null:null}function w(n,t,e,l,r){return null!=e&&(t.points=V(n,e.points,l,r)),t}function S(n,t,e,l,r){return null==e||(t.x=b(n,e.x),t.y=T(n,e.y),t!==e&&(l&&(t.z=e.z),r&&(t.m=e.m))),t}function $(n,t,e,l,r){return null!=e&&(t.rings=D(n,e.rings,l,r)),t}function C(n,t,e,l,r){return null!=e&&(t.paths=z(n,e.paths,l,r)),t}const q="<Null>",G="equal-interval",B=1,j=5,A=10,L=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,U=new Set(["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]),P=["min","max","avg","stddev","count","sum","variance","nullcount","median"];function E(n){return null==n||"string"==typeof n&&!n?q:n}function H(n){const t=null!=n.normalizationField||null!=n.normalizationType,e=null!=n.minValue||null!=n.maxValue,l=!!n.sqlExpression&&n.supportsSQLExpression;return!t&&!e&&!l}function J(n){const t=n.returnDistinct?[...new Set(n.values)]:n.values,e=t.filter((n=>null!=n)).sort(),l=e.length,r={count:l,min:e[0],max:e[l-1]};return n.supportsNullCount&&(r.nullcount=t.length-l),n.percentileParams&&(r.median=O(t,n.percentileParams)),r}function K(n){const{values:t,useSampleStdDev:e,supportsNullCount:l}=n;let r=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY,o=null,i=null,a=null,s=null,c=0;const f=null==n.minValue?-1/0:n.minValue,d=null==n.maxValue?1/0:n.maxValue;for(const n of t)Number.isFinite(n)?n>=f&&n<=d&&(o=null===o?n:o+n,r=Math.min(r,n),u=Math.max(u,n),c++):"string"==typeof n&&c++;if(c&&null!=o){i=o/c;let n=0;for(const e of t)Number.isFinite(e)&&e>=f&&e<=d&&(n+=(e-i)**2);s=e?c>1?n/(c-1):0:c>0?n/c:0,a=Math.sqrt(s)}else r=null,u=null;const m={avg:i,count:c,max:u,min:r,stddev:a,sum:o,variance:s};return l&&(m.nullcount=t.length-c),n.percentileParams&&(m.median=O(t,n.percentileParams)),m}function O(n,t){const{fieldType:e,value:l,orderBy:r,isDiscrete:u}=t,o=Q(e,"desc"===r);if(0===(n=[...n].filter((n=>null!=n)).sort(((n,t)=>o(n,t)))).length)return null;if(l<=0)return n[0];if(l>=1)return n[n.length-1];const i=(n.length-1)*l,a=Math.floor(i),s=a+1,c=i%1,f=n[a],d=n[s];return s>=n.length||u||"string"==typeof f||"string"==typeof d?f:f*(1-c)+d*c}function Q(n,t){const e=t?1:-1,l=X(t),r=W(t);if(!(!!n&&["esriFieldTypeDate","esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...U].includes(n)))return(n,t)=>"number"==typeof n&&"number"==typeof t?l(n,t):"string"==typeof n&&"string"==typeof t?r(n,t):e;if("esriFieldTypeDate"===n)return(n,t)=>{const r=new Date(n).getTime(),u=new Date(t).getTime();return isNaN(r)||isNaN(u)?e:l(r,u)};if(U.has(n))return(n,t)=>l(n,t);if("esriFieldTypeString"===n)return(n,t)=>r(n,t);if("esriFieldTypeGUID"===n||"esriFieldTypeGlobalID"===n){const n=W(t);return(t,e)=>n(Y(t),Y(e))}return t?(n,t)=>1:(n,t)=>-1}function R(n,t,e){if(e){if(null==n)return null==t?0:1;if(null==t)return-1}else{if(null==n)return null==t?0:-1;if(null==t)return 1}return null}function W(n){return n?(n,t)=>{const e=R(n,t,!0);return null!=e?e:(n=n.toUpperCase())>(t=t.toUpperCase())?-1:n<t?1:0}:(n,t)=>{const e=R(n,t,!1);return null!=e?e:(n=n.toUpperCase())<(t=t.toUpperCase())?-1:n>t?1:0}}function X(n){return n?(n,t)=>{const e=R(n,t,!0);return null!=e?e:t-n}:(n,t)=>{const e=R(n,t,!1);return null!=e?e:n-t}}function Y(n){return n.substr(24,12)+n.substr(19,4)+n.substr(16,2)+n.substr(14,2)+n.substr(11,2)+n.substr(9,2)+n.substr(6,2)+n.substr(4,2)+n.substr(2,2)+n.substr(0,2)}function Z(n,t){let e;for(e in n)P.includes(e)&&(Number.isFinite(n[e])||(n[e]=null));return t?(["avg","stddev","variance"].forEach((t=>{null!=n[t]&&(n[t]=Math.ceil(n[t]??0))})),n):n}function _(n){const t={};for(let e of n)(null==e||"string"==typeof e&&""===e.trim())&&(e=null),null==t[e]?t[e]={count:1,data:e}:t[e].count++;return{count:t}}function nn(n){return"coded-value"!==n?.type?[]:n.codedValues.map((n=>n.code))}function tn(n,t,e,l){const r=n.count,u=[];if(e&&t){const n=[],e=nn(t[0]);for(const r of e)if(t[1]){const e=nn(t[1]);for(const u of e)if(t[2]){const e=nn(t[2]);for(const t of e)n.push(`${E(r)}${l}${E(u)}${l}${E(t)}`)}else n.push(`${E(r)}${l}${E(u)}`)}else n.push(r);for(const t of n)r.hasOwnProperty(t)||(r[t]={data:t,count:0})}for(const n in r){const t=r[n];u.push({value:t.data,count:t.count,label:t.label})}return{uniqueValueInfos:u}}function en(n,t,e,l){let r=null;switch(t){case"log":0!==n&&(r=Math.log(n)*Math.LOG10E);break;case"percent-of-total":Number.isFinite(l)&&0!==l&&(r=n/l*100);break;case"field":Number.isFinite(e)&&0!==e&&(r=n/e);break;case"natural-log":n>0&&(r=Math.log(n));break;case"square-root":n>0&&(r=n**.5)}return r}function ln(n,t){const e=un({field:t.field,normalizationType:t.normalizationType,normalizationField:t.normalizationField,classificationMethod:t.classificationMethod,standardDeviationInterval:t.standardDeviationInterval,breakCount:t.numClasses||j});return n=rn(n,t.minValue,t.maxValue),o({definition:e,values:n,normalizationTotal:t.normalizationTotal})}function rn(n,t,e){const l=t??-1/0,r=e??1/0;return n.filter((n=>Number.isFinite(n)&&n>=l&&n<=r))}function un(n){const{breakCount:t,field:e,normalizationField:l,normalizationType:r}=n,o=n.classificationMethod||G,i="standard-deviation"===o?n.standardDeviationInterval||B:void 0;return new u({breakCount:t,classificationField:e,classificationMethod:o,normalizationField:"field"===r?l:void 0,normalizationType:r,standardDeviationInterval:i})}function on(n,t){let e=n.classBreaks;const l=e.length,r=e[0]?.minValue,u=e[l-1]?.maxValue,o="standard-deviation"===t,i=L;return e=e.map((n=>{const t=n.label,e={minValue:n.minValue,maxValue:n.maxValue,label:t};if(o&&t){const n=t.match(i),l=n?.map((n=>+n.trim()))??[];2===l.length?(e.minStdDev=l[0],e.maxStdDev=l[1],l[0]<0&&l[1]>0&&(e.hasAvg=!0)):1===l.length&&(t.includes("<")?(e.minStdDev=null,e.maxStdDev=l[0]):t.includes(">")&&(e.minStdDev=l[0],e.maxStdDev=null))}return e})),{minValue:r,maxValue:u,classBreakInfos:e,normalizationTotal:n.normalizationTotal}}function an(n,t){const e=sn(n,t);if(null==e.min&&null==e.max)return{bins:[],minValue:e.min,maxValue:e.max,normalizationTotal:t.normalizationTotal};const l=e.intervals,r=e.min??0,u=e.max??0,o=l.map(((n,t)=>({minValue:l[t][0],maxValue:l[t][1],count:0})));for(const t of n)if(null!=t&&t>=r&&t<=u){const n=cn(l,t);n>-1&&o[n].count++}return{bins:o,minValue:r,maxValue:u,normalizationTotal:t.normalizationTotal}}function sn(n,t){const{field:e,classificationMethod:l,standardDeviationInterval:r,normalizationType:u,normalizationField:o,normalizationTotal:i,minValue:a,maxValue:s}=t,c=t.numBins||A;let f=null,d=null,m=null;if((!l||"equal-interval"===l)&&!u){if(null!=a&&null!=s)f=a,d=s;else{const t=K({values:n,minValue:a,maxValue:s,useSampleStdDev:!u,supportsNullCount:H({normalizationType:u,normalizationField:o,minValue:a,maxValue:s})});f=t.min??null,d=t.max??null}m=fn(f??0,d??0,c)}else{const{classBreaks:t}=ln(n,{field:e,normalizationType:u,normalizationField:o,normalizationTotal:i,classificationMethod:l,standardDeviationInterval:r,minValue:a,maxValue:s,numClasses:c});f=t[0].minValue,d=t[t.length-1].maxValue,m=t.map((n=>[n.minValue,n.maxValue]))}return{min:f,max:d,intervals:m}}function cn(n,t){let e=-1;for(let l=n.length-1;l>=0;l--){if(t>=n[l][0]){e=l;break}}return e}function fn(n,t,e){const l=(t-n)/e,r=[];let u,o=n;for(let n=1;n<=e;n++)u=o+l,u=Number(u.toFixed(16)),r.push([o,n===e?t:u]),o=u;return r}export{fn as $,ln as D,tn as F,x as L,an as M,un as N,on as S,w as U,c as a,k as b,E as c,K as d,C as e,J as f,Z as g,S as k,H as m,O as p,$ as q,P as s,Q as v,_ as x,en as z};
//# sourceMappingURL=p-98e621d1.js.map