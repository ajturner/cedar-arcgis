import{i as t}from"./p-623dbe5e.js";import{de as e,dr as n,ds as s}from"./p-b54724b6.js";class i{}var r;i.instance=new e.IANAZone("Etc/UTC"),function(t){t.TimeZoneNotRecognised="TimeZoneNotRecognised"}(r||(r={}));const o={[r.TimeZoneNotRecognised]:"Timezone identifier has not been recognised."};class u extends Error{constructor(e,n){super(t(o[e],n)),this.declaredRootClass="esri.arcade.arcadedate.dateerror",Error.captureStackTrace&&Error.captureStackTrace(this,u)}}class h{constructor(t){this._date=t,this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(t=0,n=1,s=1,i=0,r=0,o=0,u=0,c){if(isNaN(t)||isNaN(n)||isNaN(s)||isNaN(i)||isNaN(r)||isNaN(o)||isNaN(u))return null;let l=0;const d=e.DateTime.local(t,n).daysInMonth;s<1&&(l=s-1,s=1),s>d&&(l=s-d,s=d);let m=0;n>12?(m=n-12,n=12):n<1&&(m=n-1,n=1);let f=0;r>59?(f=r-59,r=59):r<0&&(f=r,r=0);let w=0;o>59?(w=o-59,o=59):o<0&&(w=o,o=0);let T=0;u>999?(T=u-999,u=999):u<0&&(T=u,u=0);let g=e.DateTime.fromObject({day:s,year:t,month:n,hour:i,minute:r,second:o,millisecond:u},{zone:a(c)});return 0!==m&&(g=g.plus({months:m})),0!==l&&(g=g.plus({days:l})),0!==f&&(g=g.plus({minutes:f})),0!==w&&(g=g.plus({seconds:w})),0!==T&&(g=g.plus({milliseconds:T})),new h(g)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}static arcadeDateAndZoneToArcadeDate(t,e){const n=a(e);return t.isUnknownTimeZone||n===i.instance?h.fromParts(t.year,t.monthJS+1,t.day,t.hour,t.minute,t.second,t.millisecond,n):new h(t._date.setZone(e))}static dateJSToArcadeDate(t){return new h(e.DateTime.fromJSDate(t,{zone:"system"}))}static dateJSAndZoneToArcadeDate(t,n="system"){return new h(e.DateTime.fromJSDate(t,{zone:n}))}static unknownEpochToArcadeDate(t){return new h(e.DateTime.fromMillis(t,{zone:i.instance}))}static unknownDateJSToArcadeDate(t){return new h(e.DateTime.fromMillis(t.getTime(),{zone:i.instance}))}static epochToArcadeDate(t,n="system"){return new h(e.DateTime.fromMillis(t,{zone:n}))}static dateTimeToArcadeDate(t){return new h(t)}clone(){return new h(this._date)}changeTimeZone(t){const e=a(t);return h.dateTimeToArcadeDate(this._date.setZone(e))}static dateTimeAndZoneToArcadeDate(t,e){const n=a(e);return t.zone===i.instance||n===i.instance?h.fromParts(t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond,n):new h(t.setZone(n))}static nowToArcadeDate(t){return new h(e.DateTime.fromJSDate(new Date,{zone:t}))}static nowUTCToArcadeDate(){return new h(e.DateTime.utc())}get isSystem(){return"system"===this.timeZone||this.timeZone===h.systemTimeZoneCanonicalName}equals(t){return this.isSystem&&t.isSystem?this.toNumber()===t.toNumber():this.isUnknownTimeZone===t.isUnknownTimeZone&&this._date.equals(t._date)}get isUnknownTimeZone(){return this._date.zone===i.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let t=this._date.weekday;return t>6&&(t=0),t}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";const t=this.zone;return"fixed"===t.type?0===t.fixed?"utc":t.formatOffset(0,"short"):t.name}stringify(){return JSON.stringify(this.toJSDate())}plus(t){return new h(this._date.plus(t))}diff(t,e="milliseconds"){return this._date.diff(t._date,e)[e]}toISOString(t){return t?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toFormat(t,e){return this._date.toFormat(t,e)}toJSDate(){return this._date.toJSDate()}toSQLString(){return"timestamp '"+this._date.toFormat("yyyy-LL-dd HH:mm:ss")+"'"}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new h(this._date.toUTC())}toLocal(){return new h(this._date.toLocal())}toString(){return this.toISOString(!0)}}function a(t){if(t instanceof e.Zone)return t;if("system"===t.toLowerCase())return"system";if("utc"===t.toLowerCase())return"utc";if("unknown"===t.toLowerCase())return i.instance;if(/^[\+\-]?[0-9]{1,2}([:][0-9]{2})?$/.test(t)){const n=e.FixedOffsetZone.parseSpecifier("UTC"+(t.startsWith("+")||t.startsWith("-")?"":"+")+t);if(n)return n}const n=e.IANAZone.create(t);if(!n.isValid)throw new u(r.TimeZoneNotRecognised);return n}function c(t){return t?.timeZoneIANA?t?.timeZoneIANA:t?.timeZone?s(t,""):""}class l{constructor(){this.dateTimeReferenceMetaData=null,this._fieldTimeZoneIndex={},this._fieldIndex=null,this._ianaPreferred=null,this._ianaTimeInfo=null,this._ianaEditFields=null,this._ianaLayerDateFields=null}static create(t,e){const s=new l;return s.dateTimeReferenceMetaData=e,s._fieldIndex=t instanceof n?t:new n(t),s}static createFromLayer(t){if(!t)return null;if(!t.fieldsIndex)return!t.declaredClass&&t.fields?l.create(t.fields,t):null;const e=new l;return e._fieldIndex=t.fieldsIndex,e.dateTimeReferenceMetaData={timeInfo:t?.timeInfo?.toJSON()??null,editFieldsInfo:t?.editFieldsInfo?.toJSON()??null,dateFieldsTimeReference:t?.dateFieldsTimeReference?.toJSON()??null,preferredTimeReference:t?.preferredTimeReference?.toJSON()??null,datesInUnknownTimezone:!0===t?.datesInUnknownTimezone},e}fieldTimeZone(t){const e=this._fieldIndex?.get(t);if(!e)return null;if("date"!==e.type&&"esriFieldTypeDate"!==e.type)return null;const n=this._fieldTimeZoneIndex[e.name];if(void 0!==n)return n;const s=[{field:this.dateTimeReferenceMetaData?.editFieldsInfo?.creationDateField,timeReference:this.dateTimeReferenceMetaData?.editFieldsInfo?.dateFieldsTimeReference,isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone},{field:this.dateTimeReferenceMetaData?.editFieldsInfo?.editDateField,timeReference:this.dateTimeReferenceMetaData?.editFieldsInfo?.dateFieldsTimeReference,isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone},{field:this.dateTimeReferenceMetaData?.timeInfo?.startTimeField,timeReference:this.dateTimeReferenceMetaData?.timeInfo?.timeReference,isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone},{field:this.dateTimeReferenceMetaData?.timeInfo?.endTimeField,timeReference:this.dateTimeReferenceMetaData?.timeInfo?.timeReference,isunknown:!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone}];for(const t of s)if(t.field===e.name){const n=this.convertToIANA(t.timeReference,t.isunknown);return this._fieldTimeZoneIndex[e.name]=n,n}const i=this.convertToIANA(this.dateTimeReferenceMetaData?.dateFieldsTimeReference,this.dateTimeReferenceMetaData?.datesInUnknownTimezone);return this._fieldTimeZoneIndex[e.name]=i,i}convertToIANA(t,e){return e?"unknown":c(t)}get layerPreferredTimeZone(){if(null!==this._ianaPreferred)return this._ianaPreferred;this._ianaPreferred="";const t=this.dateTimeReferenceMetaData?.preferredTimeReference;return this._ianaPreferred=this.convertToIANA(t,!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone),this._ianaPreferred}get layerTimeInfoTimeZone(){if(null!==this._ianaTimeInfo)return this._ianaTimeInfo;this._ianaTimeInfo="";const t=this.dateTimeReferenceMetaData?.timeInfo?.timeReference;return this._ianaTimeInfo=this.convertToIANA(t,!1),this._ianaTimeInfo}get layerEditFieldsTimeZone(){if(null!==this._ianaEditFields)return this._ianaEditFields;this._ianaEditFields="";const t=this.dateTimeReferenceMetaData?.editFieldsInfo?.dateFieldsTimeReference;return this._ianaEditFields=this.convertToIANA(t,this.dateTimeReferenceMetaData?.datesInUnknownTimezone),this._ianaEditFields}get layerDateFieldsTimeZone(){if(null!==this._ianaLayerDateFields)return this._ianaLayerDateFields;this._ianaLayerDateFields="";const t=this.dateTimeReferenceMetaData?.dateFieldsTimeReference;return this._ianaLayerDateFields=this.convertToIANA(t,!0===this.dateTimeReferenceMetaData?.datesInUnknownTimezone),this._ianaLayerDateFields}}export{l as T,h as c,a as u};
//# sourceMappingURL=p-2f568dc7.js.map