{"version":3,"names":["y","visible","definitionExpression","labelingInfo","labelsVisible","opacity","minScale","maxScale","renderer","source","m","s","r","constructor","e","super","this","floors","scale","destroy","layer","dynamicLayers","hasDynamicLayers","visibleSublayers","map","l","toExportImageJSON","length","JSON","stringify","n","serviceSublayers","gdbVersion","_get","_set","handles","remove","add","allSublayers","on","notifyChange","propertyName","layers","id","join","layerDefs","filter","floorInfo","reduce","i","t","version","commitProperty","sublayers","o","a","forEach","unshift","some","toJSON","dpi","format","imageFormat","transparent","imageTransparency","readOnly","prototype","type","Number"],"sources":["./node_modules/@arcgis/core/layers/support/ExportImageParameters.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Accessor.js\";import{HandleOwnerMixin as s}from\"../../core/HandleOwner.js\";import{sqlAnd as t}from\"../../core/sql.js\";import{property as i}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import{subclass as o}from\"../../core/accessorSupport/decorators/subclass.js\";import{combinedViewLayerTimeExtentProperty as a}from\"./commonProperties.js\";import{getLayerFloorFilterClause as l}from\"./floorFilterUtils.js\";import{isExportDynamic as n}from\"./sublayerUtils.js\";const y={visible:\"visibleSublayers\",definitionExpression:\"layerDefs\",labelingInfo:\"hasDynamicLayers\",labelsVisible:\"hasDynamicLayers\",opacity:\"hasDynamicLayers\",minScale:\"visibleSublayers\",maxScale:\"visibleSublayers\",renderer:\"hasDynamicLayers\",source:\"hasDynamicLayers\"};let m=class extends(s(r)){constructor(e){super(e),this.floors=null,this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const e=this.visibleSublayers.map((e=>{const r=l(this.floors,e);return e.toExportImageJSON(r)}));return e.length?JSON.stringify(e):null}get hasDynamicLayers(){return this.layer&&n(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}set layer(e){this._get(\"layer\")!==e&&(this._set(\"layer\",e),this.handles.remove(\"layer\"),e&&this.handles.add([e.allSublayers.on(\"change\",(()=>this.notifyChange(\"visibleSublayers\"))),e.on(\"sublayer-update\",(e=>this.notifyChange(y[e.propertyName])))],\"layer\"))}get layers(){const e=this.visibleSublayers;return e?e.length?\"show:\"+e.map((e=>e.id)).join(\",\"):\"show:-1\":null}get layerDefs(){const e=!!this.floors?.length,r=this.visibleSublayers.filter((r=>null!=r.definitionExpression||e&&null!=r.floorInfo));return r.length?JSON.stringify(r.reduce(((e,r)=>{const s=l(this.floors,r),i=t(s,r.definitionExpression);return null!=i&&(e[r.id]=i),e}),{})):null}get version(){this.commitProperty(\"layers\"),this.commitProperty(\"layerDefs\"),this.commitProperty(\"dynamicLayers\"),this.commitProperty(\"timeExtent\");const e=this.layer;return e&&(e.commitProperty(\"dpi\"),e.commitProperty(\"imageFormat\"),e.commitProperty(\"imageTransparency\"),e.commitProperty(\"gdbVersion\")),(this._get(\"version\")||0)+1}get visibleSublayers(){const e=[];if(!this.layer)return e;const r=this.layer.sublayers,s=r=>{const t=this.scale,i=0===t,o=0===r.minScale||t<=r.minScale,a=0===r.maxScale||t>=r.maxScale;r.visible&&(i||o&&a)&&(r.sublayers?r.sublayers.forEach(s):e.unshift(r))};r&&r.forEach(s);const t=this._get(\"visibleSublayers\");return!t||t.length!==e.length||t.some(((r,s)=>e[s]!==r))?e:t}toJSON(){const e=this.layer;let r={dpi:e.dpi,format:e.imageFormat,transparent:e.imageTransparency,gdbVersion:e.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?r.dynamicLayers=this.dynamicLayers:r={...r,layers:this.layers,layerDefs:this.layerDefs},r}};e([i({readOnly:!0})],m.prototype,\"dynamicLayers\",null),e([i()],m.prototype,\"floors\",void 0),e([i({readOnly:!0})],m.prototype,\"hasDynamicLayers\",null),e([i()],m.prototype,\"layer\",null),e([i({readOnly:!0})],m.prototype,\"layers\",null),e([i({readOnly:!0})],m.prototype,\"layerDefs\",null),e([i({type:Number})],m.prototype,\"scale\",void 0),e([i(a)],m.prototype,\"timeExtent\",void 0),e([i({readOnly:!0})],m.prototype,\"version\",null),e([i({readOnly:!0})],m.prototype,\"visibleSublayers\",null),m=e([o(\"esri.layers.mixins.ExportImageParameters\")],m);export{m as ExportImageParameters};\n"],"mappings":"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"}