import{t as n,e as r}from"./p-623dbe5e.js";import{Q as t,V as e,z as i,L as o,q as f,an as u,I as s}from"./p-122f2dcc.js";import{f as a}from"./p-b8ded059.js";import"./p-b54724b6.js";import"./p-2f568dc7.js";import"./p-70146138.js";import"./p-a3f0a5f3.js";import"./p-e6a64715.js";import"./p-dc29c329.js";async function c(n,r,t,o,c,m){if(1===o.length){if(i(o[0]))return u(n,o[0],s(o[1],-1));if(f(o[0]))return u(n,o[0].toArray(),s(o[1],-1))}else if(2===o.length){if(i(o[0]))return u(n,o[0],s(o[1],-1));if(f(o[0]))return u(n,o[0].toArray(),s(o[1],-1));if(e(o[0])){const t=await o[0].load(),e=await p(a.create(o[1],t.getFieldsIndex()),m,c);return o[0].calculateStatistic(n,e,s(o[2],1e3),r.abortSignal)}}else if(3===o.length&&e(o[0])){const t=await o[0].load(),e=await p(a.create(o[1],t.getFieldsIndex()),m,c);return o[0].calculateStatistic(n,e,s(o[2],1e3),r.abortSignal)}return u(n,o,-1)}async function p(n,r,t){const e=n.getVariables();if(e.length>0){const i=[];for(let n=0;n<e.length;n++){const o={name:e[n]};i.push(await r.evaluateIdentifier(t,o))}const o={};for(let n=0;n<e.length;n++)o[e[n]]=i[n];return n.parameters=o,n}return n}function m(u){"async"===u.mode&&(u.functions.stdev=function(n,r){return u.standardFunctionAsync(n,r,((r,t,e)=>c("stdev",r,t,e,n,u)))},u.functions.variance=function(n,r){return u.standardFunctionAsync(n,r,((r,t,e)=>c("variance",r,t,e,n,u)))},u.functions.average=function(n,r){return u.standardFunctionAsync(n,r,((r,t,e)=>c("mean",r,t,e,n,u)))},u.functions.mean=function(n,r){return u.standardFunctionAsync(n,r,((r,t,e)=>c("mean",r,t,e,n,u)))},u.functions.sum=function(n,r){return u.standardFunctionAsync(n,r,((r,t,e)=>c("sum",r,t,e,n,u)))},u.functions.min=function(n,r){return u.standardFunctionAsync(n,r,((r,t,e)=>c("min",r,t,e,n,u)))},u.functions.max=function(n,r){return u.standardFunctionAsync(n,r,((r,t,e)=>c("max",r,t,e,n,u)))},u.functions.count=function(s,a){return u.standardFunctionAsync(s,a,((u,c,p)=>{if(t(p,1,1,s,a),e(p[0]))return p[0].count(u.abortSignal);if(i(p[0])||o(p[0]))return p[0].length;if(f(p[0]))return p[0].length();throw new n(s,r.InvalidParameter,a)}))})}export{m as registerFunctions};
//# sourceMappingURL=p-f024b901.js.map