import{e7 as n,ek as t,el as r,ee as e,aA as o,em as s,l as a,y as i,n as u,o as l,cV as c,en as f,cW as p,eo as m,ep as y,eq as g,er as h,es as w,b as A,et as F,eu as b,ev as v,ew as j,ex as x,ey as P,ez as d,ed as C,eA as M,eB as N,eC as T,aJ as _,eD as S,eE as B,cM as R,eF as I}from"./p-b54724b6.js";import{e as O}from"./p-de65f975.js";import{e as q,o as z}from"./p-cc24e5bd.js";import{a as E,o as L,g as $,B as k}from"./p-52a9dec5.js";import{c as D}from"./p-2563414c.js";import{m as J,p as U,t as V,o as W}from"./p-4f2ece68.js";import{m as G}from"./p-728b50df.js";import{v as H,y as K,x as Q}from"./p-cc3f40fb.js";import{e as X}from"./p-603bf978.js";import{n as Y,s as Z,r as nn}from"./p-1cec84d0.js";import{i as tn,T as rn}from"./p-76eeb521.js";function en(n=pn){return[n[0],n[1],n[2],n[3]]}function on(t,r,e=en()){return n(un(e),t),e[3]=r,e}function sn(n,t,r=en()){return H(mn,un(n),cn(n)),H(yn,un(t),cn(t)),K(mn,yn,mn),fn(r,o(Q(un(r),mn)))}function an(n,e,o,a=en()){return on(s,n,gn),on(t,e,hn),on(r,o,wn),sn(gn,hn,gn),sn(gn,wn,a),a}function un(n){return n}function ln(n){return n[3]}function cn(n){return e(n[3])}function fn(n,t){return n[3]=t,n}const pn=[0,0,1,0],mn=X(),yn=X(),gn=en(),hn=en(),wn=en();var An;let Fn=An=class extends l{constructor(n){super(n),this.translation=c(),this.rotationAxis=f(pn),this.rotationAngle=0,this.scale=p(1,1,1)}get rotation(){return on(this.rotationAxis,this.rotationAngle)}set rotation(n){this.rotationAxis=m(un(n)),this.rotationAngle=ln(n)}get localMatrix(){const n=q();return H(bn,un(this.rotation),cn(this.rotation)),y(n,bn,this.translation,this.scale),n}get localMatrixInverse(){return g(q(),this.localMatrix)}applyLocal(n,t){return h(t,n,this.localMatrix)}applyLocalInverse(n,t){return h(t,n,this.localMatrixInverse)}equals(n){return this===n||null!=n&&w(this.localMatrix,n.localMatrix)}clone(){const n={translation:m(this.translation),rotationAxis:m(this.rotationAxis),rotationAngle:this.rotationAngle,scale:m(this.scale)};return new An(n)}};a([i({type:[Number],nonNullable:!0,json:{write:!0}})],Fn.prototype,"translation",void 0),a([i({type:[Number],nonNullable:!0,json:{write:!0}})],Fn.prototype,"rotationAxis",void 0),a([i({type:Number,nonNullable:!0,json:{write:!0}})],Fn.prototype,"rotationAngle",void 0),a([i({type:[Number],nonNullable:!0,json:{write:!0}})],Fn.prototype,"scale",void 0),a([i()],Fn.prototype,"rotation",null),a([i()],Fn.prototype,"localMatrix",null),a([i()],Fn.prototype,"localMatrixInverse",null),Fn=An=a([u("esri.geometry.support.MeshTransform")],Fn);const bn=X(),vn=Fn;function jn(n,t){return n.isGeographic||n.isWebMercator&&(t?.geographic??!0)}function xn(n,t,r){const e=!n.isGeoreferenced;null!=r?.geographic&&r.geographic!==e&&A.getLogger(t).warnOnce(`Specifying the 'geographic' parameter (${r.geographic}) for a Mesh vertex space of type "${n.type}" is not supported. This parameter will be ignored.`)}const Pn=A.getLogger("esri.geometry.support.meshUtils.normalProjection");function dn(n,t,r,e,o){return In(e)?(Rn(zn.TO_PCPF,tn.fromTypedArray(n),rn.fromTypedArray(t),rn.fromTypedArray(r),e,tn.fromTypedArray(o)),o):(Pn.error("Cannot convert spatial reference to PCPF"),o)}function Cn(n,t,r,e,o){return In(e)?(Rn(zn.FROM_PCPF,tn.fromTypedArray(n),rn.fromTypedArray(t),rn.fromTypedArray(r),e,tn.fromTypedArray(o)),o):(Pn.error("Cannot convert to spatial reference from PCPF"),o)}function Mn(n,t,r){return F(n,t,0,r,D(t),0,n.length/3),r}function Nn(n,t,r){return F(n,D(r),0,t,r,0,n.length/3),t}function Tn(n,t,r){return $(kn,r),Y(t,n,kn),k(kn)||Z(t,t),t}function _n(n,t,r){if($(kn,r),Y(t,n,kn,4),k(kn)||Z(t,t,4),n!==t)for(let r=3;r<n.length;r+=4)t[r]=n[r];return t}function Sn(n,t,r,e,o){if(!In(e))return Pn.error("Cannot convert spatial reference to PCPF"),o;Rn(zn.TO_PCPF,tn.fromTypedArray(n,4*Float32Array.BYTES_PER_ELEMENT),rn.fromTypedArray(t),rn.fromTypedArray(r),e,tn.fromTypedArray(o,4*Float32Array.BYTES_PER_ELEMENT));for(let t=3;t<n.length;t+=4)o[t]=n[t];return o}function Bn(n,t,r,e,o){if(!In(e))return Pn.error("Cannot convert to spatial reference from PCPF"),o;Rn(zn.FROM_PCPF,tn.fromTypedArray(n,16),rn.fromTypedArray(t),rn.fromTypedArray(r),e,tn.fromTypedArray(o,16));for(let t=3;t<n.length;t+=4)o[t]=n[t];return o}function Rn(n,t,r,e,o,s){if(!t)return;const a=r.count,i=D(o);if(On(o))for(let r=0;r<a;r++)e.getVec(r,En),t.getVec(r,Ln),x(i,En,$n,i),E(kn,$n),n===zn.FROM_PCPF&&L(kn,kn),P(Ln,Ln,kn),s.setVec(r,Ln);else for(let o=0;o<a;o++){e.getVec(o,En),t.getVec(o,Ln),x(i,En,$n,i),E(kn,$n);const a=d(r.get(o,1));let u=Math.cos(a);n===zn.TO_PCPF&&(u=1/u),kn[0]*=u,kn[1]*=u,kn[2]*=u,kn[3]*=u,kn[4]*=u,kn[5]*=u,n===zn.FROM_PCPF&&L(kn,kn),P(Ln,Ln,kn),C(Ln,Ln),s.setVec(o,Ln)}return s}function In(n){return On(n)||qn(n)}function On(n){return n.isWGS84||b(n)||v(n)||j(n)}function qn(n){return n.isWebMercator}var zn;!function(n){n[n.TO_PCPF=0]="TO_PCPF",n[n.FROM_PCPF=1]="FROM_PCPF"}(zn||(zn={}));const En=c(),Ln=c(),$n=q(),kn=O();function Dn(n,t,r){return jn(t.spatialReference,r)?Kn(n,t,r):Hn(n,t,r)}function Jn(n,t,r,e){const{position:o,normal:s,tangent:a}=n;if(!t.isRelative)return{position:o,normal:s,tangent:a};const i=r?.localMatrix??z;return Dn({position:nn(new Float64Array(o.length),o,i),normal:null!=s?Tn(s,new Float32Array(s.length),i):null,tangent:null!=a?_n(a,new Float32Array(a.length),i):null},t.getOriginPoint(e),{geographic:!t.isGeoreferenced})}function Un(n,t,r){if(r?.useTransform){const{position:e,normal:o,tangent:s}=n,{x:a,y:i,z:u}=t,l=p(a,i,u??0);return{vertexAttributes:{position:e,normal:o,tangent:s},vertexSpace:r.geographic??1?new J({origin:l}):new G({origin:l}),transform:new vn}}return{vertexAttributes:Dn(n,t,r),vertexSpace:new U,transform:null}}function Vn(n,t,r){return jn(t.spatialReference,r)?nt(n,t,r):Zn(n,t,r)}function Wn(n,t,r,e,o){if(!t.isRelative)return Vn(n,e,o);const{spatialReference:s}=e,a=Jn(n,t,r,s);return e.equals(t.getOriginPoint(s))?Zn(a,e,o):Vn(a,e,o)}function Gn({positions:n,transform:t,vertexSpace:r,inSpatialReference:e,outSpatialReference:o,outPositions:s,local:a}){const i=r.isRelative?r.origin:T,u=r.isRelative?t?.localMatrix??z:z;if(r.isGeoreferenced){const t=s??V(n.length);if(M(u,z)?W(t,n):nn(t,n,u),!N(i,T)){const[n,r,e]=i;for(let o=0;o<t.length;o+=3)t[o]+=n,t[o+1]+=r,t[o+2]+=e}return F(t,e,0,t,o,0,t.length/3),t}const l=D(e),c=!a&&_(e,l)?l:e;x(e,i,at,c),S(at,at,u);const f=s??V(n.length);return nn(f,n,at),F(f,c,0,f,o,0,f.length/3),f}function Hn(n,t,r){const e=new Float64Array(n.position.length),o=n.position,s=t.x,a=t.y,i=t.z??0,u=st(r?r.unit:null,t.spatialReference);for(let n=0;n<o.length;n+=3)e[n]=o[n]*u+s,e[n+1]=o[n+1]*u+a,e[n+2]=o[n+2]*u+i;return{position:e,normal:n.normal,tangent:n.tangent}}function Kn(n,t,r){const e=t.spatialReference,o=tt(t,r,at),s=new Float64Array(n.position.length),a=Qn(n.position,o,e,s),i=$(ut,o);return{position:a,normal:Xn(a,s,n.normal,i,e),tangent:Yn(a,s,n.tangent,i,e)}}function Qn(n,t,r,e){nn(e,n,t);const o=new Float64Array(n.length);return Nn(e,o,r)}function Xn(n,t,r,e,o){if(null==r)return null;const s=new Float32Array(r.length);return Y(s,r,e),Cn(s,n,t,o,s),s}function Yn(n,t,r,e,o){if(null==r)return null;const s=new Float32Array(r.length);Y(s,r,e,4);for(let n=3;n<s.length;n+=4)s[n]=r[n];return Bn(s,n,t,o,s),s}function Zn(n,t,r){const e=new Float64Array(n.position.length),o=n.position,s=t.x,a=t.y,i=t.z??0,u=st(r?r.unit:null,t.spatialReference);for(let n=0;n<o.length;n+=3)e[n]=(o[n]-s)/u,e[n+1]=(o[n+1]-a)/u,e[n+2]=(o[n+2]-i)/u;return{position:e,normal:n.normal,tangent:n.tangent}}function nt(n,t,r){const e=t.spatialReference;tt(t,r,at);const o=g(it,at),s=new Float64Array(n.position.length),a=rt(n.position,e,o,s),i=$(ut,o);return{position:a,normal:et(n.normal,n.position,s,e,i),tangent:ot(n.tangent,n.position,s,e,i)}}function tt(n,t,r){x(n.spatialReference,[n.x,n.y,n.z??0],r,D(n.spatialReference));const e=st(t?t.unit:null,n.spatialReference);return B(r,r,[e,e,e]),r}function rt(n,t,r,e){const o=Mn(n,t,e),s=new Float64Array(o.length);return nn(s,o,r),s}function et(n,t,r,e,o){if(null==n)return null;const s=dn(n,t,r,e,new Float32Array(n.length));return Y(s,s,o),s}function ot(n,t,r,e,o){if(null==n)return null;const s=Sn(n,t,r,e,new Float32Array(n.length));return Y(s,s,o,4),s}function st(n,t){if(null==n)return 1;const r=R(t);return 1/I(r,"meters",n)}const at=q(),it=q(),ut=O();const lt=Object.freeze({__proto__:null,georeference:Dn,georeferenceApplyTransform:Jn,georeferenceByTransform:Un,project:Gn,ungeoreference:Vn,ungeoreferenceByTransform:Wn});export{Vn as D,Nn as E,Gn as I,vn as N,Dn as O,Sn as R,Jn as T,dn as _,en as a,Wn as b,lt as c,sn as g,Mn as h,Cn as j,an as l,xn as o,Un as q,jn as r,Bn as v,cn as w,un as x};
//# sourceMappingURL=p-3800516a.js.map