import{b0 as n,aT as t,ce as e,a6 as r,b7 as i,dn as u,dl as l,ab as o,bn as f,a$ as s}from"./p-b54724b6.js";import{l as a,Q as c,B as w,d as h,z as p,q as d,y as m,m as N,V as y,t as g,u as j,v as b,w as v,x,a as S,H as M,I as R,K as D,M as J,P as L,A as O,S as z,U as A,X as Z}from"./p-122f2dcc.js";import{disjoint as H,intersects as k,touches as q,crosses as B,within as C,contains as F,overlaps as I,equals as K,relate as P,intersect as T,union as U,difference as V,symmetricDifference as X,clip as $,cut as E,planarArea as G,geodesicArea as Q,planarLength as W,geodesicLength as Y,distance as _,densify as nn,geodesicDensify as tn,generalize as en,buffer as rn,geodesicBuffer as un,offset as ln,rotate as on,simplify as fn,isSimple as sn,convexHull as an,nearestCoordinate as cn,nearestVertex as wn}from"./p-3ba72354.js";import{t as hn,e as pn}from"./p-623dbe5e.js";import{t as dn,s as mn}from"./p-f89e9181.js";import"./p-2f568dc7.js";import"./p-70146138.js";import"./p-a3f0a5f3.js";import"./p-e6a64715.js";import"./p-dc29c329.js";function Nn(n){return 0===u.indexOf("4.")?i.fromExtent(n):new i({spatialReference:n.spatialReference,rings:[[[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,n.ymin]]]})}function yn(t,e,r){if(c(t,2,2,e,r),t[0]instanceof n&&t[1]instanceof n);else if(t[0]instanceof n&&null===t[1]);else if(t[1]instanceof n&&null===t[0]);else if(null!==t[0]||null!==t[1])throw new hn(e,pn.InvalidParameter,r)}async function gn(n,t){if("polygon"!==n.type&&"polyline"!==n.type&&"extent"!==n.type)return 0;let r=1;if(n.spatialReference.vcsWkid||n.spatialReference.latestVcsWkid){r=A(n.spatialReference)/s(n.spatialReference)}let i=0;if("polyline"===n.type)for(const t of n.paths)for(let n=1;n<t.length;n++)i+=Z(t[n],t[n-1],r);else if("polygon"===n.type)for(const t of n.rings){for(let n=1;n<t.length;n++)i+=Z(t[n],t[n-1],r);(t[0][0]!==t[t.length-1][0]||t[0][1]!==t[t.length-1][1]||void 0!==t[0][2]&&t[0][2]!==t[t.length-1][2])&&(i+=Z(t[0],t[t.length-1],r))}else"extent"===n.type&&(i+=2*Z([n.xmin,n.ymin,0],[n.xmax,n.ymin,0],r),i+=2*Z([n.xmin,n.ymin,0],[n.xmin,n.ymax,0],r),i*=2,i+=4*Math.abs(R(n.zmax,0)*r-R(n.zmin,0)*r));const u=new e({hasZ:!1,hasM:!1,spatialReference:n.spatialReference,paths:[[0,0],[0,i]]});return W(u,t)}function jn(u){"async"===u.mode&&(u.functions.disjoint=function(n,t){return u.standardFunctionAsync(n,t,((e,r,i)=>(yn(i=a(i),n,t),null===i[0]||null===i[1]||H(i[0],i[1]))))},u.functions.intersects=function(n,t){return u.standardFunctionAsync(n,t,((e,r,i)=>(yn(i=a(i),n,t),null!==i[0]&&null!==i[1]&&k(i[0],i[1]))))},u.functions.touches=function(n,t){return u.standardFunctionAsync(n,t,((e,r,i)=>(yn(i=a(i),n,t),null!==i[0]&&null!==i[1]&&q(i[0],i[1]))))},u.functions.crosses=function(n,t){return u.standardFunctionAsync(n,t,((e,r,i)=>(yn(i=a(i),n,t),null!==i[0]&&null!==i[1]&&B(i[0],i[1]))))},u.functions.within=function(n,t){return u.standardFunctionAsync(n,t,((e,r,i)=>(yn(i=a(i),n,t),null!==i[0]&&null!==i[1]&&C(i[0],i[1]))))},u.functions.contains=function(n,t){return u.standardFunctionAsync(n,t,((e,r,i)=>(yn(i=a(i),n,t),null!==i[0]&&null!==i[1]&&F(i[0],i[1]))))},u.functions.overlaps=function(n,t){return u.standardFunctionAsync(n,t,((e,r,i)=>(yn(i=a(i),n,t),null!==i[0]&&null!==i[1]&&I(i[0],i[1]))))},u.functions.equals=function(t,e){return u.standardFunctionAsync(t,e,((r,i,u)=>(c(u,2,2,t,e),u[0]===u[1]||(u[0]instanceof n&&u[1]instanceof n?K(u[0],u[1]):!(!w(u[0])||!w(u[1]))&&u[0].equals(u[1])))))},u.functions.relate=function(t,e){return u.standardFunctionAsync(t,e,((r,i,u)=>{if(u=a(u),c(u,3,3,t,e),u[0]instanceof n&&u[1]instanceof n)return P(u[0],u[1],h(u[2]));if(u[0]instanceof n&&null===u[1])return!1;if(u[1]instanceof n&&null===u[0])return!1;if(null===u[0]&&null===u[1])return!1;throw new hn(t,pn.InvalidParameter,e)}))},u.functions.intersection=function(n,t){return u.standardFunctionAsync(n,t,((e,r,i)=>(yn(i=a(i),n,t),null===i[0]||null===i[1]?null:T(i[0],i[1]))))},u.functions.union=function(t,e){return u.standardFunctionAsync(t,e,((r,i,u)=>{const l=[];if(0===(u=a(u)).length)throw new hn(t,pn.WrongNumberOfParameters,e);if(1===u.length)if(p(u[0])){const r=a(u[0]);for(let i=0;i<r.length;i++)if(null!==r[i]){if(!(r[i]instanceof n))throw new hn(t,pn.InvalidParameter,e);l.push(r[i])}}else{if(!d(u[0])){if(u[0]instanceof n)return m(N(u[0]),t.spatialReference);if(null===u[0])return null;throw new hn(t,pn.InvalidParameter,e)}{const r=a(u[0].toArray());for(let i=0;i<r.length;i++)if(null!==r[i]){if(!(r[i]instanceof n))throw new hn(t,pn.InvalidParameter,e);l.push(r[i])}}}else for(let r=0;r<u.length;r++)if(null!==u[r]){if(!(u[r]instanceof n))throw new hn(t,pn.InvalidParameter,e);l.push(u[r])}return 0===l.length?null:U(l)}))},u.functions.difference=function(n,t){return u.standardFunctionAsync(n,t,((e,r,i)=>(yn(i=a(i),n,t),null!==i[0]&&null===i[1]?N(i[0]):null===i[0]?null:V(i[0],i[1]))))},u.functions.symmetricdifference=function(n,t){return u.standardFunctionAsync(n,t,((e,r,i)=>(yn(i=a(i),n,t),null===i[0]&&null===i[1]?null:null===i[0]?N(i[1]):null===i[1]?N(i[0]):X(i[0],i[1]))))},u.functions.clip=function(e,r){return u.standardFunctionAsync(e,r,((i,u,l)=>{if(l=a(l),c(l,2,2,e,r),!(l[1]instanceof t)&&null!==l[1])throw new hn(e,pn.InvalidParameter,r);if(null===l[0])return null;if(!(l[0]instanceof n))throw new hn(e,pn.InvalidParameter,r);return null===l[1]?null:$(l[0],l[1])}))},u.functions.cut=function(t,r){return u.standardFunctionAsync(t,r,((i,u,l)=>{if(l=a(l),c(l,2,2,t,r),!(l[1]instanceof e)&&null!==l[1])throw new hn(t,pn.InvalidParameter,r);if(null===l[0])return[];if(!(l[0]instanceof n))throw new hn(t,pn.InvalidParameter,r);return null===l[1]?[N(l[0])]:E(l[0],l[1])}))},u.functions.area=function(t,e){return u.standardFunctionAsync(t,e,(async(r,i,u)=>{if(c(u,1,2,t,e),null===(u=a(u))[0])return 0;if(y(u[0])){const n=await u[0].sumArea(g(R(u[1],-1)),!1,t.abortSignal);if(t.abortSignal.aborted)throw new hn(t,pn.Cancelled,e);return n}if(p(u[0])||d(u[0])){const n=j(u[0],t.spatialReference);return null===n?0:G(n,g(R(u[1],-1)))}if(!(u[0]instanceof n))throw new hn(t,pn.InvalidParameter,e);return G(u[0],g(R(u[1],-1)))}))},u.functions.areageodetic=function(t,e){return u.standardFunctionAsync(t,e,(async(r,i,u)=>{if(c(u,1,2,t,e),null===(u=a(u))[0])return 0;if(y(u[0])){const n=await u[0].sumArea(g(R(u[1],-1)),!0,t.abortSignal);if(t.abortSignal.aborted)throw new hn(t,pn.Cancelled,e);return n}if(p(u[0])||d(u[0])){const n=j(u[0],t.spatialReference);return null===n?0:Q(n,g(R(u[1],-1)))}if(!(u[0]instanceof n))throw new hn(t,pn.InvalidParameter,e);return Q(u[0],g(R(u[1],-1)))}))},u.functions.length=function(t,e){return u.standardFunctionAsync(t,e,(async(r,i,u)=>{if(c(u,1,2,t,e),null===(u=a(u))[0])return 0;if(y(u[0])){const n=await u[0].sumLength(b(R(u[1],-1)),!1,t.abortSignal);if(t.abortSignal.aborted)throw new hn(t,pn.Cancelled,e);return n}if(p(u[0])||d(u[0])){const n=v(u[0],t.spatialReference);return null===n?0:W(n,b(R(u[1],-1)))}if(!(u[0]instanceof n))throw new hn(t,pn.InvalidParameter,e);return W(u[0],b(R(u[1],-1)))}))},u.functions.length3d=function(t,e){return u.standardFunctionAsync(t,e,((r,i,u)=>{if(c(u,1,2,t,e),null===(u=a(u))[0])return 0;if(p(u[0])||d(u[0])){const n=v(u[0],t.spatialReference);return null===n?0:!0===n.hasZ?gn(n,b(R(u[1],-1))):W(n,b(R(u[1],-1)))}if(!(u[0]instanceof n))throw new hn(t,pn.InvalidParameter,e);return!0===u[0].hasZ?gn(u[0],b(R(u[1],-1))):W(u[0],b(R(u[1],-1)))}))},u.functions.lengthgeodetic=function(t,e){return u.standardFunctionAsync(t,e,(async(r,i,u)=>{if(c(u,1,2,t,e),null===(u=a(u))[0])return 0;if(y(u[0])){const n=await u[0].sumLength(b(R(u[1],-1)),!0,t.abortSignal);if(t.abortSignal.aborted)throw new hn(t,pn.Cancelled,e);return n}if(p(u[0])||d(u[0])){const n=v(u[0],t.spatialReference);return null===n?0:Y(n,b(R(u[1],-1)))}if(!(u[0]instanceof n))throw new hn(t,pn.InvalidParameter,e);return Y(u[0],b(R(u[1],-1)))}))},u.functions.distance=function(t,e){return u.standardFunctionAsync(t,e,((r,i,u)=>{u=a(u),c(u,2,3,t,e);let l=u[0];(p(u[0])||d(u[0]))&&(l=x(u[0],t.spatialReference));let o=u[1];if((p(u[1])||d(u[1]))&&(o=x(u[1],t.spatialReference)),!(l instanceof n))throw new hn(t,pn.InvalidParameter,e);if(!(o instanceof n))throw new hn(t,pn.InvalidParameter,e);return _(l,o,b(R(u[2],-1)))}))},u.functions.distancegeodetic=function(n,t){return u.standardFunctionAsync(n,t,((i,u,l)=>{l=a(l),c(l,2,3,n,t);const o=l[0],f=l[1];if(!(o instanceof r))throw new hn(n,pn.InvalidParameter,t);if(!(f instanceof r))throw new hn(n,pn.InvalidParameter,t);const s=new e({paths:[],spatialReference:o.spatialReference});return s.addPath([o,f]),Y(s,b(R(l[2],-1)))}))},u.functions.densify=function(r,l){return u.standardFunctionAsync(r,l,((u,o,f)=>{if(f=a(f),c(f,2,3,r,l),null===f[0])return null;if(!(f[0]instanceof n))throw new hn(r,pn.InvalidParameter,l);const s=S(f[1]);if(isNaN(s))throw new hn(r,pn.InvalidParameter,l);if(s<=0)throw new hn(r,pn.InvalidParameter,l);return f[0]instanceof i||f[0]instanceof e?nn(f[0],s,b(R(f[2],-1))):f[0]instanceof t?nn(Nn(f[0]),s,b(R(f[2],-1))):f[0]}))},u.functions.densifygeodetic=function(r,l){return u.standardFunctionAsync(r,l,((u,o,f)=>{if(f=a(f),c(f,2,3,r,l),null===f[0])return null;if(!(f[0]instanceof n))throw new hn(r,pn.InvalidParameter,l);const s=S(f[1]);if(isNaN(s))throw new hn(r,pn.InvalidParameter,l);if(s<=0)throw new hn(r,pn.InvalidParameter,l);return f[0]instanceof i||f[0]instanceof e?tn(f[0],s,b(R(f[2],-1))):f[0]instanceof t?tn(Nn(f[0]),s,b(R(f[2],-1))):f[0]}))},u.functions.generalize=function(t,e){return u.standardFunctionAsync(t,e,((r,i,u)=>{if(u=a(u),c(u,2,4,t,e),null===u[0])return null;if(!(u[0]instanceof n))throw new hn(t,pn.InvalidParameter,e);const l=S(u[1]);if(isNaN(l))throw new hn(t,pn.InvalidParameter,e);return en(u[0],l,M(R(u[2],!0)),b(R(u[3],-1)))}))},u.functions.buffer=function(t,e){return u.standardFunctionAsync(t,e,((r,i,u)=>{if(u=a(u),c(u,2,3,t,e),null===u[0])return null;if(!(u[0]instanceof n))throw new hn(t,pn.InvalidParameter,e);const l=S(u[1]);if(isNaN(l))throw new hn(t,pn.InvalidParameter,e);return 0===l?N(u[0]):rn(u[0],l,b(R(u[2],-1)))}))},u.functions.buffergeodetic=function(t,e){return u.standardFunctionAsync(t,e,((r,i,u)=>{if(u=a(u),c(u,2,3,t,e),null===u[0])return null;if(!(u[0]instanceof n))throw new hn(t,pn.InvalidParameter,e);const l=S(u[1]);if(isNaN(l))throw new hn(t,pn.InvalidParameter,e);return 0===l?N(u[0]):un(u[0],l,b(R(u[2],-1)))}))},u.functions.offset=function(n,t){return u.standardFunctionAsync(n,t,((r,u,l)=>{if(l=a(l),c(l,2,6,n,t),null===l[0])return null;if(!(l[0]instanceof i||l[0]instanceof e))throw new hn(n,pn.InvalidParameter,t);const o=S(l[1]);if(isNaN(o))throw new hn(n,pn.InvalidParameter,t);const f=S(R(l[4],10));if(isNaN(f))throw new hn(n,pn.InvalidParameter,t);const s=S(R(l[5],0));if(isNaN(s))throw new hn(n,pn.InvalidParameter,t);return ln(l[0],o,b(R(l[2],-1)),h(R(l[3],"round")).toLowerCase(),f,s)}))},u.functions.rotate=function(e,l){return u.standardFunctionAsync(e,l,((u,o,f)=>{f=a(f),c(f,2,3,e,l);let s=f[0];if(null===s)return null;if(!(s instanceof n))throw new hn(e,pn.InvalidParameter,l);s instanceof t&&(s=i.fromExtent(s));const w=S(f[1]);if(isNaN(w))throw new hn(e,pn.InvalidParameter,l);const h=R(f[2],null);if(null===h)return on(s,w);if(h instanceof r)return on(s,w,h);throw new hn(e,pn.InvalidParameter,l)}))},u.functions.centroid=function(o,f){return u.standardFunctionAsync(o,f,((u,s,w)=>{if(w=a(w),c(w,1,1,o,f),null===w[0])return null;let h=w[0];if((p(w[0])||d(w[0]))&&(h=x(w[0],o.spatialReference)),null===h)return null;if(!(h instanceof n))throw new hn(o,pn.InvalidParameter,f);return h instanceof r?m(N(w[0]),o.spatialReference):h instanceof i?h.centroid:h instanceof e?D(h):h instanceof l?J(h):h instanceof t?h.center:null}))},u.functions.multiparttosinglepart=function(f,s){return u.standardFunctionAsync(f,s,(async(u,w,h)=>{h=a(h),c(h,1,1,f,s);const p=[];if(null===h[0])return null;if(!(h[0]instanceof n))throw new hn(f,pn.InvalidParameter,s);if(h[0]instanceof r)return[m(N(h[0]),f.spatialReference)];if(h[0]instanceof t)return[m(N(h[0]),f.spatialReference)];const d=await fn(h[0]);if(d instanceof i){const n=[],t=[];for(let e=0;e<d.rings.length;e++)if(d.isClockwise(d.rings[e])){const t=o({rings:[d.rings[e]],hasZ:!0===d.hasZ,hazM:!0===d.hasM,spatialReference:d.spatialReference.toJSON()});n.push(t)}else t.push({ring:d.rings[e],pt:d.getPoint(e,0)});for(let e=0;e<t.length;e++)for(let r=0;r<n.length;r++)if(n[r].contains(t[e].pt)){n[r].addRing(t[e].ring);break}return n}if(d instanceof e){const n=[];for(let t=0;t<d.paths.length;t++){const e=o({paths:[d.paths[t]],hasZ:!0===d.hasZ,hazM:!0===d.hasM,spatialReference:d.spatialReference.toJSON()});n.push(e)}return n}if(h[0]instanceof l){const n=m(N(h[0]),f.spatialReference);for(let t=0;t<n.points.length;t++)p.push(n.getPoint(t));return p}return null}))},u.functions.issimple=function(t,e){return u.standardFunctionAsync(t,e,((r,i,u)=>{if(u=a(u),c(u,1,1,t,e),null===u[0])return!0;if(!(u[0]instanceof n))throw new hn(t,pn.InvalidParameter,e);return sn(u[0])}))},u.functions.simplify=function(t,e){return u.standardFunctionAsync(t,e,((r,i,u)=>{if(u=a(u),c(u,1,1,t,e),null===u[0])return null;if(!(u[0]instanceof n))throw new hn(t,pn.InvalidParameter,e);return fn(u[0])}))},u.functions.convexhull=function(t,e){return u.standardFunctionAsync(t,e,((r,i,u)=>{if(u=a(u),c(u,1,1,t,e),null===u[0])return null;if(!(u[0]instanceof n))throw new hn(t,pn.InvalidParameter,e);return an(u[0])}))},u.functions.getuser=function(n,t){return u.standardFunctionAsync(n,t,(async(e,r,i)=>{c(i,0,2,n,t);let u=R(i[1],""),l=!0===u;if(u=!0===u||!1===u?"":h(u),0===i.length||i[0]instanceof L){let t=null;t=n.services&&n.services.portal?n.services.portal:f.getDefault(),i.length>0&&(t=dn(i[0],t));const e=await mn(t,u,l);if(e){const t=JSON.parse(JSON.stringify(e));for(const n of["lastLogin","created","modified"])void 0!==t[n]&&null!==t[n]&&(t[n]=new Date(t[n]));return O.convertObjectToArcadeDictionary(t,z(n))}return null}let o=null;if(y(i[0])&&(o=i[0]),o){if(l=!1,u)return null;await o.load();const t=await o.getOwningSystemUrl();if(!t){if(!u){const t=await o.getIdentityUser();return t?O.convertObjectToArcadeDictionary({username:t},z(n)):null}return null}let e=null;e=n.services&&n.services.portal?n.services.portal:f.getDefault(),e=dn(new L(t),e);const r=await mn(e,u,l);if(r){const t=JSON.parse(JSON.stringify(r));for(const n of["lastLogin","created","modified"])void 0!==t[n]&&null!==t[n]&&(t[n]=new Date(t[n]));return O.convertObjectToArcadeDictionary(t,z(n))}return null}throw new hn(n,pn.InvalidParameter,t)}))}),u.functions.nearestcoordinate=function(t,e){return u.standardFunctionAsync(t,e,(async(i,u,l)=>{if(l=a(l),c(l,2,2,t,e),!(l[0]instanceof n||null===l[0]))throw new hn(t,pn.InvalidParameter,e);if(!(l[1]instanceof r||null===l[1]))throw new hn(t,pn.InvalidParameter,e);if(null===l[0]||null===l[1])return null;const o=await cn(l[0],l[1]);return null===o?null:O.convertObjectToArcadeDictionary({coordinate:o.coordinate,distance:o.distance},z(t),!1,!0)}))},u.functions.nearestvertex=function(t,e){return u.standardFunctionAsync(t,e,(async(i,u,l)=>{if(l=a(l),c(l,2,2,t,e),!(l[0]instanceof n||null===l[0]))throw new hn(t,pn.InvalidParameter,e);if(!(l[1]instanceof r||null===l[1]))throw new hn(t,pn.InvalidParameter,e);if(null===l[0]||null===l[1])return null;const o=await wn(l[0],l[1]);return null===o?null:O.convertObjectToArcadeDictionary({coordinate:o.coordinate,distance:o.distance},z(t),!1,!0)}))}}export{jn as registerFunctions};
//# sourceMappingURL=p-60847726.js.map