import{P as t,a5 as e,a3 as n,iP as i,l as s,y as l,a6 as r,f1 as u,n as a,hC as o,V as h,c7 as d,ad as c,av as p,T as f,aB as y,iQ as g,hw as b,iR as v,iS as j,d3 as w,d5 as m,bS as O}from"./p-b54724b6.js";import{c as x}from"./p-367ab906.js";import{g as I}from"./p-3a359945.js";import"./p-bf0e41eb.js";import"./p-8043ab9b.js";import"./p-0db5f47d.js";function L(t,e){return S(t)===S(e)}function S(t){if(null==t)return null;const e=null!=t.layer?t.layer.id:"";let n=null;return n=null!=t.objectId?t.objectId:null!=t.layer&&"objectIdField"in t.layer&&null!=t.layer.objectIdField&&null!=t.attributes?t.attributes[t.layer.objectIdField]:t.uid,null==n?null:`o-${e}-${n}`}const R={json:{write:{writer:q,target:{"feature.layerId":{type:[Number,String]},"feature.objectId":{type:[Number,String]}}},origins:{"web-scene":{read:E}}}};function q(t,e){null!=t&&null!=t.layer?.objectIdField&&null!=t.attributes&&(e.feature={layerId:t.layer.id,objectId:t.attributes[t.layer.objectIdField]})}function E(t){if(null!=t.layerId&&null!=t.objectId)return{uid:null,layer:{id:t.layerId,objectIdField:"ObjectId"},attributes:{ObjectId:t.objectId}}}let P=class extends(t(e(n))){constructor(t){super(t),this.position=null,this.elevationInfo=null,this.feature=null}equals(t){return i(this.position,t.position)&&i(this.elevationInfo,t.elevationInfo)&&L(this.feature,t.feature)}};s([l({type:r,json:{write:{isRequired:!0}}})],P.prototype,"position",void 0),s([l({type:u}),I()],P.prototype,"elevationInfo",void 0),s([l(R)],P.prototype,"feature",void 0),P=s([a("esri.analysis.LineOfSightAnalysisObserver")],P);const A=P;let F=class extends(t(o)){constructor(t){super(t),this.position=null,this.elevationInfo=null,this.feature=null}equals(t){return i(this.position,t.position)&&i(this.elevationInfo,t.elevationInfo)&&L(this.feature,t.feature)}};s([l({type:r}),I()],F.prototype,"position",void 0),s([l({type:u}),I()],F.prototype,"elevationInfo",void 0),s([l(R)],F.prototype,"feature",void 0),F=s([a("esri.analysis.LineOfSightAnalysisTarget")],F);const N=F;function z(t){return t?$:B}function T(t,e){return null!=e&&e.mode?e.mode:z(t).mode}function C(t,e){return T(null!=t&&t.hasZ,e)}const $={mode:"absolute-height",offset:0},B={mode:"on-the-ground",offset:null};const M=h.ofType(N);let Q=class extends x{constructor(t){super(t),this.type="line-of-sight",this.observer=null,this.extent=null}initialize(){this.addHandles(c((()=>this._computeExtent()),(t=>{null!=t&&null!=t.pending||this._set("extent",null!=t?t.extent:null)}),p))}get targets(){return this._get("targets")||new M}set targets(t){this._set("targets",f(t,this.targets,M))}get spatialReference(){return null!=this.observer&&null!=this.observer.position?this.observer.position.spatialReference:null}get requiredPropertiesForEditing(){return[y(this.observer,(t=>t.position))]}async waitComputeExtent(){const t=this._computeExtent();return null!=t?t.pending:Promise.resolve()}_computeExtent(){const t=this.spatialReference;if(null==this.observer||null==this.observer.position||null==t)return null;const e=t=>"absolute-height"===C(t.position,t.elevationInfo),n=this.observer.position,i=g(n.x,n.y,n.z,n.x,n.y,n.z);for(const e of this.targets)if(null!=e.position){const n=b(e.position,t);if(null!=n.pending)return{pending:n.pending,extent:null};if(null!=n.geometry){const{x:t,y:e,z:s}=n.geometry;v(i,[t,e,s])}}const s=j(i,t);return e(this.observer)&&this.targets.every(e)||(s.zmin=void 0,s.zmax=void 0),{pending:null,extent:s}}clear(){this.observer=null,this.targets.removeAll()}};s([l({type:["line-of-sight"]})],Q.prototype,"type",void 0),s([l({type:A,json:{read:!0,write:!0}})],Q.prototype,"observer",void 0),s([l({cast:d,type:M,nonNullable:!0,json:{read:!0,write:!0}})],Q.prototype,"targets",null),s([l({value:null,readOnly:!0})],Q.prototype,"extent",void 0),s([l({readOnly:!0})],Q.prototype,"spatialReference",null),s([l({readOnly:!0})],Q.prototype,"requiredPropertiesForEditing",null),Q=s([a("esri.analysis.LineOfSightAnalysis")],Q);const _=Q;const k=h.ofType(N);let D=class extends(w(m(O))){constructor(t){super(t),this.type="line-of-sight",this.operationalLayerType="LineOfSightLayer",this.analysis=new _,this.opacity=1}initialize(){this.addHandles(c((()=>this.analysis),((t,e)=>{null!=e&&e.parent===this&&(e.parent=null),null!=t&&(t.parent=this)}),p))}async load(){return null!=this.analysis&&this.addResolvingPromise(this.analysis.waitComputeExtent()),this}get observer(){return y(this.analysis,(t=>t.observer))}set observer(t){y(this.analysis,(e=>e.observer=t))}get targets(){return null!=this.analysis?this.analysis.targets:new h}set targets(t){f(t,this.analysis?.targets)}get fullExtent(){return null!=this.analysis?this.analysis.extent:null}get spatialReference(){return null!=this.analysis?this.analysis.spatialReference:null}releaseAnalysis(t){this.analysis===t&&(this.analysis=new _)}};s([l({json:{read:!1},readOnly:!0})],D.prototype,"type",void 0),s([l({type:["LineOfSightLayer"]})],D.prototype,"operationalLayerType",void 0),s([l({type:A,json:{read:!0,write:{isRequired:!0,ignoreOrigin:!0}}})],D.prototype,"observer",null),s([l({type:k,json:{read:!0,write:{ignoreOrigin:!0}}})],D.prototype,"targets",null),s([l({nonNullable:!0,json:{read:!1,write:!1}})],D.prototype,"analysis",void 0),s([l({readOnly:!0})],D.prototype,"fullExtent",null),s([l({readOnly:!0})],D.prototype,"spatialReference",null),s([l({readOnly:!0,json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}}})],D.prototype,"opacity",void 0),s([l({type:["show","hide"]})],D.prototype,"listMode",void 0),D=s([a("esri.layers.LineOfSightLayer")],D);const G=D;export default G;
//# sourceMappingURL=p-80e1d7a9.js.map