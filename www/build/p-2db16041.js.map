{"version":3,"names":["t","e","xoffset","Math","max","abs","yoffset","n","r","length","s","size","stops","filter","type","map","maxSize","minSize","o","f","floor","renderer","event","pointerType","visualVariables","symbol","uniqueValueInfos","forEach","classBreakInfos","spatialReference","wkid","JSON","stringify","l","dpi","i","gdbVersion","geometry","geometryPrecision","a","height","layerOption","p","mapExtent","m","maxAllowableOffset","y","returnFieldName","u","returnGeometry","c","returnUnformattedValues","d","returnZ","g","x","timeExtent","b","tolerance","h","width","E","toJSON","dynamicLayers","O","layerDefs","S","layerIds","N","j","J","R","imageDisplay","geometryType","sr","time","start","end","join","xmin","ymin","xmax","ymax","layers","floors","sublayers","find","layer","serviceSublayers","extent","minScale","maxScale","visible","includes","id","popupTemplate","popupEnabled","unshift","toExportImageJSON","definitionExpression","Object","keys","floorInfo","static","constructor","super","this","returnM","Number","json","write","prototype","String","types","read","Boolean","displayFieldName","feature","layerId","layerName","readFeature","fromJSON","attributes","writeFeature","async","path","then","query","data","results","exceededTransferLimit","from","Map","set","sourceLayer","get","P","U","_featuresResolutions","WeakMap","highlightGraphics","highlightGraphicUpdated","updateHighlightedFeatures","destroyed","updatingHandles","addPromise","_updateHighlightedFeaturesGeometries","catch","initialize","_updateHighlightedFeaturesSymbols","_highlightGeometriesResolution","addHandles","added","onListenerAdd","layerView","view","scale","_","A","capabilities","operations","supportsIdentify","version","_fetchPopupFeaturesUsingQueries","_fetchPopupFeaturesUsingIdentify","clearHighlights","removeAll","highlight","remove","isCollection","toArray","Array","isArray","addMany","removeMany","getSymbolAsync","import","kb","getSize","shape","style","supportsQuery","_getTargetResolution","has","getObjectId","createQuery","objectIds","outFields","objectIdField","outSpatialReference","queryFeatures","Promise","all","features","_createIdentifyParameters","parsedUrl","sublayer","load","min","allSublayers","reduce","w","createFetchPopupFeaturesQueryGeometry","round","center","v","Set","F","collectRequiredFields","fieldsIndex","sort","clone","where","arcadeUtils","hasGeometryOperations","V","reverse","value","G","defaultPopupTemplateEnabled","expressionInfos","content","some","resolve","any","defaultSymbol","valueExpression","getSymbol","constructOnly","resolution","overlayPixelSizeInMapUnits","basemapSpatialReference","equals"],"sources":["./node_modules/@arcgis/core/renderers/support/clickToleranceUtils.js","./node_modules/@arcgis/core/rest/operations/identify.js","./node_modules/@arcgis/core/rest/support/IdentifyParameters.js","./node_modules/@arcgis/core/rest/support/IdentifyResult.js","./node_modules/@arcgis/core/rest/identify.js","./node_modules/@arcgis/core/views/layers/support/MapServiceLayerViewHelper.js","./node_modules/@arcgis/core/views/support/drapedUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nfunction t(t,e){return e?\"xoffset\"in e&&e.xoffset?Math.max(t,Math.abs(e.xoffset)):\"yoffset\"in e&&e.yoffset?Math.max(t,Math.abs(e.yoffset||0)):t:t}function e(t){let e=0,n=0;for(let r=0;r<t.length;r++){const s=t[r].size;\"number\"==typeof s&&(e+=s,n++)}return e/n}function n(t,n){return\"number\"==typeof t?t:t&&t.stops&&t.stops.length?e(t.stops):n}function r(t,e){if(!e)return t;const r=e.filter((t=>\"size\"===t.type)).map((e=>{const{maxSize:r,minSize:s}=e;return(n(r,t)+n(s,t))/2}));let s=0;const o=r.length;if(0===o)return t;for(let n=0;n<o;n++)s+=r[n];const f=Math.floor(s/o);return Math.max(f,t)}function s(e){const n=e&&e.renderer,s=\"touch\"===(e&&e.event&&e.event.pointerType)?9:6;if(!n)return s;const o=\"visualVariables\"in n?r(s,n.visualVariables):s;if(\"simple\"===n.type)return t(o,n.symbol);if(\"unique-value\"===n.type){let e=o;return n.uniqueValueInfos?.forEach((n=>{e=t(e,n.symbol)})),e}if(\"class-breaks\"===n.type){let e=o;return n.classBreakInfos.forEach((n=>{e=t(e,n.symbol)})),e}return\"dot-density\"===n.type||n.type,o}export{s as calculateTolerance};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{sqlAnd as e}from\"../../core/sql.js\";import{getJsonType as r}from\"../../geometry/support/jsonUtils.js\";import{getScale as t}from\"../../geometry/support/scaleUtils.js\";import{getLayerFloorFilterClause as i}from\"../../layers/support/floorFilterUtils.js\";import{isExportDynamic as n}from\"../../layers/support/sublayerUtils.js\";const s=e=>e.spatialReference.wkid||JSON.stringify(e.spatialReference);function l(e,t){const{dpi:i,gdbVersion:n,geometry:l,geometryPrecision:a,height:f,layerOption:p,mapExtent:m,maxAllowableOffset:y,returnFieldName:u,returnGeometry:c,returnUnformattedValues:d,returnZ:g,spatialReference:x,timeExtent:b,tolerance:h,width:E}=e.toJSON(),{dynamicLayers:O,layerDefs:S,layerIds:N}=o(e),j=t&&null!=t.geometry?t.geometry:null,J={geometryPrecision:a,maxAllowableOffset:y,returnFieldName:u,returnGeometry:c,returnUnformattedValues:d,returnZ:g,tolerance:h},R=j&&j.toJSON()||l;if(J.imageDisplay=`${E},${f},${i}`,n&&(J.gdbVersion=n),R&&(delete R.spatialReference,J.geometry=JSON.stringify(R),J.geometryType=r(R)),x?J.sr=x.wkid||JSON.stringify(x):R&&R.spatialReference?J.sr=s(R):m&&m.spatialReference&&(J.sr=s(m)),J.time=b?[b.start,b.end].join(\",\"):null,m){const{xmin:e,ymin:r,xmax:t,ymax:i}=m;J.mapExtent=`${e},${r},${t},${i}`}return S&&(J.layerDefs=S),O&&!S&&(J.dynamicLayers=O),J.layers=\"popup\"===p?\"visible\":p,N&&!O&&(J.layers+=`:${N.join(\",\")}`),J}function o(e){const{mapExtent:r,floors:s,width:l,sublayers:o,layerIds:f,layerOption:p,gdbVersion:m}=e,y=o?.find((e=>null!=e.layer))?.layer?.serviceSublayers,u=\"popup\"===p,c={},d=t({extent:r,width:l,spatialReference:r?.spatialReference}),g=[],x=e=>{const r=0===d,t=0===e.minScale||d<=e.minScale,i=0===e.maxScale||d>=e.maxScale;if(e.visible&&(r||t&&i))if(e.sublayers)e.sublayers.forEach(x);else{if(!1===f?.includes(e.id)||u&&(!e.popupTemplate||!e.popupEnabled))return;g.unshift(e)}};if(o?.forEach(x),o&&!g.length)c.layerIds=[];else{const e=n(g,y,m),r=g.map((e=>{const r=i(s,e);return e.toExportImageJSON(r)}));if(e)c.dynamicLayers=JSON.stringify(r);else{if(o){let e=g.map((({id:e})=>e));f&&(e=e.filter((e=>f.includes(e)))),c.layerIds=e}else f?.length&&(c.layerIds=f);const e=a(s,g);if(null!=e&&e.length){const r={};for(const t of e)t.definitionExpression&&(r[t.id]=t.definitionExpression);Object.keys(r).length&&(c.layerDefs=JSON.stringify(r))}}}return c}function a(r,t){const n=!!r?.length,s=t.filter((e=>null!=e.definitionExpression||n&&null!=e.floorInfo));return s.length?s.map((t=>{const n=i(r,t),s=e(n,t.definitionExpression);return{id:t.id,definitionExpression:s??void 0}})):null}export{l as identifyToIdentifyRESTParameters,o as toDynamicLayersJSON};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../chunks/tslib.es6.js\";import{geometryTypes as e}from\"../../geometry.js\";import o from\"../../TimeExtent.js\";import{JSONSupport as r}from\"../../core/JSONSupport.js\";import{property as s}from\"../../core/accessorSupport/decorators/property.js\";import{ensureClass as i}from\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import{subclass as p}from\"../../core/accessorSupport/decorators/subclass.js\";import{fromJSON as n}from\"../../geometry/support/jsonUtils.js\";import l from\"../../geometry/Extent.js\";import y from\"../../geometry/SpatialReference.js\";var m;let a=m=class extends r{static from(t){return i(m,t)}constructor(t){super(t),this.dpi=96,this.floors=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=null,this.height=400,this.layerIds=null,this.layerOption=\"top\",this.mapExtent=null,this.maxAllowableOffset=null,this.returnFieldName=!0,this.returnGeometry=!1,this.returnM=!1,this.returnUnformattedValues=!0,this.returnZ=!1,this.spatialReference=null,this.sublayers=null,this.timeExtent=null,this.tolerance=null,this.width=400}};t([s({type:Number,json:{write:!0}})],a.prototype,\"dpi\",void 0),t([s()],a.prototype,\"floors\",void 0),t([s({type:String,json:{write:!0}})],a.prototype,\"gdbVersion\",void 0),t([s({types:e,json:{read:n,write:!0}})],a.prototype,\"geometry\",void 0),t([s({type:Number,json:{write:!0}})],a.prototype,\"geometryPrecision\",void 0),t([s({type:Number,json:{write:!0}})],a.prototype,\"height\",void 0),t([s({type:[Number],json:{write:!0}})],a.prototype,\"layerIds\",void 0),t([s({type:[\"top\",\"visible\",\"all\",\"popup\"],json:{write:!0}})],a.prototype,\"layerOption\",void 0),t([s({type:l,json:{write:!0}})],a.prototype,\"mapExtent\",void 0),t([s({type:Number,json:{write:!0}})],a.prototype,\"maxAllowableOffset\",void 0),t([s({type:Boolean,json:{write:!0}})],a.prototype,\"returnFieldName\",void 0),t([s({type:Boolean,json:{write:!0}})],a.prototype,\"returnGeometry\",void 0),t([s({type:Boolean,json:{write:!0}})],a.prototype,\"returnM\",void 0),t([s({type:Boolean,json:{write:!0}})],a.prototype,\"returnUnformattedValues\",void 0),t([s({type:Boolean,json:{write:!0}})],a.prototype,\"returnZ\",void 0),t([s({type:y,json:{write:!0}})],a.prototype,\"spatialReference\",void 0),t([s()],a.prototype,\"sublayers\",void 0),t([s({type:o,json:{write:!0}})],a.prototype,\"timeExtent\",void 0),t([s({type:Number,json:{write:!0}})],a.prototype,\"tolerance\",void 0),t([s({type:Number,json:{write:!0}})],a.prototype,\"width\",void 0),a=m=t([p(\"esri.rest.support.IdentifyParameters\")],a);const u=a;export{u as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import\"../../geometry.js\";import e from\"../../Graphic.js\";import{JSONSupport as t}from\"../../core/JSONSupport.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import{reader as s}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as p}from\"../../core/accessorSupport/decorators/subclass.js\";import{writer as a}from\"../../core/accessorSupport/decorators/writer.js\";import{typeKebabDictionary as i}from\"../../geometry/support/typeUtils.js\";let u=class extends t{constructor(r){super(r),this.displayFieldName=null,this.feature=null,this.layerId=null,this.layerName=null}readFeature(r,t){return e.fromJSON({attributes:{...t.attributes},geometry:{...t.geometry}})}writeFeature(r,e){if(!r)return;const{attributes:t,geometry:o}=r;t&&(e.attributes={...t}),null!=o&&(e.geometry=o.toJSON(),e.geometryType=i.toJSON(o.type))}};r([o({type:String,json:{write:!0}})],u.prototype,\"displayFieldName\",void 0),r([o({type:e})],u.prototype,\"feature\",void 0),r([s(\"feature\",[\"attributes\",\"geometry\"])],u.prototype,\"readFeature\",null),r([a(\"feature\")],u.prototype,\"writeFeature\",null),r([o({type:Number,json:{write:!0}})],u.prototype,\"layerId\",void 0),r([o({type:String,json:{write:!0}})],u.prototype,\"layerName\",void 0),u=r([p(\"esri.rest.support.IdentifyResult\")],u);const m=u;export{m as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport r from\"../request.js\";import{normalizeCentralMeridian as e}from\"../geometry/support/normalizeUtils.js\";import{parseUrl as t,encode as o,asValidOptions as s}from\"./utils.js\";import{identifyToIdentifyRESTParameters as n}from\"./operations/identify.js\";import u from\"./support/IdentifyParameters.js\";import i from\"./support/IdentifyResult.js\";async function f(u,i,f){const c=(i=a(i)).geometry?[i.geometry]:[],l=t(u);return l.path+=\"/identify\",e(c).then((e=>{const t=n(i,{geometry:e&&e[0]}),u=o({...l.query,f:\"json\",...t}),a=s(u,f);return r(l.path,a).then(m).then((r=>p(r,i.sublayers)))}))}function m(r){const e=r.data;return e.results=e.results||[],e.exceededTransferLimit=Boolean(e.exceededTransferLimit),e.results=e.results.map((r=>i.fromJSON(r))),e}function a(r){return r=u.from(r)}function p(r,e){if(!e?.length)return r;const t=new Map;function o(r){t.set(r.id,r),r.sublayers&&r.sublayers.forEach(o)}e.forEach(o);for(const s of r.results)s.feature.sourceLayer=t.get(s.layerId);return r}export{f as identify};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../Graphic.js\";import r from\"../../../core/Accessor.js\";import{isSome as s}from\"../../../core/arrayUtils.js\";import i from\"../../../core/Collection.js\";import o from\"../../../core/Error.js\";import{makeHandle as a}from\"../../../core/handleUtils.js\";import has from\"../../../core/has.js\";import{getOrCreateMapValue as n}from\"../../../core/MapUtils.js\";import{debounce as l,eachAlways as p}from\"../../../core/promiseUtils.js\";import{on as c}from\"../../../core/reactiveUtils.js\";import{getMetersPerUnitForSR as u}from\"../../../core/unitUtils.js\";import{property as h}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as y}from\"../../../core/accessorSupport/decorators/subclass.js\";import m from\"../../../geometry/Extent.js\";import{getResolutionForScale as f}from\"../../../geometry/support/scaleUtils.js\";import{collectFields as d}from\"../../../layers/support/fieldUtils.js\";import{getLayerFloorFilterClause as g}from\"../../../layers/support/floorFilterUtils.js\";import{calculateTolerance as w}from\"../../../renderers/support/clickToleranceUtils.js\";import{identify as b}from\"../../../rest/identify.js\";import v from\"../../../rest/support/IdentifyParameters.js\";import{loadArcade as j}from\"../../../support/arcadeOnDemand.js\";import x from\"../../../symbols/SimpleMarkerSymbol.js\";import{getRequiredFields as F,getFetchPopupTemplate as G}from\"./popupUtils.js\";let P=null;function S(e,t){return\"tile\"===t.type||\"map-image\"===t.type}let U=class extends r{constructor(e){super(e),this._featuresResolutions=new WeakMap,this.highlightGraphics=null,this.highlightGraphicUpdated=null,this.updateHighlightedFeatures=l((async e=>{this.destroyed||this.updatingHandles.addPromise(this._updateHighlightedFeaturesGeometries(e).catch((()=>{})))}))}initialize(){const e=e=>{this.updatingHandles.addPromise(this._updateHighlightedFeaturesSymbols(e).catch((()=>{}))),this.updateHighlightedFeatures(this._highlightGeometriesResolution)};this.addHandles([c((()=>this.highlightGraphics),\"change\",(t=>e(t.added)),{onListenerAdd:t=>e(t)})])}async fetchPopupFeatures(e,t){const{layerView:{layer:r,view:{scale:s}}}=this;if(!e)throw new o(\"fetchPopupFeatures:invalid-area\",\"Nothing to fetch without area\",{layer:r});const i=_(r.sublayers,s,t);if(!i.length)return[];const a=await A(r,i);if(!((r.capabilities?.operations?.supportsIdentify??!0)&&r.version>=10.5)&&!a)throw new o(\"fetchPopupFeatures:not-supported\",\"query operation is disabled for this service\",{layer:r});return a?this._fetchPopupFeaturesUsingQueries(e,i,t):this._fetchPopupFeaturesUsingIdentify(e,i,t)}clearHighlights(){this.highlightGraphics?.removeAll()}highlight(e){const r=this.highlightGraphics;if(!r)return{remove(){}};let o=null;if(e instanceof t?o=[e]:i.isCollection(e)&&e.length>0?o=e.toArray():Array.isArray(e)&&e.length>0&&(o=e),o=o?.filter(s),!o||!o.length)return a();for(const t of o){const e=t.sourceLayer;null!=e&&\"geometryType\"in e&&\"point\"===e.geometryType&&(t.visible=!1)}return r.addMany(o),{remove:()=>{r.removeMany(o??[])}}}async _updateHighlightedFeaturesSymbols(e){const{layerView:{view:t},highlightGraphics:r,highlightGraphicUpdated:s}=this;if(r&&s)for(const i of e){const e=i.sourceLayer&&\"renderer\"in i.sourceLayer&&i.sourceLayer.renderer;i.sourceLayer&&\"geometryType\"in i.sourceLayer&&\"point\"===i.sourceLayer.geometryType&&e&&\"getSymbolAsync\"in e&&e.getSymbolAsync(i).then((async o=>{o||=new x;let a=null;const n=\"visualVariables\"in e?e.visualVariables?.find((e=>\"size\"===e.type)):void 0;n&&(P||(P=(await import(\"../../../renderers/visualVariables/support/visualVariableUtils.js\")).getSize),a=P(n,i,{view:t.type,scale:t.scale,shape:\"simple-marker\"===o.type?o.style:null})),a||=\"width\"in o&&\"height\"in o&&null!=o.width&&null!=o.height?Math.max(o.width,o.height):\"size\"in o?o.size:16,r.includes(i)&&(i.symbol=new x({style:\"square\",size:a,xoffset:\"xoffset\"in o?o.xoffset:0,yoffset:\"yoffset\"in o?o.yoffset:0}),s(i,\"symbol\"),i.visible=!0)}))}}async _updateHighlightedFeaturesGeometries(e){const{layerView:{layer:t,view:r},highlightGraphics:s,highlightGraphicUpdated:i}=this;if(this._highlightGeometriesResolution=e,!i||!s?.length||!t.capabilities.operations.supportsQuery)return;const o=this._getTargetResolution(e),a=new Map;for(const c of s)if(!this._featuresResolutions.has(c)||this._featuresResolutions.get(c)>o){const e=c.sourceLayer;n(a,e,(()=>new Map)).set(c.getObjectId(),c)}const l=Array.from(a,(([e,t])=>{const s=e.createQuery();return s.objectIds=[...t.keys()],s.outFields=[e.objectIdField],s.returnGeometry=!0,s.maxAllowableOffset=o,s.outSpatialReference=r.spatialReference,e.queryFeatures(s)})),p=await Promise.all(l);if(!this.destroyed)for(const{features:n}of p)for(const e of n){const t=e.sourceLayer,r=a.get(t).get(e.getObjectId());r&&s.includes(r)&&(r.geometry=e.geometry,i(r,\"geometry\"),this._featuresResolutions.set(r,o))}}_getTargetResolution(e){const t=e*u(this.layerView.view.spatialReference),r=t/16;return r<=10?0:e/t*r}async _fetchPopupFeaturesUsingIdentify(e,t,r){const s=await this._createIdentifyParameters(e,t,r);if(null==s)return[];const{results:i}=await b(this.layerView.layer.parsedUrl,s);return i.map((e=>e.feature))}async _createIdentifyParameters(e,t,r){const{floors:s,layer:i,timeExtent:o,view:{spatialReference:a,scale:n}}=this.layerView,l=null!=r?r.event:null;if(!t.length)return null;await Promise.all(t.map((({sublayer:e})=>e.load().catch((()=>{})))));const p=Math.min(has(\"mapservice-popup-identify-max-tolerance\"),i.allSublayers.reduce(((e,t)=>t.renderer?w({renderer:t.renderer,event:l}):e),2)),c=this.createFetchPopupFeaturesQueryGeometry(e,p),u=f(n,a),h=Math.round(c.width/u),y=new m({xmin:c.center.x-u*h,ymin:c.center.y-u*h,xmax:c.center.x+u*h,ymax:c.center.y+u*h,spatialReference:c.spatialReference});return new v({floors:s,gdbVersion:\"gdbVersion\"in i?i.gdbVersion:void 0,geometry:e,height:h,layerOption:\"popup\",mapExtent:y,returnGeometry:!0,spatialReference:a,sublayers:i.sublayers,timeExtent:o,tolerance:p,width:h})}async _fetchPopupFeaturesUsingQueries(e,t,r){const{layerView:{floors:i,timeExtent:o}}=this,a=null!=r?r.event:null,n=t.map((async({sublayer:t,popupTemplate:r})=>{if(await t.load().catch((()=>{})),t.capabilities&&!t.capabilities.operations.supportsQuery)return[];const s=t.createQuery(),n=w({renderer:t.renderer,event:a}),l=this.createFetchPopupFeaturesQueryGeometry(e,n),p=new Set,[c]=await Promise.all([F(t,r),t.renderer?.collectRequiredFields(p,t.fieldsIndex)]);d(p,t.fieldsIndex,c);const u=Array.from(p).sort();if(s.geometry=l,s.outFields=u,s.timeExtent=o,i){const e=i.clone(),r=g(e,t);null!=r&&(s.where=s.where?`(${s.where}) AND (${r})`:r)}const h=this._getTargetResolution(l.width/n),y=await R(r),m=\"point\"===t.geometryType||y&&y.arcadeUtils.hasGeometryOperations(r);m||(s.maxAllowableOffset=h);let{features:f}=await t.queryFeatures(s);const b=m?0:h;f=await V(t,f);for(const e of f)this._featuresResolutions.set(e,b);return f}));return(await p(n)).reverse().reduce(((e,t)=>t.value?[...e,...t.value]:e),[]).filter(s)}};function _(e,t,r){const s=[],i=e=>{const o=0===e.minScale||t<=e.minScale,a=0===e.maxScale||t>=e.maxScale;if(e.visible&&o&&a)if(e.sublayers)e.sublayers.forEach(i);else if(e.popupEnabled){const t=G(e,{...r,defaultPopupTemplateEnabled:!1});null!=t&&s.unshift({sublayer:e,popupTemplate:t})}};return(e?.toArray()??[]).reverse().map(i),s}function R(e){return e.expressionInfos?.length||Array.isArray(e.content)&&e.content.some((e=>\"expression\"===e.type))?j():Promise.resolve()}async function A(e,t){if(e.capabilities?.operations?.supportsQuery)return!0;try{return await Promise.any(t.map((({sublayer:e})=>e.load().then((()=>e.capabilities.operations.supportsQuery)))))}catch{return!1}}async function V(e,t){const r=e.renderer;return r&&\"defaultSymbol\"in r&&!r.defaultSymbol&&(t=r.valueExpression?await Promise.all(t.map((e=>r.getSymbolAsync(e).then((t=>t?e:null))))).then((e=>e.filter((e=>null!=e)))):t.filter((e=>null!=r.getSymbol(e)))),t}e([h({constructOnly:!0})],U.prototype,\"createFetchPopupFeaturesQueryGeometry\",void 0),e([h({constructOnly:!0})],U.prototype,\"layerView\",void 0),e([h({constructOnly:!0})],U.prototype,\"highlightGraphics\",void 0),e([h({constructOnly:!0})],U.prototype,\"highlightGraphicUpdated\",void 0),e([h({constructOnly:!0})],U.prototype,\"updatingHandles\",void 0),U=e([y(\"esri.views.layers.support.MapService\")],U);export{U as MapServiceLayerViewHelper,_ as collectPopupProviders,S as isMapServiceLayerView};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport\"../../geometry.js\";import{getMetersPerUnitForSR as e}from\"../../core/unitUtils.js\";import{calculateTolerance as t}from\"../../renderers/support/clickToleranceUtils.js\";import n from\"../../geometry/Extent.js\";function r(t,r,i,a=new n){let o=0;if(\"2d\"===i.type)o=r*(i.resolution??0);else if(\"3d\"===i.type){const n=i.overlayPixelSizeInMapUnits(t),a=i.basemapSpatialReference;o=null==a||a.equals(i.spatialReference)?r*n:e(a)/e(i.spatialReference)}const s=t.x-o,l=t.y-o,m=t.x+o,p=t.y+o,{spatialReference:c}=i;return a.xmin=Math.min(s,m),a.ymin=Math.min(l,p),a.xmax=Math.max(s,m),a.ymax=Math.max(l,p),a.spatialReference=c,a}function i(e,n,i){const o=i.toMap(e);if(null==o)return!1;return r(o,t(),i,a).intersects(n)}const a=new n;export{r as createQueryGeometry,i as intersectsDrapedGeometry};\n"],"mappings":"+dAIA,SAASA,EAAEA,EAAEC,GAAG,OAAOA,EAAE,YAAYA,GAAGA,EAAEC,QAAQC,KAAKC,IAAIJ,EAAEG,KAAKE,IAAIJ,EAAEC,UAAU,YAAYD,GAAGA,EAAEK,QAAQH,KAAKC,IAAIJ,EAAEG,KAAKE,IAAIJ,EAAEK,SAAS,IAAIN,EAAEA,CAAC,CAAC,SAASC,EAAED,GAAG,IAAIC,EAAE,EAAEM,EAAE,EAAE,IAAI,IAAIC,EAAE,EAAEA,EAAER,EAAES,OAAOD,IAAI,CAAC,MAAME,EAAEV,EAAEQ,GAAGG,KAAK,iBAAiBD,IAAIT,GAAGS,EAAEH,IAAI,CAAC,OAAON,EAAEM,CAAC,CAAC,SAASA,EAAEP,EAAEO,GAAG,MAAM,iBAAiBP,EAAEA,EAAEA,GAAGA,EAAEY,OAAOZ,EAAEY,MAAMH,OAAOR,EAAED,EAAEY,OAAOL,CAAC,CAAC,SAASC,EAAER,EAAEC,GAAG,IAAIA,EAAE,OAAOD,EAAE,MAAMQ,EAAEP,EAAEY,QAAQb,GAAG,SAASA,EAAEc,OAAOC,KAAKd,IAAI,MAAMe,QAAQR,EAAES,QAAQP,GAAGT,EAAE,OAAOM,EAAEC,EAAER,GAAGO,EAAEG,EAAEV,IAAI,CAAE,IAAG,IAAIU,EAAE,EAAE,MAAMQ,EAAEV,EAAEC,OAAO,GAAG,IAAIS,EAAE,OAAOlB,EAAE,IAAI,IAAIO,EAAE,EAAEA,EAAEW,EAAEX,IAAIG,GAAGF,EAAED,GAAG,MAAMY,EAAEhB,KAAKiB,MAAMV,EAAEQ,GAAG,OAAOf,KAAKC,IAAIe,EAAEnB,EAAE,CAAC,SAASU,EAAET,GAAG,MAAMM,EAAEN,GAAGA,EAAEoB,SAASX,EAAE,WAAWT,GAAGA,EAAEqB,OAAOrB,EAAEqB,MAAMC,aAAa,EAAE,EAAE,IAAIhB,EAAE,OAAOG,EAAE,MAAMQ,EAAE,oBAAoBX,EAAEC,EAAEE,EAAEH,EAAEiB,iBAAiBd,EAAE,GAAG,WAAWH,EAAEO,KAAK,OAAOd,EAAEkB,EAAEX,EAAEkB,QAAQ,GAAG,iBAAiBlB,EAAEO,KAAK,CAAC,IAAIb,EAAEiB,EAAE,OAAOX,EAAEmB,kBAAkBC,SAASpB,IAAIN,EAAED,EAAEC,EAAEM,EAAEkB,OAAQ,IAAGxB,CAAC,CAAC,GAAG,iBAAiBM,EAAEO,KAAK,CAAC,IAAIb,EAAEiB,EAAE,OAAOX,EAAEqB,gBAAgBD,SAASpB,IAAIN,EAAED,EAAEC,EAAEM,EAAEkB,OAAQ,IAAGxB,CAAC,CAAC,OAAqCiB,CAAC,CCAprB,MAAMR,EAAET,GAAGA,EAAE4B,iBAAiBC,MAAMC,KAAKC,UAAU/B,EAAE4B,kBAAkB,SAASI,EAAEhC,EAAED,GAAG,MAAMkC,IAAIC,EAAEC,WAAW7B,EAAE8B,SAASJ,EAAEK,kBAAkBC,EAAEC,OAAOrB,EAAEsB,YAAYC,EAAEC,UAAUC,EAAEC,mBAAmBC,EAAEC,gBAAgBC,EAAEC,eAAeC,EAAEC,wBAAwBC,EAAEC,QAAQC,EAAEzB,iBAAiB0B,EAAEC,WAAWC,EAAEC,UAAUC,EAAEC,MAAMC,GAAG5D,EAAE6D,UAAUC,cAAcC,EAAEC,UAAUC,EAAEC,SAASC,GAAGlD,EAAEjB,GAAGoE,EAAErE,GAAG,MAAMA,EAAEqC,SAASrC,EAAEqC,SAAS,KAAKiC,EAAE,CAAChC,kBAAkBC,EAAEM,mBAAmBC,EAAEC,gBAAgBC,EAAEC,eAAeC,EAAEC,wBAAwBC,EAAEC,QAAQC,EAAEI,UAAUC,GAAGY,EAAEF,GAAGA,EAAEP,UAAU7B,EAAE,GAAGqC,EAAEE,aAAa,GAAGX,KAAK1C,KAAKgB,IAAI5B,IAAI+D,EAAElC,WAAW7B,GAAGgE,WAAWA,EAAE1C,iBAAiByC,EAAEjC,SAASN,KAAKC,UAAUuC,GAAGD,EAAEG,aAAajE,EAAE+D,IAAIhB,EAAEe,EAAEI,GAAGnB,EAAEzB,MAAMC,KAAKC,UAAUuB,GAAGgB,GAAGA,EAAE1C,iBAAiByC,EAAEI,GAAGhE,EAAE6D,GAAG3B,GAAGA,EAAEf,mBAAmByC,EAAEI,GAAGhE,EAAEkC,IAAI0B,EAAEK,KAAKlB,EAAE,CAACA,EAAEmB,MAAMnB,EAAEoB,KAAKC,KAAK,KAAK,KAAKlC,EAAE,CAAC,MAAMmC,KAAK9E,EAAE+E,KAAKxE,EAAEyE,KAAKjF,EAAEkF,KAAK/C,GAAGS,EAAE0B,EAAE3B,UAAU,GAAG1C,KAAKO,KAAKR,KAAKmC,GAAG,CAAC,OAAO+B,IAAII,EAAEL,UAAUC,GAAGF,IAAIE,IAAII,EAAEP,cAAcC,GAAGM,EAAEa,OAAO,UAAUzC,EAAE,UAAUA,EAAE0B,IAAIJ,IAAIM,EAAEa,QAAQ,IAAIf,EAAEU,KAAK,QAAQR,CAAC,CAAC,SAASpD,EAAEjB,GAAG,MAAM0C,UAAUnC,EAAE4E,OAAO1E,EAAEkD,MAAM3B,EAAEoD,UAAUnE,EAAEiD,SAAShD,EAAEsB,YAAYC,EAAEN,WAAWQ,GAAG3C,EAAE6C,EAAE5B,GAAGoE,MAAMrF,GAAG,MAAMA,EAAEsF,SAASA,OAAOC,iBAAiBxC,EAAE,UAAUN,EAAEQ,EAAE,GAAGE,EAAEpD,EAAE,CAACyF,OAAOjF,EAAEoD,MAAM3B,EAAEJ,iBAAiBrB,GAAGqB,mBAAmByB,EAAE,GAAGC,EAAEtD,IAAI,MAAMO,EAAE,IAAI4C,EAAEpD,EAAE,IAAIC,EAAEyF,UAAUtC,GAAGnD,EAAEyF,SAASvD,EAAE,IAAIlC,EAAE0F,UAAUvC,GAAGnD,EAAE0F,SAAS,GAAG1F,EAAE2F,UAAUpF,GAAGR,GAAGmC,GAAG,GAAGlC,EAAEoF,UAAUpF,EAAEoF,UAAU1D,QAAQ4B,OAAO,CAAC,IAAI,IAAIpC,GAAG0E,SAAS5F,EAAE6F,KAAK9C,KAAK/C,EAAE8F,gBAAgB9F,EAAE+F,cAAc,OAAO1C,EAAE2C,QAAQhG,EAAE,GAAG,GAAGiB,GAAGS,QAAQ4B,GAAGrC,IAAIoC,EAAE7C,OAAOyC,EAAEiB,SAAS,OAAO,CAAC,MAAMlE,EAAEM,EAAE+C,EAAER,EAAEF,GAAGpC,EAAE8C,EAAEvC,KAAKd,IAAI,MAAMO,EAAE2B,EAAEzB,EAAET,GAAG,OAAOA,EAAEiG,kBAAkB1F,EAAG,IAAG,GAAGP,EAAEiD,EAAEa,cAAchC,KAAKC,UAAUxB,OAAO,CAAC,GAAGU,EAAE,CAAC,IAAIjB,EAAEqD,EAAEvC,KAAG,EAAI+E,GAAG7F,KAAKA,IAAIkB,IAAIlB,EAAEA,EAAEY,QAAQZ,GAAGkB,EAAE0E,SAAS5F,MAAMiD,EAAEiB,SAASlE,CAAC,MAAMkB,GAAGV,SAASyC,EAAEiB,SAAShD,GAAG,MAAMlB,EAAEsC,EAAE7B,EAAE4C,GAAG,GAAG,MAAMrD,GAAGA,EAAEQ,OAAO,CAAC,MAAMD,EAAE,GAAG,IAAI,MAAMR,KAAKC,EAAED,EAAEmG,uBAAuB3F,EAAER,EAAE8F,IAAI9F,EAAEmG,sBAAsBC,OAAOC,KAAK7F,GAAGC,SAASyC,EAAEe,UAAUlC,KAAKC,UAAUxB,GAAG,CAAC,CAAC,CAAC,OAAO0C,CAAC,CAAC,SAASX,EAAE/B,EAAER,GAAG,MAAMO,IAAIC,GAAGC,OAAOC,EAAEV,EAAEa,QAAQZ,GAAG,MAAMA,EAAEkG,sBAAsB5F,GAAG,MAAMN,EAAEqG,YAAY,OAAO5F,EAAED,OAAOC,EAAEK,KAAKf,IAAI,MAAMO,EAAE4B,EAAE3B,EAAER,GAAGU,EAAET,EAAEM,EAAEP,EAAEmG,sBAAsB,MAAM,CAACL,GAAG9F,EAAE8F,GAAGK,qBAAqBzF,QAAQ,EAAG,IAAG,IAAI,CCAx4D,IAAIkC,EAAE,IAAIL,EAAEK,EAAE,cAAcpC,EAAE+F,YAAYvG,GAAG,OAAOmC,EAAES,EAAE5C,EAAE,CAACwG,YAAYxG,GAAGyG,MAAMzG,GAAG0G,KAAKxE,IAAI,GAAGwE,KAAKtB,OAAO,KAAKsB,KAAKtE,WAAW,KAAKsE,KAAKrE,SAAS,KAAKqE,KAAKpE,kBAAkB,KAAKoE,KAAKlE,OAAO,IAAIkE,KAAKvC,SAAS,KAAKuC,KAAKjE,YAAY,MAAMiE,KAAK/D,UAAU,KAAK+D,KAAK7D,mBAAmB,KAAK6D,KAAK3D,iBAAiB,EAAE2D,KAAKzD,gBAAgB,EAAEyD,KAAKC,SAAS,EAAED,KAAKvD,yBAAyB,EAAEuD,KAAKrD,SAAS,EAAEqD,KAAK7E,iBAAiB,KAAK6E,KAAKrB,UAAU,KAAKqB,KAAKlD,WAAW,KAAKkD,KAAKhD,UAAU,KAAKgD,KAAK9C,MAAM,GAAG,GAAG5D,EAAE,CAACU,EAAE,CAACI,KAAK8F,OAAOC,KAAK,CAACC,OAAO,MAAMvE,EAAEwE,UAAU,WAAW,GAAG/G,EAAE,CAACU,KAAK6B,EAAEwE,UAAU,cAAc,GAAG/G,EAAE,CAACU,EAAE,CAACI,KAAKkG,OAAOH,KAAK,CAACC,OAAO,MAAMvE,EAAEwE,UAAU,kBAAkB,GAAG/G,EAAE,CAACU,EAAE,CAACuG,MAAMhH,EAAE4G,KAAK,CAACK,KAAK3G,EAAEuG,OAAO,MAAMvE,EAAEwE,UAAU,gBAAgB,GAAG/G,EAAE,CAACU,EAAE,CAACI,KAAK8F,OAAOC,KAAK,CAACC,OAAO,MAAMvE,EAAEwE,UAAU,yBAAyB,GAAG/G,EAAE,CAACU,EAAE,CAACI,KAAK8F,OAAOC,KAAK,CAACC,OAAO,MAAMvE,EAAEwE,UAAU,cAAc,GAAG/G,EAAE,CAACU,EAAE,CAACI,KAAK,CAAC8F,QAAQC,KAAK,CAACC,OAAO,MAAMvE,EAAEwE,UAAU,gBAAgB,GAAG/G,EAAE,CAACU,EAAE,CAACI,KAAK,CAAC,MAAM,UAAU,MAAM,SAAS+F,KAAK,CAACC,OAAO,MAAMvE,EAAEwE,UAAU,mBAAmB,GAAG/G,EAAE,CAACU,EAAE,CAACI,KAAKmB,EAAE4E,KAAK,CAACC,OAAO,MAAMvE,EAAEwE,UAAU,iBAAiB,GAAG/G,EAAE,CAACU,EAAE,CAACI,KAAK8F,OAAOC,KAAK,CAACC,OAAO,MAAMvE,EAAEwE,UAAU,0BAA0B,GAAG/G,EAAE,CAACU,EAAE,CAACI,KAAKqG,QAAQN,KAAK,CAACC,OAAO,MAAMvE,EAAEwE,UAAU,uBAAuB,GAAG/G,EAAE,CAACU,EAAE,CAACI,KAAKqG,QAAQN,KAAK,CAACC,OAAO,MAAMvE,EAAEwE,UAAU,sBAAsB,GAAG/G,EAAE,CAACU,EAAE,CAACI,KAAKqG,QAAQN,KAAK,CAACC,OAAO,MAAMvE,EAAEwE,UAAU,eAAe,GAAG/G,EAAE,CAACU,EAAE,CAACI,KAAKqG,QAAQN,KAAK,CAACC,OAAO,MAAMvE,EAAEwE,UAAU,+BAA+B,GAAG/G,EAAE,CAACU,EAAE,CAACI,KAAKqG,QAAQN,KAAK,CAACC,OAAO,MAAMvE,EAAEwE,UAAU,eAAe,GAAG/G,EAAE,CAACU,EAAE,CAACI,KAAKgC,EAAE+D,KAAK,CAACC,OAAO,MAAMvE,EAAEwE,UAAU,wBAAwB,GAAG/G,EAAE,CAACU,KAAK6B,EAAEwE,UAAU,iBAAiB,GAAG/G,EAAE,CAACU,EAAE,CAACI,KAAKI,EAAE2F,KAAK,CAACC,OAAO,MAAMvE,EAAEwE,UAAU,kBAAkB,GAAG/G,EAAE,CAACU,EAAE,CAACI,KAAK8F,OAAOC,KAAK,CAACC,OAAO,MAAMvE,EAAEwE,UAAU,iBAAiB,GAAG/G,EAAE,CAACU,EAAE,CAACI,KAAK8F,OAAOC,KAAK,CAACC,OAAO,MAAMvE,EAAEwE,UAAU,aAAa,GAAGxE,EAAEK,EAAE5C,EAAE,CAAC0C,EAAE,yCAAyCH,GAAG,MAAMS,EAAET,ECA/3D,IAAIS,EAAE,cAAchD,EAAEwG,YAAYhG,GAAGiG,MAAMjG,GAAGkG,KAAKU,iBAAiB,KAAKV,KAAKW,QAAQ,KAAKX,KAAKY,QAAQ,KAAKZ,KAAKa,UAAU,IAAI,CAACC,YAAYhH,EAAER,GAAG,OAAOC,EAAEwH,SAAS,CAACC,WAAW,IAAI1H,EAAE0H,YAAYrF,SAAS,IAAIrC,EAAEqC,WAAW,CAACsF,aAAanH,EAAEP,GAAG,IAAIO,EAAE,OAAO,MAAMkH,WAAW1H,EAAEqC,SAASnB,GAAGV,EAAER,IAAIC,EAAEyH,WAAW,IAAI1H,IAAI,MAAMkB,IAAIjB,EAAEoC,SAASnB,EAAE4C,SAAS7D,EAAEwE,aAAatC,EAAE2B,OAAO5C,EAAEJ,MAAM,GAAGN,EAAE,CAACU,EAAE,CAACJ,KAAKkG,OAAOH,KAAK,CAACC,OAAO,MAAM9D,EAAE+D,UAAU,wBAAwB,GAAGvG,EAAE,CAACU,EAAE,CAACJ,KAAKb,KAAK+C,EAAE+D,UAAU,eAAe,GAAGvG,EAAE,CAACE,EAAE,UAAU,CAAC,aAAa,cAAcsC,EAAE+D,UAAU,cAAc,MAAMvG,EAAE,CAAC+B,EAAE,YAAYS,EAAE+D,UAAU,eAAe,MAAMvG,EAAE,CAACU,EAAE,CAACJ,KAAK8F,OAAOC,KAAK,CAACC,OAAO,MAAM9D,EAAE+D,UAAU,eAAe,GAAGvG,EAAE,CAACU,EAAE,CAACJ,KAAKkG,OAAOH,KAAK,CAACC,OAAO,MAAM9D,EAAE+D,UAAU,iBAAiB,GAAG/D,EAAExC,EAAE,CAACkC,EAAE,qCAAqCM,GAAG,MAAMJ,GAAEI,ECAvlC4E,eAAezG,GAAE6B,EAAEb,EAAEhB,GAAG,MAAM+B,GAAGf,EAAEI,GAAEJ,IAAIE,SAAS,CAACF,EAAEE,UAAU,GAAGJ,EAAEjC,EAAEgD,GAAG,OAAOf,EAAE4F,MAAM,YAAY5H,EAAEiD,GAAG4E,MAAM7H,IAAI,MAAMD,EAAEO,EAAE4B,EAAE,CAACE,SAASpC,GAAGA,EAAE,KAAK+C,EAAE9B,EAAE,IAAIe,EAAE8F,MAAM5G,EAAE,UAAUnB,IAAIuC,EAAE7B,EAAEsC,EAAE7B,GAAG,OAAOX,EAAEyB,EAAE4F,KAAKtF,GAAGuF,KAAKlF,IAAGkF,MAAMtH,GAAGkC,GAAElC,EAAE2B,EAAEkD,YAAa,GAAE,CAAC,SAASzC,GAAEpC,GAAG,MAAMP,EAAEO,EAAEwH,KAAK,OAAO/H,EAAEgI,QAAQhI,EAAEgI,SAAS,GAAGhI,EAAEiI,sBAAsBf,QAAQlH,EAAEiI,uBAAuBjI,EAAEgI,QAAQhI,EAAEgI,QAAQlH,KAAKP,GAAG2B,GAAEsF,SAASjH,KAAKP,CAAC,CAAC,SAASsC,GAAE/B,GAAG,OAAOA,EAAEwC,EAAEmF,KAAK3H,EAAE,CAAC,SAASkC,GAAElC,EAAEP,GAAG,IAAIA,GAAGQ,OAAO,OAAOD,EAAE,MAAMR,EAAE,IAAIoI,IAAI,SAASlH,EAAEV,GAAGR,EAAEqI,IAAI7H,EAAEsF,GAAGtF,GAAGA,EAAE6E,WAAW7E,EAAE6E,UAAU1D,QAAQT,EAAE,CAACjB,EAAE0B,QAAQT,GAAG,IAAI,MAAMR,KAAKF,EAAEyH,QAAQvH,EAAE2G,QAAQiB,YAAYtI,EAAEuI,IAAI7H,EAAE4G,SAAS,OAAO9G,CAAC,CCA4f,IAAIgI,GAAE,KAAK,SAAStE,GAAEjE,EAAED,GAAG,MAAM,SAASA,EAAEc,MAAM,cAAcd,EAAEc,IAAI,CAAI,IAAC2H,GAAE,cAAcjI,EAAEgG,YAAYvG,GAAGwG,MAAMxG,GAAGyG,KAAKgC,qBAAqB,IAAIC,QAAQjC,KAAKkC,kBAAkB,KAAKlC,KAAKmC,wBAAwB,KAAKnC,KAAKoC,0BAA0B7G,GAAC,MAAE2F,IAAUlB,KAAKqC,WAAWrC,KAAKsC,gBAAgBC,WAAWvC,KAAKwC,qCAAqCjJ,GAAGkJ,OAAK,KAAQ,IAAI,GAAE,CAACC,aAAa,MAAMnJ,EAAEA,IAAIyG,KAAKsC,gBAAgBC,WAAWvC,KAAK2C,kCAAkCpJ,GAAGkJ,OAAK,KAAQ,KAAIzC,KAAKoC,0BAA0BpC,KAAK4C,+BAA8B,EAAG5C,KAAK6C,WAAW,CAACrG,GAAC,IAAMwD,KAAKkC,mBAAmB,UAAU5I,GAAGC,EAAED,EAAEwJ,QAAQ,CAACC,cAAczJ,GAAGC,EAAED,MAAM,CAAC4H,yBAAyB3H,EAAED,GAAG,MAAM0J,WAAWnE,MAAM/E,EAAEmJ,MAAMC,MAAMlJ,KAAKgG,KAAK,IAAIzG,EAAE,MAAM,IAAIiB,EAAE,kCAAkC,gCAAgC,CAACqE,MAAM/E,IAAI,MAAM2B,EAAE0H,GAAErJ,EAAE6E,UAAU3E,EAAEV,GAAG,IAAImC,EAAE1B,OAAO,MAAM,GAAG,MAAM8B,QAAQuH,GAAEtJ,EAAE2B,GAAG,MAAM3B,EAAEuJ,cAAcC,YAAYC,mBAAmB,IAAIzJ,EAAE0J,SAAS,QAAQ3H,EAAE,MAAM,IAAIrB,EAAE,mCAAmC,+CAA+C,CAACqE,MAAM/E,IAAI,OAAO+B,EAAEmE,KAAKyD,gCAAgClK,EAAEkC,EAAEnC,GAAG0G,KAAK0D,iCAAiCnK,EAAEkC,EAAEnC,EAAE,CAACqK,kBAAkB3D,KAAKkC,mBAAmB0B,WAAW,CAACC,UAAUtK,GAAG,MAAMO,EAAEkG,KAAKkC,kBAAkB,IAAIpI,EAAE,MAAM,CAACgK,SAAQ,GAAI,IAAItJ,EAAE,KAAK,GAAGjB,aAAaD,EAAEkB,EAAE,CAACjB,GAAGkC,EAAEsI,aAAaxK,IAAIA,EAAEQ,OAAO,EAAES,EAAEjB,EAAEyK,UAAUC,MAAMC,QAAQ3K,IAAIA,EAAEQ,OAAO,IAAIS,EAAEjB,GAAGiB,EAAEA,GAAGL,OAAOH,IAAIQ,IAAIA,EAAET,OAAO,OAAO8B,IAAI,IAAI,MAAMvC,KAAKkB,EAAE,CAAC,MAAMjB,EAAED,EAAEsI,YAAY,MAAMrI,GAAG,iBAAiBA,GAAG,UAAUA,EAAEwE,eAAezE,EAAE4F,SAAS,EAAE,CAAC,OAAOpF,EAAEqK,QAAQ3J,GAAG,CAACsJ,OAAO,KAAKhK,EAAEsK,WAAW5J,GAAG,GAAE,EAAG,CAAC0G,wCAAwC3H,GAAG,MAAMyJ,WAAWC,KAAK3J,GAAG4I,kBAAkBpI,EAAEqI,wBAAwBnI,GAAGgG,KAAK,GAAGlG,GAAGE,EAAE,IAAI,MAAMyB,KAAKlC,EAAE,CAAC,MAAMA,EAAEkC,EAAEmG,aAAa,aAAanG,EAAEmG,aAAanG,EAAEmG,YAAYjH,SAASc,EAAEmG,aAAa,iBAAiBnG,EAAEmG,aAAa,UAAUnG,EAAEmG,YAAY7D,cAAcxE,GAAG,mBAAmBA,GAAGA,EAAE8K,eAAe5I,GAAG2F,MAAI,MAAEF,IAAU1G,IAAI,IAAIqC,EAAE,IAAIhB,EAAE,KAAK,MAAMhC,EAAE,oBAAoBN,EAAEA,EAAEuB,iBAAiB8D,MAAMrF,GAAG,SAASA,EAAEa,YAAY,EAAEP,IAAIiI,KAAIA,UAASwC,OAAO,mBAAmElD,MAAA,SAAAvH,GAAA,OAAAA,EAAA0K,EAAA,KAAGC,SAAS3I,EAAEiG,GAAEjI,EAAE4B,EAAE,CAACwH,KAAK3J,EAAEc,KAAK8I,MAAM5J,EAAE4J,MAAMuB,MAAM,kBAAkBjK,EAAEJ,KAAKI,EAAEkK,MAAM,QAAQ7I,IAAI,UAAUrB,GAAG,WAAWA,GAAG,MAAMA,EAAE0C,OAAO,MAAM1C,EAAEsB,OAAOrC,KAAKC,IAAIc,EAAE0C,MAAM1C,EAAEsB,QAAQ,SAAStB,EAAEA,EAAEP,KAAK,GAAGH,EAAEqF,SAAS1D,KAAKA,EAAEV,OAAO,IAAI8B,EAAE,CAAC6H,MAAM,SAASzK,KAAK4B,EAAErC,QAAQ,YAAYgB,EAAEA,EAAEhB,QAAQ,EAAEI,QAAQ,YAAYY,EAAEA,EAAEZ,QAAQ,IAAII,EAAEyB,EAAE,UAAUA,EAAEyD,SAAS,EAAG,GAAE,CAAC,CAACgC,2CAA2C3H,GAAG,MAAMyJ,WAAWnE,MAAMvF,EAAE2J,KAAKnJ,GAAGoI,kBAAkBlI,EAAEmI,wBAAwB1G,GAAGuE,KAAK,GAAGA,KAAK4C,+BAA+BrJ,GAAGkC,IAAIzB,GAAGD,SAAST,EAAE+J,aAAaC,WAAWqB,cAAc,OAAO,MAAMnK,EAAEwF,KAAK4E,qBAAqBrL,GAAGsC,EAAE,IAAI6F,IAAI,IAAI,MAAMlF,KAAKxC,EAAE,IAAIgG,KAAKgC,qBAAqB6C,IAAIrI,IAAIwD,KAAKgC,qBAAqBH,IAAIrF,GAAGhC,EAAE,CAAC,MAAMjB,EAAEiD,EAAEoF,YAAY/H,EAAEgC,EAAEtC,GAAC,IAAM,IAAImI,MAAMC,IAAInF,EAAEsI,cAActI,EAAE,CAAC,MAAMjB,EAAE0I,MAAMxC,KAAK5F,GAAC,EAAItC,EAAED,MAAM,MAAMU,EAAET,EAAEwL,cAAc,OAAO/K,EAAEgL,UAAU,IAAI1L,EAAEqG,QAAQ3F,EAAEiL,UAAU,CAAC1L,EAAE2L,eAAelL,EAAEuC,gBAAgB,EAAEvC,EAAEmC,mBAAmB3B,EAAER,EAAEmL,oBAAoBrL,EAAEqB,iBAAiB5B,EAAE6L,cAAcpL,EAAG,IAAGgC,QAAQqJ,QAAQC,IAAI/J,GAAG,IAAIyE,KAAKqC,UAAU,IAAI,MAAMkD,SAAS1L,KAAKmC,EAAE,IAAI,MAAMzC,KAAKM,EAAE,CAAC,MAAMP,EAAEC,EAAEqI,YAAY9H,EAAE+B,EAAEgG,IAAIvI,GAAGuI,IAAItI,EAAEuL,eAAehL,GAAGE,EAAEmF,SAASrF,KAAKA,EAAE6B,SAASpC,EAAEoC,SAASF,EAAE3B,EAAE,YAAYkG,KAAKgC,qBAAqBL,IAAI7H,EAAEU,GAAG,CAAC,CAACoK,qBAAqBrL,GAAG,MAAMD,EAAEC,EAAE+C,EAAE0D,KAAKgD,UAAUC,KAAK9H,kBAAkBrB,EAAER,EAAE,GAAG,OAAOQ,GAAG,GAAG,EAAEP,EAAED,EAAEQ,CAAC,CAACoH,uCAAuC3H,EAAED,EAAEQ,GAAG,MAAME,QAAQgG,KAAKwF,0BAA0BjM,EAAED,EAAEQ,GAAG,GAAG,MAAME,EAAE,MAAM,GAAG,MAAMuH,QAAQ9F,SAASsB,GAAEiD,KAAKgD,UAAUnE,MAAM4G,UAAUzL,GAAG,OAAOyB,EAAEpB,KAAKd,GAAGA,EAAEoH,SAAS,CAACO,gCAAgC3H,EAAED,EAAEQ,GAAG,MAAM4E,OAAO1E,EAAE6E,MAAMpD,EAAEqB,WAAWtC,EAAEyI,MAAM9H,iBAAiBU,EAAEqH,MAAMrJ,IAAImG,KAAKgD,UAAUzH,EAAE,MAAMzB,EAAEA,EAAEc,MAAM,KAAK,IAAItB,EAAES,OAAO,OAAO,WAAWsL,QAAQC,IAAIhM,EAAEe,KAAG,EAAIqL,SAASnM,KAAKA,EAAEoM,OAAOlD,OAAK,KAAQ,OAAM,MAAMzG,EAAEvC,KAAKmM,IAAIf,EAAI,2CAA2CpJ,EAAEoK,aAAaC,QAAM,CAAGvM,EAAED,IAAIA,EAAEqB,SAASoL,EAAE,CAACpL,SAASrB,EAAEqB,SAASC,MAAMW,IAAIhC,GAAG,IAAIiD,EAAEwD,KAAKgG,sCAAsCzM,EAAEyC,GAAGM,EAAE7B,EAAEZ,EAAEgC,GAAGoB,EAAExD,KAAKwM,MAAMzJ,EAAEU,MAAMZ,GAAGF,EAAE,IAAIF,EAAE,CAACmC,KAAK7B,EAAE0J,OAAOrJ,EAAEP,EAAEW,EAAEqB,KAAK9B,EAAE0J,OAAO9J,EAAEE,EAAEW,EAAEsB,KAAK/B,EAAE0J,OAAOrJ,EAAEP,EAAEW,EAAEuB,KAAKhC,EAAE0J,OAAO9J,EAAEE,EAAEW,EAAE9B,iBAAiBqB,EAAErB,mBAAmB,OAAO,IAAIgL,EAAE,CAACzH,OAAO1E,EAAE0B,WAAW,eAAeD,EAAEA,EAAEC,gBAAgB,EAAEC,SAASpC,EAAEuC,OAAOmB,EAAElB,YAAY,QAAQE,UAAUG,EAAEG,gBAAgB,EAAEpB,iBAAiBU,EAAE8C,UAAUlD,EAAEkD,UAAU7B,WAAWtC,EAAEwC,UAAUhB,EAAEkB,MAAMD,GAAG,CAACiE,sCAAsC3H,EAAED,EAAEQ,GAAG,MAAMkJ,WAAWtE,OAAOjD,EAAEqB,WAAWtC,IAAIwF,KAAKnE,EAAE,MAAM/B,EAAEA,EAAEc,MAAM,KAAKf,EAAEP,EAAEe,KAAG,OAASqL,SAASpM,EAAE+F,cAAcvF,MAAM,SAASR,EAAEqM,OAAOlD,OAAK,KAAQ,IAAGnJ,EAAE+J,eAAe/J,EAAE+J,aAAaC,WAAWqB,cAAc,MAAM,GAAG,MAAM3K,EAAEV,EAAEyL,cAAclL,EAAEkM,EAAE,CAACpL,SAASrB,EAAEqB,SAASC,MAAMiB,IAAIN,EAAEyE,KAAKgG,sCAAsCzM,EAAEM,GAAGmC,EAAE,IAAIoK,KAAK5J,SAAS6I,QAAQC,IAAI,CAACe,EAAE/M,EAAEQ,GAAGR,EAAEqB,UAAU2L,sBAAsBtK,EAAE1C,EAAEiN,eAAe7J,EAAEV,EAAE1C,EAAEiN,YAAY/J,GAAG,MAAMF,EAAE2H,MAAMxC,KAAKzF,GAAGwK,OAAO,GAAGxM,EAAE2B,SAASJ,EAAEvB,EAAEiL,UAAU3I,EAAEtC,EAAE8C,WAAWtC,EAAEiB,EAAE,CAAC,MAAMlC,EAAEkC,EAAEgL,QAAQ3M,EAAE8C,EAAErD,EAAED,GAAG,MAAMQ,IAAIE,EAAE0M,MAAM1M,EAAE0M,MAAM,IAAI1M,EAAE0M,eAAe5M,KAAKA,EAAE,CAAC,MAAMmD,EAAE+C,KAAK4E,qBAAqBrJ,EAAE2B,MAAMrD,GAAGuC,QAAQyB,GAAE/D,GAAGoC,EAAE,UAAU5C,EAAEyE,cAAc3B,GAAGA,EAAEuK,YAAYC,sBAAsB9M,GAAGoC,IAAIlC,EAAEmC,mBAAmBc,GAAG,IAAIsI,SAAS9K,SAASnB,EAAE8L,cAAcpL,GAAG,MAAM+C,EAAEb,EAAE,EAAEe,EAAExC,QAAQoM,GAAEvN,EAAEmB,GAAG,IAAI,MAAMlB,KAAKkB,EAAEuF,KAAKgC,qBAAqBL,IAAIpI,EAAEwD,GAAG,OAAOtC,CAAE,IAAG,aAAauB,EAAEnC,IAAIiN,UAAUhB,QAAM,CAAGvM,EAAED,IAAIA,EAAEyN,MAAM,IAAIxN,KAAKD,EAAEyN,OAAOxN,GAAG,IAAIY,OAAOH,EAAE,GAAG,SAASmJ,GAAE5J,EAAED,EAAEQ,GAAG,MAAME,EAAE,GAAGyB,EAAElC,IAAI,MAAMiB,EAAE,IAAIjB,EAAEyF,UAAU1F,GAAGC,EAAEyF,SAASnD,EAAE,IAAItC,EAAE0F,UAAU3F,GAAGC,EAAE0F,SAAS,GAAG1F,EAAE2F,SAAS1E,GAAGqB,EAAE,GAAGtC,EAAEoF,UAAUpF,EAAEoF,UAAU1D,QAAQQ,QAAQ,GAAGlC,EAAE+F,aAAa,CAAC,MAAMhG,EAAE0N,EAAEzN,EAAE,IAAIO,EAAEmN,6BAA6B,IAAI,MAAM3N,GAAGU,EAAEuF,QAAQ,CAACmG,SAASnM,EAAE8F,cAAc/F,GAAG,GAAG,OAAOC,GAAGyK,WAAW,IAAI8C,UAAUzM,IAAIoB,GAAGzB,CAAC,CAAC,SAAS6D,GAAEtE,GAAG,OAAOA,EAAE2N,iBAAiBnN,QAAQkK,MAAMC,QAAQ3K,EAAE4N,UAAU5N,EAAE4N,QAAQC,MAAM7N,GAAG,eAAeA,EAAEa,OAAOuD,IAAI0H,QAAQgC,SAAS,CAACnG,eAAekC,GAAE7J,EAAED,GAAG,GAAGC,EAAE8J,cAAcC,YAAYqB,cAAc,OAAO,EAAE,IAAI,aAAaU,QAAQiC,IAAIhO,EAAEe,KAAG,EAAIqL,SAASnM,KAAKA,EAAEoM,OAAOvE,MAAI,IAAM7H,EAAE8J,aAAaC,WAAWqB,kBAAiC,CAAd,MAAM,OAAO,CAAC,CAAC,CAACzD,eAAe2F,GAAEtN,EAAED,GAAG,MAAMQ,EAAEP,EAAEoB,SAAS,OAAOb,GAAG,kBAAkBA,IAAIA,EAAEyN,gBAAgBjO,EAAEQ,EAAE0N,sBAAsBnC,QAAQC,IAAIhM,EAAEe,KAAKd,GAAGO,EAAEuK,eAAe9K,GAAG6H,MAAM9H,GAAGA,EAAEC,EAAE,UAAU6H,MAAM7H,GAAGA,EAAEY,QAAQZ,GAAG,MAAMA,MAAMD,EAAEa,QAAQZ,GAAG,MAAMO,EAAE2N,UAAUlO,MAAMD,CAAC,CAACC,EAAE,CAAC0D,EAAE,CAACyK,eAAe,KAAK3F,GAAE1B,UAAU,6CAA6C,GAAG9G,EAAE,CAAC0D,EAAE,CAACyK,eAAe,KAAK3F,GAAE1B,UAAU,iBAAiB,GAAG9G,EAAE,CAAC0D,EAAE,CAACyK,eAAe,KAAK3F,GAAE1B,UAAU,yBAAyB,GAAG9G,EAAE,CAAC0D,EAAE,CAACyK,eAAe,KAAK3F,GAAE1B,UAAU,+BAA+B,GAAG9G,EAAE,CAAC0D,EAAE,CAACyK,eAAe,KAAK3F,GAAE1B,UAAU,uBAAuB,GAAG0B,GAAExI,EAAE,CAAC6C,EAAE,yCAAyC2F,ICA1gQ,SAASjI,GAAER,EAAEQ,EAAE2B,EAAEI,EAAE,IAAIhC,GAAG,IAAIW,EAAE,EAAE,GAAG,OAAOiB,EAAErB,KAAKI,EAAEV,GAAG2B,EAAEkM,YAAY,QAAQ,GAAG,OAAOlM,EAAErB,KAAK,CAAC,MAAMP,EAAE4B,EAAEmM,2BAA2BtO,GAAGuC,EAAEJ,EAAEoM,wBAAwBrN,EAAE,MAAMqB,GAAGA,EAAEiM,OAAOrM,EAAEN,kBAAkBrB,EAAED,EAAEN,EAAEsC,GAAGtC,EAAEkC,EAAEN,iBAAiB,CAAC,MAAMnB,EAAEV,EAAEuD,EAAErC,EAAEe,EAAEjC,EAAE8C,EAAE5B,EAAE0B,EAAE5C,EAAEuD,EAAErC,EAAEwB,EAAE1C,EAAE8C,EAAE5B,GAAGW,iBAAiBqB,GAAGf,EAAE,OAAOI,EAAEwC,KAAK5E,KAAKmM,IAAI5L,EAAEkC,GAAGL,EAAEyC,KAAK7E,KAAKmM,IAAIrK,EAAES,GAAGH,EAAE0C,KAAK9E,KAAKC,IAAIM,EAAEkC,GAAGL,EAAE2C,KAAK/E,KAAKC,IAAI6B,EAAES,GAAGH,EAAEV,iBAAiBqB,EAAEX,CAAC,CAAoG,IAAIhC,S"}