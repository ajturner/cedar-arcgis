{"version":3,"names":["v","Math","PI","x","b","u","constructor","t","super","this","_program","_vao","_vertexBuffer","_indexBuffer","_dvsMat3","a","_localOrigin","y","_getBounds","destroy","dispose","doRender","context","e","r","length","_createShaderProgram","_updateMatricesAndLocalOrigin","_updateBufferData","setBlendingEnabled","setDepthTestEnabled","setStencilWriteMask","setStencilTestEnabled","setBlendFunction","h","ONE","ONE_MINUS_SRC_ALPHA","setColorMask","s","bindVAO","useProgram","setUniformMatrix3fv","gl","lineWidth","drawElements","m","LINES","d","UNSIGNED_INT","_createTransforms","dvs","programCache","acquire","attributes","state","displayMat3","size","_","resolution","c","pixelRatio","rotation","viewpoint","p","g","targetGeometry","l","spatialReference","B","M","j","A","n","i","f","o","Float32Array","Uint32Array","setData","buffer","createVertex","DYNAMIC_DRAW","createIndex","bufferLayouts","geometry","location","name","count","type","FLOAT","hasHighlight","_boundsRenderer","enableRenderingBounds","requestRender","hasLabels","onTileData","patch","contains","addChild","onTileError","clear","_renderChildren","children","isReady","hasData","commit","setStencilFunction","EQUAL","stencilRef","getDisplayList","replay"],"sources":["./node_modules/@arcgis/core/views/2d/layers/graphics/GraphicBoundsRenderer.js","./node_modules/@arcgis/core/views/2d/layers/graphics/BaseGraphicContainer.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{disposeMaybe as t}from\"../../../../core/maybe.js\";import{g as e,m as r,h as s,d as i,r as o}from\"../../../../chunks/mat3.js\";import{c as a}from\"../../../../chunks/mat3f32.js\";import{f as n}from\"../../../../chunks/vec2f32.js\";import{f}from\"../../../../chunks/vec3f32.js\";import{normalizeMapX as l}from\"../../../../geometry/support/normalizeUtils.js\";import{DisplayObject as u}from\"../../engine/DisplayObject.js\";import{createProgramDescriptor as _}from\"../../engine/webgl/Utils.js\";import{BufferObject as c}from\"../../../webgl/BufferObject.js\";import{BlendFactor as h,PrimitiveType as m,DataType as d,Usage as p}from\"../../../webgl/enums.js\";import{VertexArrayObject as g}from\"../../../webgl/VertexArrayObject.js\";const v=Math.PI/180,x=4;class b extends u{constructor(t){super(),this._program=null,this._vao=null,this._vertexBuffer=null,this._indexBuffer=null,this._dvsMat3=a(),this._localOrigin={x:0,y:0},this._getBounds=t}destroy(){this._vao&&(this._vao.dispose(),this._vao=null,this._vertexBuffer=null,this._indexBuffer=null),this._program=t(this._program)}doRender(t){const{context:e}=t,r=this._getBounds();if(r.length<1)return;this._createShaderProgram(e),this._updateMatricesAndLocalOrigin(t),this._updateBufferData(e,r),e.setBlendingEnabled(!0),e.setDepthTestEnabled(!1),e.setStencilWriteMask(0),e.setStencilTestEnabled(!1),e.setBlendFunction(h.ONE,h.ONE_MINUS_SRC_ALPHA),e.setColorMask(!0,!0,!0,!0);const s=this._program;e.bindVAO(this._vao),e.useProgram(s),s.setUniformMatrix3fv(\"u_dvsMat3\",this._dvsMat3),e.gl.lineWidth(1),e.drawElements(m.LINES,8*r.length,d.UNSIGNED_INT,0),e.bindVAO()}_createTransforms(){return{dvs:a()}}_createShaderProgram(t){if(this._program)return;const e=\"precision highp float;\\n        uniform mat3 u_dvsMat3;\\n\\n        attribute vec2 a_position;\\n\\n        void main() {\\n          mediump vec3 pos = u_dvsMat3 * vec3(a_position, 1.0);\\n          gl_Position = vec4(pos.xy, 0.0, 1.0);\\n        }\",r=\"precision mediump float;\\n      void main() {\\n        gl_FragColor = vec4(0.75, 0.0, 0.0, 0.75);\\n      }\";this._program=t.programCache.acquire(e,r,y().attributes)}_updateMatricesAndLocalOrigin(t){const{state:a}=t,{displayMat3:u,size:_,resolution:c,pixelRatio:h,rotation:m,viewpoint:d}=a,p=v*m,{x:g,y:x}=d.targetGeometry,b=l(g,a.spatialReference);this._localOrigin.x=b,this._localOrigin.y=x;const y=h*_[0],B=h*_[1],M=c*y,j=c*B,A=e(this._dvsMat3);r(A,A,u),s(A,A,n(y/2,B/2)),i(A,A,f(_[0]/M,-B/j,1)),o(A,A,-p)}_updateBufferData(t,e){const{x:r,y:s}=this._localOrigin,i=2*x*e.length,o=new Float32Array(i),a=new Uint32Array(8*e.length);let n=0,f=0;for(const l of e)l&&(o[2*n]=l[0]-r,o[2*n+1]=l[1]-s,o[2*n+2]=l[0]-r,o[2*n+3]=l[3]-s,o[2*n+4]=l[2]-r,o[2*n+5]=l[3]-s,o[2*n+6]=l[2]-r,o[2*n+7]=l[1]-s,a[f]=n+0,a[f+1]=n+3,a[f+2]=n+3,a[f+3]=n+2,a[f+4]=n+2,a[f+5]=n+1,a[f+6]=n+1,a[f+7]=n+0,n+=4,f+=8);if(this._vertexBuffer?this._vertexBuffer.setData(o.buffer):this._vertexBuffer=c.createVertex(t,p.DYNAMIC_DRAW,o.buffer),this._indexBuffer?this._indexBuffer.setData(a):this._indexBuffer=c.createIndex(t,p.DYNAMIC_DRAW,a),!this._vao){const e=y();this._vao=new g(t,e.attributes,e.bufferLayouts,{geometry:this._vertexBuffer},this._indexBuffer)}}}const y=()=>_(\"bounds\",{geometry:[{location:0,name:\"a_position\",count:2,type:d.FLOAT}]});export{b as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport{destroyMaybe as e}from\"../../../../core/maybe.js\";import{FeatureContainer as t}from\"../../engine/FeatureContainer.js\";import r from\"./GraphicBoundsRenderer.js\";import{CompareFunction as s}from\"../../../webgl/enums.js\";let n=class extends t{constructor(e){super(e),this.hasHighlight=()=>!0}destroy(){super.destroy(),this._boundsRenderer=e(this._boundsRenderer)}enableRenderingBounds(e){this._boundsRenderer=new r(e),this.requestRender()}get hasLabels(){return!1}onTileData(e,t){e.patch(t),this.contains(e)||this.addChild(e),this.requestRender()}onTileError(e){e.clear(),this.contains(e)||this.addChild(e)}_renderChildren(e,t){for(const r of this.children)r.isReady&&r.hasData&&(r.commit(e),e.context.setStencilFunction(s.EQUAL,r.stencilRef,255),r.getDisplayList().replay(e,r,t))}};export{n as default};\n"],"mappings":"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"}