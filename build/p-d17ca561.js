import{O as t,a4 as e,a2 as n,iP as s,k as i,l,a5 as r,f1 as u,n as a,hC as o,V as h,c7 as d,ac as c,au as p,Q as f,aA as y,iQ as g,hw as b,iR as v,iS as j,d3 as w,d5 as O,bS as m}from"./p-98455486.js";import{c as x}from"./p-11e8de4d.js";import{g as I}from"./p-35c35928.js";import"./p-bf0e41eb.js";import"./p-8043ab9b.js";import"./p-922e8c21.js";function L(t,e){return S(t)===S(e)}function S(t){if(null==t)return null;const e=null!=t.layer?t.layer.id:"";let n=null;return n=null!=t.objectId?t.objectId:null!=t.layer&&"objectIdField"in t.layer&&null!=t.layer.objectIdField&&null!=t.attributes?t.attributes[t.layer.objectIdField]:t.uid,null==n?null:`o-${e}-${n}`}const R={json:{write:{writer:q,target:{"feature.layerId":{type:[Number,String]},"feature.objectId":{type:[Number,String]}}},origins:{"web-scene":{read:E}}}};function q(t,e){null!=t&&null!=t.layer?.objectIdField&&null!=t.attributes&&(e.feature={layerId:t.layer.id,objectId:t.attributes[t.layer.objectIdField]})}function E(t){if(null!=t.layerId&&null!=t.objectId)return{uid:null,layer:{id:t.layerId,objectIdField:"ObjectId"},attributes:{ObjectId:t.objectId}}}let A=class extends(t(e(n))){constructor(t){super(t),this.position=null,this.elevationInfo=null,this.feature=null}equals(t){return s(this.position,t.position)&&s(this.elevationInfo,t.elevationInfo)&&L(this.feature,t.feature)}};i([l({type:r,json:{write:{isRequired:!0}}})],A.prototype,"position",void 0),i([l({type:u}),I()],A.prototype,"elevationInfo",void 0),i([l(R)],A.prototype,"feature",void 0),A=i([a("esri.analysis.LineOfSightAnalysisObserver")],A);const F=A;let N=class extends(t(o)){constructor(t){super(t),this.position=null,this.elevationInfo=null,this.feature=null}equals(t){return s(this.position,t.position)&&s(this.elevationInfo,t.elevationInfo)&&L(this.feature,t.feature)}};i([l({type:r}),I()],N.prototype,"position",void 0),i([l({type:u}),I()],N.prototype,"elevationInfo",void 0),i([l(R)],N.prototype,"feature",void 0),N=i([a("esri.analysis.LineOfSightAnalysisTarget")],N);const P=N;function z(t){return t?T:$}function C(t,e){return null!=e&&e.mode?e.mode:z(t).mode}function Q(t,e){return C(null!=t&&t.hasZ,e)}const T={mode:"absolute-height",offset:0},$={mode:"on-the-ground",offset:null};const k=h.ofType(P);let M=class extends x{constructor(t){super(t),this.type="line-of-sight",this.observer=null,this.extent=null}initialize(){this.addHandles(c((()=>this._computeExtent()),(t=>{null!=t&&null!=t.pending||this._set("extent",null!=t?t.extent:null)}),p))}get targets(){return this._get("targets")||new k}set targets(t){this._set("targets",f(t,this.targets,k))}get spatialReference(){return null!=this.observer&&null!=this.observer.position?this.observer.position.spatialReference:null}get requiredPropertiesForEditing(){return[y(this.observer,(t=>t.position))]}async waitComputeExtent(){const t=this._computeExtent();return null!=t?t.pending:Promise.resolve()}_computeExtent(){const t=this.spatialReference;if(null==this.observer||null==this.observer.position||null==t)return null;const e=t=>"absolute-height"===Q(t.position,t.elevationInfo),n=this.observer.position,s=g(n.x,n.y,n.z,n.x,n.y,n.z);for(const e of this.targets)if(null!=e.position){const n=b(e.position,t);if(null!=n.pending)return{pending:n.pending,extent:null};if(null!=n.geometry){const{x:t,y:e,z:i}=n.geometry;v(s,[t,e,i])}}const i=j(s,t);return e(this.observer)&&this.targets.every(e)||(i.zmin=void 0,i.zmax=void 0),{pending:null,extent:i}}clear(){this.observer=null,this.targets.removeAll()}};i([l({type:["line-of-sight"]})],M.prototype,"type",void 0),i([l({type:F,json:{read:!0,write:!0}})],M.prototype,"observer",void 0),i([l({cast:d,type:k,nonNullable:!0,json:{read:!0,write:!0}})],M.prototype,"targets",null),i([l({value:null,readOnly:!0})],M.prototype,"extent",void 0),i([l({readOnly:!0})],M.prototype,"spatialReference",null),i([l({readOnly:!0})],M.prototype,"requiredPropertiesForEditing",null),M=i([a("esri.analysis.LineOfSightAnalysis")],M);const _=M;const B=h.ofType(P);let D=class extends(w(O(m))){constructor(t){super(t),this.type="line-of-sight",this.operationalLayerType="LineOfSightLayer",this.analysis=new _,this.opacity=1}initialize(){this.addHandles(c((()=>this.analysis),((t,e)=>{null!=e&&e.parent===this&&(e.parent=null),null!=t&&(t.parent=this)}),p))}async load(){return null!=this.analysis&&this.addResolvingPromise(this.analysis.waitComputeExtent()),this}get observer(){return y(this.analysis,(t=>t.observer))}set observer(t){y(this.analysis,(e=>e.observer=t))}get targets(){return null!=this.analysis?this.analysis.targets:new h}set targets(t){f(t,this.analysis?.targets)}get fullExtent(){return null!=this.analysis?this.analysis.extent:null}get spatialReference(){return null!=this.analysis?this.analysis.spatialReference:null}releaseAnalysis(t){this.analysis===t&&(this.analysis=new _)}};i([l({json:{read:!1},readOnly:!0})],D.prototype,"type",void 0),i([l({type:["LineOfSightLayer"]})],D.prototype,"operationalLayerType",void 0),i([l({type:F,json:{read:!0,write:{isRequired:!0,ignoreOrigin:!0}}})],D.prototype,"observer",null),i([l({type:B,json:{read:!0,write:{ignoreOrigin:!0}}})],D.prototype,"targets",null),i([l({nonNullable:!0,json:{read:!1,write:!1}})],D.prototype,"analysis",void 0),i([l({readOnly:!0})],D.prototype,"fullExtent",null),i([l({readOnly:!0})],D.prototype,"spatialReference",null),i([l({readOnly:!0,json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}}})],D.prototype,"opacity",void 0),i([l({type:["show","hide"]})],D.prototype,"listMode",void 0),D=i([a("esri.layers.LineOfSightLayer")],D);const G=D;export default G;
//# sourceMappingURL=p-d17ca561.js.map