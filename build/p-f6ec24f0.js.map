{"version":3,"names":["async","l","e","portalItem","t","r","y","properties","load","p","m","type","f","L","w","N","d","S","I","g","T","j","v","F","M","G","className","a","constructor","b","i","h","C","id","layerId","n","url","typeKeywords","length","Object","keys","includes","s","u","layerType","fetchData","map","toLowerCase","cacheType","c","capabilities","tileInfo","test","V","o"],"sources":["./node_modules/@arcgis/core/portal/support/portalLayers.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.27/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Error.js\";import{sceneServiceLayerTypeToClassName as r}from\"../../layers/support/layerUtils.js\";import{layerLookupMap as a}from\"../../layers/support/lazyLayerLoader.js\";import t from\"../PortalItem.js\";import{getNumLayersAndTables as n,preprocessFSItemData as s,getSubtypeGroupLayerIds as c,getFirstLayerOrTableId as o}from\"./layersLoader.js\";import{hasTypeKeyword as i}from\"./portalItemUtils.js\";import{fetchArcGISServiceJSON as u}from\"../../support/requestPresets.js\";async function l(e){!e.portalItem||e.portalItem instanceof t||(e={...e,portalItem:new t(e.portalItem)});const r=await y(e.portalItem);return new(0,r.constructor)({portalItem:e.portalItem,...r.properties})}async function y(e){await e.load();return p(await m(e))}async function m(r){switch(r.type){case\"Map Service\":return f(r);case\"Feature Service\":return L(r);case\"Feature Collection\":return w(r);case\"Scene Service\":return N(r);case\"Image Service\":return d(r);case\"Stream Service\":return S();case\"Vector Tile Service\":return I();case\"GeoJson\":return g();case\"CSV\":return T();case\"KML\":return j();case\"WFS\":return v();case\"WMTS\":return F();case\"WMS\":return M();case\"Feed\":return G();default:throw new e(\"portal:unknown-item-type\",\"Unknown item type '${type}'\",{type:r.type})}}async function p(e){const r=e.className,t=a[r];return{constructor:await t(),properties:e.properties}}async function f(e){return await b(e)?{className:\"TileLayer\"}:{className:\"MapImageLayer\"}}async function L(e){if(i(e,\"Oriented Imagery Layer\"))return h(e);const r=await C(e);if(\"object\"==typeof r){const e={};return null!=r.id&&(e.layerId=r.id),{className:r.className||\"FeatureLayer\",properties:e}}return{className:\"GroupLayer\"}}async function N(e){const a=await C(e);if(\"object\"==typeof a){const t={};let n;if(null!=a.id?(t.layerId=a.id,n=`${e.url}/layers/${a.id}`):n=e.url,e.typeKeywords?.length)for(const a of Object.keys(r))if(e.typeKeywords.includes(a))return{className:r[a]};const s=await u(n);return{className:r[s?.layerType]||\"SceneLayer\",properties:t}}if(!1===a){const r=await u(e.url);return\"Voxel\"===r?.layerType?{className:\"VoxelLayer\"}:{className:\"GroupLayer\"}}return{className:\"GroupLayer\"}}async function w(e){await e.load();const r=i(e,\"Map Notes\"),a=i(e,\"Markup\");if(r||a)return{className:\"MapNotesLayer\"};if(i(e,\"Route Layer\"))return{className:\"RouteLayer\"};const t=await e.fetchData();return 1===n(t)?{className:\"FeatureLayer\"}:{className:\"GroupLayer\"}}async function d(e){await e.load();const r=e.typeKeywords?.map((e=>e.toLowerCase()))??[];if(r.includes(\"elevation 3d layer\"))return{className:\"ElevationLayer\"};if(r.includes(\"tiled imagery\"))return{className:\"ImageryTileLayer\"};const a=await e.fetchData(),t=a?.layerType;if(\"ArcGISTiledImageServiceLayer\"===t)return{className:\"ImageryTileLayer\"};if(\"ArcGISImageServiceLayer\"===t)return{className:\"ImageryLayer\"};const n=await u(e.url),s=n.cacheType?.toLowerCase(),c=n.capabilities?.toLowerCase().includes(\"tilesonly\");return\"map\"===s||c?{className:\"ImageryTileLayer\"}:{className:\"ImageryLayer\"}}function S(){return{className:\"StreamLayer\"}}function I(){return{className:\"VectorTileLayer\"}}function g(){return{className:\"GeoJSONLayer\"}}function T(){return{className:\"CSVLayer\"}}function j(){return{className:\"KMLLayer\"}}function v(){return{className:\"WFSLayer\"}}function M(){return{className:\"WMSLayer\"}}function F(){return{className:\"WMTSLayer\"}}function G(){return{className:\"StreamLayer\"}}async function h(e){await e.load();return{className:\"OrientedImageryLayer\",properties:await e.fetchData()}}async function b(e){return(await u(e.url)).tileInfo}async function C(e){const r=e.url;if(!r||/\\/\\d+$/.test(r))return{};await e.load();const a=await e.fetchData();if(\"Feature Service\"===e.type){const e=V(await s(a,r));if(\"object\"==typeof e){const r=c(a);e.className=null!=e.id&&r.includes(e.id)?\"SubtypeGroupLayer\":\"FeatureLayer\"}return e}if(n(a)>0)return V(a);return V(await u(r))}function V(e){return 1===n(e)&&{id:o(e)}}export{l as fromItem,m as selectLayerClassPath};\n"],"mappings":"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"}