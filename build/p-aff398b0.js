import{b as t,m as s}from"./p-ed1a11ab.js";import{x as n,c as i,u as e}from"./p-908b7a05.js";import{D as r,L as o,F as a,_ as h,E as u,G as p,U as c}from"./p-13e550f5.js";import{T as l,b as v}from"./p-7099a764.js";import{fS as _}from"./p-98455486.js";class m{constructor(t,s,n,i,e,r,o,a,h){this.createQuery=t,this.deleteQuery=s,this.resultAvailable=n,this.getResult=i,this.disjoint=e,this.beginTimeElapsed=r,this.endTimeElapsed=o,this.createTimestamp=a,this.timestampBits=h}}let g=!1;function w(s,n){if(n.disjointTimerQuery)return null;let i=s.getExtension("EXT_disjoint_timer_query_webgl2");return i&&t(s)?new m((()=>s.createQuery()),(t=>{s.deleteQuery(t),g=!1}),(t=>s.getQueryParameter(t,s.QUERY_RESULT_AVAILABLE)),(t=>s.getQueryParameter(t,s.QUERY_RESULT)),(()=>s.getParameter(i.GPU_DISJOINT_EXT)),(t=>{g||(g=!0,s.beginQuery(i.TIME_ELAPSED_EXT,t))}),(()=>{s.endQuery(i.TIME_ELAPSED_EXT),g=!1}),(t=>i.queryCounterEXT(t,i.TIMESTAMP_EXT)),(()=>s.getQuery(i.TIMESTAMP_EXT,i.QUERY_COUNTER_BITS_EXT))):(i=s.getExtension("EXT_disjoint_timer_query"),i?new m((()=>i.createQueryEXT()),(t=>{i.deleteQueryEXT(t),g=!1}),(t=>i.getQueryObjectEXT(t,i.QUERY_RESULT_AVAILABLE_EXT)),(t=>i.getQueryObjectEXT(t,i.QUERY_RESULT_EXT)),(()=>s.getParameter(i.GPU_DISJOINT_EXT)),(t=>{g||(g=!0,i.beginQueryEXT(i.TIME_ELAPSED_EXT,t))}),(()=>{i.endQueryEXT(i.TIME_ELAPSED_EXT),g=!1}),(t=>i.queryCounterEXT(t,i.TIMESTAMP_EXT)),(()=>i.getQueryEXT(i.TIMESTAMP_EXT,i.QUERY_COUNTER_BITS_EXT))):null)}class f{constructor(){this._result=!1}dispose(){this._program=_(this._program)}get result(){return null!=this._program&&(this._result=this._test(this._program),this.dispose()),this._result}}class d extends f{constructor(t){super(),this._rctx=t;const s="\n    precision highp float;\n\n    attribute vec2 a_pos;\n    varying vec2 v_uv;\n\n    void main() {\n      v_uv = a_pos;\n      gl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n    }\n    ",n="\n    precision highp float;\n\n    varying vec2 v_uv;\n\n    uniform sampler2D u_texture;\n\n    void main() {\n      gl_FragColor = texture2D(u_texture, v_uv);\n    }\n    ";this._program=t.programCache.acquire(s,n,new Map([["a_pos",0]]))}dispose(){super.dispose()}_test(t){const _=this._rctx;if(!_.gl)return t.dispose(),!0;const m=new v(1);m.wrapMode=r.CLAMP_TO_EDGE,m.samplingMode=o.NEAREST;const g=new n(_,m),w=i.createVertex(_,a.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),f=new e(_,new Map([["a_pos",0]]),s,{geometry:w}),d=new v;d.samplingMode=o.LINEAR,d.wrapMode=r.CLAMP_TO_EDGE;const y=new l(_,d,x);_.useProgram(t),_.bindTexture(y,0),t.setUniform1i("u_texture",0);const j=_.getBoundFramebufferObject(),{x:E,y:b,width:C,height:F}=_.getViewport();_.bindFramebuffer(g),_.setViewport(0,0,1,1),_.setClearColor(0,0,0,0),_.setBlendingEnabled(!1),_.clearSafe(h.COLOR_BUFFER_BIT),_.bindVAO(f),_.drawArrays(u.TRIANGLE_STRIP,0,4);const T=new Uint8Array(4);return g.readPixels(0,0,1,1,p.RGBA,c.UNSIGNED_BYTE,T),f.dispose(),g.dispose(),y.dispose(),_.setViewport(E,b,C,F),_.bindFramebuffer(j),255!==T[0]}}const x=new Image;x.src="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='5' height='5' version='1.1' viewBox='0 0 5 5' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='5' height='5' fill='%23f00' fill-opacity='.5'/%3E%3C/svg%3E%0A",x.width=5,x.height=5,x.decode();export{w as T,d as f,f as t};
//# sourceMappingURL=p-aff398b0.js.map