import{r as t,h as e,H as r}from"./p-fffba7e8.js";import"@arcgis/charts-components";import"@arcgis/charts-components/dist/arcgis-charts-components/arcgis-charts-components.css";const i={blue:[0,121,193,255],gray:[128,128,128,200],red:[255,0,0,200],white:[255,255,255,255]};function s(t,e=""){const r={version:"1.0.0",type:"chart",dataSource:n(t),id:"Chart",background:i.white,cursorCrosshair:{type:"cursorCrosshair",style:{type:"esriSLS",style:"esriSLSDash",color:i.red,width:1},horizontalLineVisible:true,verticalLineVisible:true},title:{type:"chartText",content:{type:"esriTS",color:i.gray,text:e,font:{size:20}}},series:[],axes:[]};r.axes=c(t);t.series.map(((e,i)=>{r.series.push(o(t,e,i))}));r.legend=a(t);return r}function a(t){return{type:"chartLegend",visible:true,title:{type:"chartText",visible:true,content:{type:"esriTS",color:i.white,text:t.series[0].category.label,font:{size:14,weight:"bold"}}},body:{type:"esriTS",color:i.white,font:{size:12}},position:"right"}}function o(t,e,r){return{type:h(t),id:e.source||`chart${r}`,name:e.value.label,query:t.datasets[0].query||{},x:e.category.field,y:e.value.field,colorType:"singleColor",markerSymbol:{type:"esriSMS",style:"esriSMSCircle",size:5},fillSymbol:{type:"esriSFS",color:[0,121,193,200],outline:{type:"esriSLS",color:i.white,width:1}},lineSymbol:{type:"esriSLS",width:1},dataLabels:{type:"chartText",visible:false,content:{type:"esriTS",color:i.blue,font:{size:14}}}}}function c(t){return[{type:"chartAxis",visible:u(t),title:{type:"chartText",visible:u(t),content:{type:"esriTS",color:i.gray,text:t.series[0].category.label,font:d()}},labels:{type:"chartText",visible:u(t),content:{type:"esriTS",color:i.gray,font:d()}},valueFormat:l(t.series[0].category),lineSymbol:{type:"esriSLS",color:i.gray,width:2}},{type:"chartAxis",visible:u(t),title:{type:"chartText",visible:u(t),content:{type:"esriTS",color:i.gray,text:t.series[0].value.label,font:d()}},labels:{type:"chartText",visible:u(t),content:{type:"esriTS",color:i.gray,font:d()}},valueFormat:l(t.series[0].value),grid:{type:"esriSLS",color:i.gray,width:1},lineSymbol:{type:"esriSLS",color:i.gray,width:2}}]}function n(t){let e={};if(!!t.datasets[0].url){e={type:"layer",layer:{layerType:"ArcGISFeatureLayer",id:"",url:t.datasets[0].url}}}if(!!t.datasets[0].data){e={type:"inline",processed:true,data:{dataItems:t.datasets[0].data.features.map((t=>t.attributes))}}}return e}function l(t){if((t===null||t===void 0?void 0:t.type)==="timestamp"){return{type:"date",intlOptions:{}}}else if(t.type==="number"){return{type:"number",intlOptions:{style:"decimal",notation:"compact",minimumFractionDigits:2,maximumFractionDigits:2}}}else{return{type:"category",characterLimit:11,intlOptions:{}}}}function h(t){switch(t.type){case"sparkline":{return"lineSeries"}case"line":{return"lineSeries"}case"bar":{return"barSeries"}}}function d(t){return{size:14}}function u(t){return t.type!=="sparkline"}const p=":host{display:block}.chart{height:100%}.source{display:none;z-index:1000;overflow:auto;height:300px;border:1px solid gray;grid-template-columns:50% 50%;grid-column-gap:0px}.source-cedar{grid-column:1;overflow:auto}.source-chart{grid-column:2;overflow:auto}.source.visible{display:grid}";const y=class{constructor(e){t(this,e);this.configUrl=null;this.cedarUrl=null;this.data=null;this.chartTitle="";this.config=null;this.cedar=null;this.chartType="bar";this.chartConfig=null}async componentWillLoad(){await this.loadChart()}componentWillRender(){console.debug("cedar-chart: componentWillRender()")}async loadChart(){var t;if(!!this.configUrl){console.debug("cedar-chart: loadChart(configUrl)",this.configUrl);const t=await fetch(this.configUrl);this.chartConfig=await t.json()}else if(!!this.cedarUrl){console.debug("cedar-chart: loadChart(cedarUrl)",this.cedarUrl);const e=await fetch(this.cedarUrl);this.cedar=await e.json();this.chartType=(t=this.cedar)===null||t===void 0?void 0:t.type;if(!!this.data){this.cedar.datasets[0].data.features=this.data}console.debug("cedar-chart: Chart cedar converting...",{cedar:this.cedar});this.chartConfig=s(this.cedar,this.chartTitle)}else if(!!this.cedar){console.debug("cedar-chart: loadChart(cedar)",this.cedar);this.chartConfig=s(this.cedar,this.chartTitle||"")}else if(!!this.config){console.debug("cedar-chart: loadChart(config)",this.cedar);this.chartConfig=this.config}else{console.debug("cedar-chart: no load option?")}console.debug("cedar-chart: Chart config loaded",{cedar:this.cedar,configUrl:this.configUrl,cedarUrl:this.cedarUrl,config:this.config,json:JSON.stringify(this.config)})}loadingComplete(t){console.debug("arcgisChartsDataProcessComplete",t)}dataError(t){console.error("arcgisChartsDataProcessError",t)}updateComplete(t){console.debug("arcgisChartsUpdateComplete",t)}render(){console.debug("cedar-chart: Rendering chart",{config:this.chartConfig});let t=null;if(!!this.chartConfig){t=this.renderChart(this.chartConfig)}return e(r,null,e("slot",null),t)}renderSource(){return[e("a",{onClick:t=>this.sourceEl.classList.toggle("visible")},"source"),e("div",{class:"source",ref:t=>this.sourceEl=t},e("code",{class:"source-cedar"},"Cedar",JSON.stringify(this.cedar)),e("code",{class:"source-chart"},"ArcGIS Charts",JSON.stringify(this.config)))]}renderChart(t){const r=t.chartType||t.series[0].type.replace(/Series/,"");console.debug("cedar-chart: renderChart",{type:r,config:t});switch(r){case"bar":{return this.renderBarChart(t)}case"line":{return this.renderLineChart(t)}case"sparkline":{return this.renderLineChart(t)}case"pie":{return this.renderPieChart(t)}case"scatter":{return this.renderScatterChart(t)}default:{return e("strong",null,"`",r,"` is not a recognized chart type")}}}renderPieChart(t){return[e("h3",null,"Pie Chart"),e("arcgis-charts-pie-chart",{id:"chart",class:"chart",config:t})]}renderScatterChart(t){return[e("h3",null,"Scatter Plot"),e("arcgis-charts-scatter-plot",{id:"chart",class:"chart",config:t})]}renderLineChart(t){return[e("h3",null,"Line Chart"),e("arcgis-charts-line-chart",{id:"chart",class:"chart",config:t})]}renderBarChart(t){console.debug("rendering Bar Chart",{config:t});return[e("h3",null,"Bar Chart"),e("arcgis-charts-bar-chart",{id:"chart",class:"chart",config:t})]}static get watchers(){return{cedar:["loadChart"],cedarUrl:["loadChart"],data:["loadChart"],config:["loadChart"]}}};y.style=p;const f=":host{display:block}table{font-weight:400}thead{border-bottom:1px solid gray}";const g=class{constructor(e){t(this,e);this.data=undefined}render(){return e(r,null,e("slot",null),e("table",null,this.renderTable()))}renderTable(){return[e("thead",null,e("tr",null,Object.keys(this.data[0]).map((t=>e("th",null,t))))),e("tbody",null,this.data.map((t=>e("tr",null,Object.keys(t).map((r=>e("th",null,t[r])))))))]}};g.style=f;export{y as cedar_chart,g as cedar_table};
//# sourceMappingURL=p-fb595c0e.entry.js.map